<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 5 APRENDIZAJE SUPERVISADO | AMAT- Introducción a Ciencia de Datos y Machine Learning</title>
  <meta name="description" content="AMAT Curso 1 : Introduccion a Ciencia de Datos" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 5 APRENDIZAJE SUPERVISADO | AMAT- Introducción a Ciencia de Datos y Machine Learning" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="AMAT Curso 1 : Introduccion a Ciencia de Datos" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 5 APRENDIZAJE SUPERVISADO | AMAT- Introducción a Ciencia de Datos y Machine Learning" />
  
  <meta name="twitter:description" content="AMAT Curso 1 : Introduccion a Ciencia de Datos" />
  

<meta name="author" content="Karina Lizette Gamboa Puente" />
<meta name="author" content="Oscar Arturo Bringas López" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="machine-learning-conceptos-básicos.html"/>
<link rel="next" href="anexos.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><img src="img/amat-logo.png" width="280"></a></li|
|:-:|  
<center>Introducción a Ciencia de Datos y Machine Learning</center>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> BIENVENIDA</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#objetivo"><i class="fa fa-check"></i><b>1.1</b> Objetivo</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#quienes-somos"><i class="fa fa-check"></i><b>1.2</b> ¿Quienes somos?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#ciencia-de-datos-en-r"><i class="fa fa-check"></i><b>1.3</b> Ciencia de Datos en R</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#estructura-del-curso-actual"><i class="fa fa-check"></i><b>1.4</b> Estructura del curso actual</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#alcances-del-curso"><i class="fa fa-check"></i><b>1.4.1</b> Alcances del curso</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#duración-y-evaluación-del-curso"><i class="fa fa-check"></i><b>1.5</b> Duración y evaluación del curso</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#recursos-y-dinámica-de-clase"><i class="fa fa-check"></i><b>1.6</b> Recursos y dinámica de clase</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> INTRODUCCIÓN A CIENCIA DE DATOS</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#qué-es-ciencia-de-datos"><i class="fa fa-check"></i><b>2.1</b> ¿Qué es Ciencia de Datos?</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#definiendo-conceptos"><i class="fa fa-check"></i><b>2.1.1</b> Definiendo conceptos:</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#objetivo-de-la-ciencia-de-datos"><i class="fa fa-check"></i><b>2.2</b> Objetivo de la Ciencia de Datos</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#qué-se-requiere-para-hacer-ciencia-de-datos"><i class="fa fa-check"></i><b>2.3</b> ¿Qué se requiere para hacer Ciencia de Datos?</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#aplicaciones-de-ciencia-de-datos"><i class="fa fa-check"></i><b>2.4</b> Aplicaciones de Ciencia de Datos</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#tipos-de-aprendizaje"><i class="fa fa-check"></i><b>2.5</b> Tipos de aprendizaje</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="intro.html"><a href="intro.html#aprendizaje-supervisado"><i class="fa fa-check"></i><b>2.5.1</b> Aprendizaje supervisado</a></li>
<li class="chapter" data-level="2.5.2" data-path="intro.html"><a href="intro.html#aprendizaje-no-supervisado"><i class="fa fa-check"></i><b>2.5.2</b> Aprendizaje no supervisado</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ciclo.html"><a href="ciclo.html"><i class="fa fa-check"></i><b>3</b> CICLO DE VIDA</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ciclo.html"><a href="ciclo.html#ciclo-de-un-proyecto-de-ciencia-de-datos"><i class="fa fa-check"></i><b>3.1</b> Ciclo de un proyecto de Ciencia de Datos</a></li>
<li class="chapter" data-level="3.2" data-path="ciclo.html"><a href="ciclo.html#data-science-scoping"><i class="fa fa-check"></i><b>3.2</b> Data Science <em>scoping</em></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ciclo.html"><a href="ciclo.html#data-maturity-framework"><i class="fa fa-check"></i><b>3.2.1</b> Data Maturity Framework</a></li>
<li class="chapter" data-level="3.2.2" data-path="ciclo.html"><a href="ciclo.html#scoping"><i class="fa fa-check"></i><b>3.2.2</b> Scoping</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html"><i class="fa fa-check"></i><b>4</b> MACHINE LEARNING: CONCEPTOS BÁSICOS</a>
<ul>
<li class="chapter" data-level="4.1" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#conocimiento-previo-de-los-datos-eda-y-geda"><i class="fa fa-check"></i><b>4.1</b> Conocimiento previo de los datos: EDA y GEDA</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#eda-análisis-exploratorio-de-datos"><i class="fa fa-check"></i><b>4.1.1</b> EDA: Análisis Exploratorio de Datos</a></li>
<li class="chapter" data-level="4.1.2" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#geda-análisis-exploratorio-de-datos-gráficos"><i class="fa fa-check"></i><b>4.1.2</b> GEDA: Análisis Exploratorio de Datos Gráficos</a></li>
<li class="chapter" data-level="4.1.3" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#uso-decisión-e-implementación-de-técnicas-gráficas."><i class="fa fa-check"></i><b>4.1.3</b> Uso, decisión e implementación de técnicas gráficas.</a></li>
<li class="chapter" data-level="4.1.4" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#ggplot2"><i class="fa fa-check"></i><b>4.1.4</b> Ggplot2</a></li>
<li class="chapter" data-level="4.1.5" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#eda-y-geda-con-r"><i class="fa fa-check"></i><b>4.1.5</b> EDA y GEDA con R</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#ml-y-algoritmos"><i class="fa fa-check"></i><b>4.2</b> ML y Algoritmos</a></li>
<li class="chapter" data-level="4.3" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#análisis-supervisado-vs-no-supervisado"><i class="fa fa-check"></i><b>4.3</b> Análisis Supervisado vs No supervisado</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#regresión-vs-clasificación"><i class="fa fa-check"></i><b>4.3.1</b> Regresión vs clasificación</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#sesgo-vs-varianza"><i class="fa fa-check"></i><b>4.4</b> Sesgo vs varianza</a></li>
<li class="chapter" data-level="4.5" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#pre-procesamiento-e-ingeniería-de-datos"><i class="fa fa-check"></i><b>4.5</b> Pre-procesamiento e ingeniería de datos</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#pre-procesamiento-de-datos"><i class="fa fa-check"></i><b>4.5.1</b> Pre-procesamiento de datos</a></li>
<li class="chapter" data-level="4.5.2" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#ingeniería-de-datos"><i class="fa fa-check"></i><b>4.5.2</b> Ingeniería de datos</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#recetas"><i class="fa fa-check"></i><b>4.6</b> Recetas</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#pasos-y-estructura-de-recetas"><i class="fa fa-check"></i><b>4.6.1</b> Pasos y estructura de recetas</a></li>
<li class="chapter" data-level="4.6.2" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#imputaciones"><i class="fa fa-check"></i><b>4.6.2</b> Imputaciones</a></li>
<li class="chapter" data-level="4.6.3" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#agregar-o-modificar-columnas"><i class="fa fa-check"></i><b>4.6.3</b> Agregar o modificar columnas</a></li>
<li class="chapter" data-level="4.6.4" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#interacciones"><i class="fa fa-check"></i><b>4.6.4</b> Interacciones</a></li>
<li class="chapter" data-level="4.6.5" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#transformaciones-generales"><i class="fa fa-check"></i><b>4.6.5</b> Transformaciones generales</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#partición-de-datos"><i class="fa fa-check"></i><b>4.7</b> Partición de datos</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#métodos-comunes-para-particionar-datos"><i class="fa fa-check"></i><b>4.7.1</b> Métodos comunes para particionar datos</a></li>
<li class="chapter" data-level="4.7.2" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#qué-proporción-debería-ser-usada"><i class="fa fa-check"></i><b>4.7.2</b> ¿Qué proporción debería ser usada?</a></li>
<li class="chapter" data-level="4.7.3" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#conjunto-de-validación"><i class="fa fa-check"></i><b>4.7.3</b> Conjunto de validación</a></li>
<li class="chapter" data-level="4.7.4" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#leave-one-out-cross-validation"><i class="fa fa-check"></i><b>4.7.4</b> Leave-one-out cross-validation</a></li>
<li class="chapter" data-level="4.7.5" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#v-fold-cross-validation"><i class="fa fa-check"></i><b>4.7.5</b> V Fold Cross Validation</a></li>
<li class="chapter" data-level="4.7.6" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#medidas-de-ajuste"><i class="fa fa-check"></i><b>4.7.6</b> Medidas de ajuste</a></li>
<li class="chapter" data-level="4.7.7" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#validación-cruzada-para-series-de-tiempo"><i class="fa fa-check"></i><b>4.7.7</b> Validación cruzada para series de tiempo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html"><i class="fa fa-check"></i><b>5</b> APRENDIZAJE SUPERVISADO</a>
<ul>
<li class="chapter" data-level="5.1" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#datos-y-tipos-de-modelos"><i class="fa fa-check"></i><b>5.1</b> Datos y tipos de modelos:</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#regresión-preparación-de-datos"><i class="fa fa-check"></i><b>5.1.1</b> Regresión: Preparación de datos</a></li>
<li class="chapter" data-level="5.1.2" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#clasificación-preparación-de-datos"><i class="fa fa-check"></i><b>5.1.2</b> Clasificación: Preparación de Datos</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#regresión-lineal"><i class="fa fa-check"></i><b>5.2</b> Regresión Lineal</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#ajuste-de-modelo"><i class="fa fa-check"></i><b>5.2.1</b> Ajuste de modelo</a></li>
<li class="chapter" data-level="5.2.2" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#residuos-del-modelo"><i class="fa fa-check"></i><b>5.2.2</b> Residuos del modelo</a></li>
<li class="chapter" data-level="5.2.3" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#métricas-de-desempeño"><i class="fa fa-check"></i><b>5.2.3</b> Métricas de desempeño</a></li>
<li class="chapter" data-level="5.2.4" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#implementación-en-r"><i class="fa fa-check"></i><b>5.2.4</b> Implementación en R</a></li>
<li class="chapter" data-level="5.2.5" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#coeficientes-del-modelo"><i class="fa fa-check"></i><b>5.2.5</b> Coeficientes del modelo</a></li>
<li class="chapter" data-level="5.2.6" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#métricas-de-desempeño-1"><i class="fa fa-check"></i><b>5.2.6</b> Métricas de desempeño</a></li>
<li class="chapter" data-level="5.2.7" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#métodos-se-selección-de-variables"><i class="fa fa-check"></i><b>5.2.7</b> Métodos se selección de variables</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#regresión-logística"><i class="fa fa-check"></i><b>5.3</b> Regresión Logística</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#función-sigmoide"><i class="fa fa-check"></i><b>5.3.1</b> Función sigmoide</a></li>
<li class="chapter" data-level="5.3.2" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#ajuste-del-modelo"><i class="fa fa-check"></i><b>5.3.2</b> Ajuste del modelo</a></li>
<li class="chapter" data-level="5.3.3" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#clasificación-1"><i class="fa fa-check"></i><b>5.3.3</b> Clasificación</a></li>
<li class="chapter" data-level="5.3.4" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#métricas-de-desempeño-2"><i class="fa fa-check"></i><b>5.3.4</b> Métricas de desempeño</a></li>
<li class="chapter" data-level="5.3.5" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#implementación-en-r-1"><i class="fa fa-check"></i><b>5.3.5</b> Implementación en R</a></li>
<li class="chapter" data-level="5.3.6" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#métricas-de-desempeño-3"><i class="fa fa-check"></i><b>5.3.6</b> Métricas de desempeño</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#regularización"><i class="fa fa-check"></i><b>5.4</b> Regularización</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#regularización-ridge"><i class="fa fa-check"></i><b>5.4.1</b> Regularización Ridge</a></li>
<li class="chapter" data-level="5.4.2" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#regularización-lasso"><i class="fa fa-check"></i><b>5.4.2</b> Regularización Lasso</a></li>
<li class="chapter" data-level="5.4.3" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#comparación-entre-ridge-y-lasso"><i class="fa fa-check"></i><b>5.4.3</b> Comparación entre Ridge y Lasso</a></li>
<li class="chapter" data-level="5.4.4" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#elasticnet"><i class="fa fa-check"></i><b>5.4.4</b> ElasticNet</a></li>
<li class="chapter" data-level="5.4.5" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#elasticnet-para-regresión-lineal"><i class="fa fa-check"></i><b>5.4.5</b> ElasticNet para regresión lineal</a></li>
<li class="chapter" data-level="5.4.6" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#elasticnet-para-regresión-logística"><i class="fa fa-check"></i><b>5.4.6</b> ElasticNet para regresión logística</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#k-nearest-neighbor"><i class="fa fa-check"></i><b>5.5</b> K-Nearest-Neighbor</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#clasificación-2"><i class="fa fa-check"></i><b>5.5.1</b> Clasificación</a></li>
<li class="chapter" data-level="5.5.2" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#regresión-1"><i class="fa fa-check"></i><b>5.5.2</b> Regresión</a></li>
<li class="chapter" data-level="5.5.3" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#ajuste-del-modelo-1"><i class="fa fa-check"></i><b>5.5.3</b> Ajuste del modelo</a></li>
<li class="chapter" data-level="5.5.4" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#implementación-en-r-2"><i class="fa fa-check"></i><b>5.5.4</b> Implementación en R</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#árboles-de-decisión"><i class="fa fa-check"></i><b>5.6</b> Árboles de decisión</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#ajuste-del-modelo-2"><i class="fa fa-check"></i><b>5.6.1</b> Ajuste del modelo</a></li>
<li class="chapter" data-level="5.6.2" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#implementación-en-r-3"><i class="fa fa-check"></i><b>5.6.2</b> Implementación en R</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#bagging"><i class="fa fa-check"></i><b>5.7</b> Bagging</a></li>
<li class="chapter" data-level="5.8" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#random-forest"><i class="fa fa-check"></i><b>5.8</b> Random Forest</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#qué-es"><i class="fa fa-check"></i><b>5.8.1</b> ¿Qué es?</a></li>
<li class="chapter" data-level="5.8.2" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#características-de-los-bosques-aleatorios"><i class="fa fa-check"></i><b>5.8.2</b> Características de los bosques aleatorios</a></li>
<li class="chapter" data-level="5.8.3" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#aplicar-árboles-de-decisión-en-un-bosque-aleatorio"><i class="fa fa-check"></i><b>5.8.3</b> Aplicar árboles de decisión en un bosque aleatorio</a></li>
<li class="chapter" data-level="5.8.4" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#ventajas-y-desventjas-de-bosques-aleatorios"><i class="fa fa-check"></i><b>5.8.4</b> Ventajas y desventjas de bosques aleatorios</a></li>
<li class="chapter" data-level="5.8.5" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#bosques-aleatorios-para-modelo-de-regresión"><i class="fa fa-check"></i><b>5.8.5</b> Bosques aleatorios para modelo de regresión</a></li>
<li class="chapter" data-level="5.8.6" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#bosques-aleatorios-para-modelo-de-clasificación"><i class="fa fa-check"></i><b>5.8.6</b> Bosques aleatorios para modelo de clasificación</a></li>
<li class="chapter" data-level="5.8.7" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#importancia-de-las-variables"><i class="fa fa-check"></i><b>5.8.7</b> Importancia de las variables</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="aprendizaje-supervisado-1.html"><a href="aprendizaje-supervisado-1.html#comparación-de-modelos"><i class="fa fa-check"></i><b>5.9</b> Comparación de modelos</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="anexos.html"><a href="anexos.html"><i class="fa fa-check"></i><b>6</b> Anexos</a>
<ul>
<li class="chapter" data-level="6.1" data-path="anexos.html"><a href="anexos.html#orden-y-estructura-de-proyecto"><i class="fa fa-check"></i><b>6.1</b> Orden y estructura de proyecto</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="anexos.html"><a href="anexos.html#plantilla-de-estructura-proyecto"><i class="fa fa-check"></i><b>6.1.1</b> Plantilla de estructura proyecto</a></li>
<li class="chapter" data-level="6.1.2" data-path="anexos.html"><a href="anexos.html#reproducibilidad"><i class="fa fa-check"></i><b>6.1.2</b> Reproducibilidad</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="anexos.html"><a href="anexos.html#referencias"><i class="fa fa-check"></i><b>6.2</b> Referencias:</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="./"><img src="img/amat-logo.png" width="280"></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">AMAT- Introducción a Ciencia de Datos y Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="aprendizaje-supervisado-1" class="section level1" number="5">
<h1><span class="header-section-number">Capítulo 5</span> APRENDIZAJE SUPERVISADO</h1>
<div class="watermark">
<p><img src="img/03-viz/header.png" width="400"/></p>
</div>
<div id="datos-y-tipos-de-modelos" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Datos y tipos de modelos:</h2>
<p>En este curso se realizarán ejemplos tanto de regresión como de clasificación. Cada uno de los modelos a estudiar se implementarán tanto para respuestas continuas como variables categóricas</p>
<div id="regresión-preparación-de-datos" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Regresión: Preparación de datos</h3>
<p>En esta sección, prepararemos datos para ajustar modelos de regresión y de clasificación, usando la paquetería <em>recipes</em>. Primero ajustaremos la receta, después obtendremos la receta actualizada con las estimaciones y al final el conjunto de datos listo para el modelo.</p>
<div id="datos-de-regresión-ames-housing-data" class="section level4" number="5.1.1.1">
<h4><span class="header-section-number">5.1.1.1</span> Datos de regresión: Ames Housing Data</h4>
<p>Los datos que usaremos son los de <em>Ames Housing Data</em>, el conjunto de datos contiene información de la <em>Ames Assessor’s Office</em> utilizada para calcular valuaciones para propiedades residenciales individuales vendidas en Ames, IA, de 2006 a 2010.</p>
<p>Podemos encontrar más información en el siguiente link <a href="http://jse.amstat.org/v19n3/decock/DataDocumentation.txt"><em>Ames Housing Data</em></a>.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="aprendizaje-supervisado-1.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb80-2"><a href="aprendizaje-supervisado-1.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb80-3"><a href="aprendizaje-supervisado-1.html#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb80-4"><a href="aprendizaje-supervisado-1.html#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="aprendizaje-supervisado-1.html#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(ames)</span>
<span id="cb80-6"><a href="aprendizaje-supervisado-1.html#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ames)</span></code></pre></div>
<pre><code>##  [1] &quot;MS_SubClass&quot;        &quot;MS_Zoning&quot;          &quot;Lot_Frontage&quot;      
##  [4] &quot;Lot_Area&quot;           &quot;Street&quot;             &quot;Alley&quot;             
##  [7] &quot;Lot_Shape&quot;          &quot;Land_Contour&quot;       &quot;Utilities&quot;         
## [10] &quot;Lot_Config&quot;         &quot;Land_Slope&quot;         &quot;Neighborhood&quot;      
## [13] &quot;Condition_1&quot;        &quot;Condition_2&quot;        &quot;Bldg_Type&quot;         
## [16] &quot;House_Style&quot;        &quot;Overall_Cond&quot;       &quot;Year_Built&quot;        
## [19] &quot;Year_Remod_Add&quot;     &quot;Roof_Style&quot;         &quot;Roof_Matl&quot;         
## [22] &quot;Exterior_1st&quot;       &quot;Exterior_2nd&quot;       &quot;Mas_Vnr_Type&quot;      
## [25] &quot;Mas_Vnr_Area&quot;       &quot;Exter_Cond&quot;         &quot;Foundation&quot;        
## [28] &quot;Bsmt_Cond&quot;          &quot;Bsmt_Exposure&quot;      &quot;BsmtFin_Type_1&quot;    
## [31] &quot;BsmtFin_SF_1&quot;       &quot;BsmtFin_Type_2&quot;     &quot;BsmtFin_SF_2&quot;      
## [34] &quot;Bsmt_Unf_SF&quot;        &quot;Total_Bsmt_SF&quot;      &quot;Heating&quot;           
## [37] &quot;Heating_QC&quot;         &quot;Central_Air&quot;        &quot;Electrical&quot;        
## [40] &quot;First_Flr_SF&quot;       &quot;Second_Flr_SF&quot;      &quot;Gr_Liv_Area&quot;       
## [43] &quot;Bsmt_Full_Bath&quot;     &quot;Bsmt_Half_Bath&quot;     &quot;Full_Bath&quot;         
## [46] &quot;Half_Bath&quot;          &quot;Bedroom_AbvGr&quot;      &quot;Kitchen_AbvGr&quot;     
## [49] &quot;TotRms_AbvGrd&quot;      &quot;Functional&quot;         &quot;Fireplaces&quot;        
## [52] &quot;Garage_Type&quot;        &quot;Garage_Finish&quot;      &quot;Garage_Cars&quot;       
## [55] &quot;Garage_Area&quot;        &quot;Garage_Cond&quot;        &quot;Paved_Drive&quot;       
## [58] &quot;Wood_Deck_SF&quot;       &quot;Open_Porch_SF&quot;      &quot;Enclosed_Porch&quot;    
## [61] &quot;Three_season_porch&quot; &quot;Screen_Porch&quot;       &quot;Pool_Area&quot;         
## [64] &quot;Pool_QC&quot;            &quot;Fence&quot;              &quot;Misc_Feature&quot;      
## [67] &quot;Misc_Val&quot;           &quot;Mo_Sold&quot;            &quot;Year_Sold&quot;         
## [70] &quot;Sale_Type&quot;          &quot;Sale_Condition&quot;     &quot;Sale_Price&quot;        
## [73] &quot;Longitude&quot;          &quot;Latitude&quot;</code></pre>
</div>
<div id="separación-de-los-datos" class="section level4" number="5.1.1.2">
<h4><span class="header-section-number">5.1.1.2</span> Separación de los datos</h4>
<p>El primer paso para crear un modelo de regresión es dividir nuestros datos originales en un conjunto de entrenamiento y prueba.</p>
<p>No hay que olvidar usar siempre una semilla con la función <em>set.seed()</em> para que sus resultados sean reproducibles.</p>
<p>Primero usaremos la función <strong>initial_split()</strong> de <em>rsample</em> para dividir los datos <em>ames</em> en conjuntos de entrenamiento y prueba. Usamos el parámetro <em>prop</em> para indicar la proporción de los conjuntos <em>train</em> y <em>test</em>.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="aprendizaje-supervisado-1.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4595</span>)</span>
<span id="cb82-2"><a href="aprendizaje-supervisado-1.html#cb82-2" aria-hidden="true" tabindex="-1"></a>ames_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(ames, <span class="at">prop =</span> <span class="fl">0.75</span>)</span></code></pre></div>
<p>El objeto <em>ames_split</em> es un objeto <em>rsplit</em> y solo contiene la información de partición, para obtener los conjuntos de datos resultantes, aplicamos dos funciones adicionales, <strong>training</strong> y <strong>testing</strong>.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="aprendizaje-supervisado-1.html#cb83-1" aria-hidden="true" tabindex="-1"></a>ames_train <span class="ot">&lt;-</span> <span class="fu">training</span>(ames_split)</span>
<span id="cb83-2"><a href="aprendizaje-supervisado-1.html#cb83-2" aria-hidden="true" tabindex="-1"></a>ames_test  <span class="ot">&lt;-</span> <span class="fu">testing</span>(ames_split)</span></code></pre></div>
<p>Estos objetos son <em>data frames</em> con las mismas columnas que los datos originales, pero solo las filas apropiadas para cada conjunto.</p>
<p>También existe la función <strong>vfold_cv</strong> que se usa para crear <em><strong>v</strong></em> particiones del conjunto de entrenamiento.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="aprendizaje-supervisado-1.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2453</span>)</span>
<span id="cb84-2"><a href="aprendizaje-supervisado-1.html#cb84-2" aria-hidden="true" tabindex="-1"></a>ames_folds<span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(ames_train)</span></code></pre></div>
<p>Ya con los conjuntos de entrenamiento y prueba definidos, iniciaremos con <em>feature engeeniring</em> sobre el conjunto de entrenamiento.</p>
</div>
<div id="definición-de-la-receta" class="section level4" number="5.1.1.3">
<h4><span class="header-section-number">5.1.1.3</span> Definición de la receta</h4>
<p>Ahora usaremos la función vista en la sección anterior, <em>recipe()</em>, para definir los pasos de preprocesamiento antes de usar los datos para modelado.</p>
<ul>
<li><p>Usamos la función <em><strong>step_mutate()</strong></em> para generar nuevas variables dentro de la receta.</p></li>
<li><p>La función <em><strong>step_interact()</strong></em> nos ayuda a crear nuevas variables que son interacciones entre las variables especificadas.</p></li>
<li><p>Con la función <em><strong>step_ratio()</strong></em> creamos proporciones con las variables especificadas.</p></li>
<li><p><em><strong>forcats::fct_collapse()</strong></em> se usa para recategorizar variables, colapsando categorías de la variable.</p></li>
<li><p><em><strong>step_relevel</strong></em> nos ayuda a asignar la categoria deseada de una variable como referencia.</p></li>
<li><p><em><strong>step_normalize()</strong></em> es de gran utilidad ya que sirve para normalizar las variables que se le indiquen.</p></li>
<li><p><em><strong>step_dummy()</strong></em> Nos ayuda a crear variables <em>One Hot Encoding</em>.</p></li>
<li><p>Por último usamos la función <em><strong>step_rm()</strong></em> para eliminar variables que no son de utilidad para el modelo.</p></li>
</ul>
<p>Ahora crearemos algunas variables auxiliares que podrían ser de utilidad para el ajuste de un modelo de regresión, entre ella: <em>Log(Sale_Price)</em>, la cual será la variable a predecir. Una vez que el modelo haga la predicción del logaritmo del precio, es importante calcular con la función exponencial el precio real.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="aprendizaje-supervisado-1.html#cb85-1" aria-hidden="true" tabindex="-1"></a>receta_casas <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Sale_Price <span class="sc">~</span> . , <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="aprendizaje-supervisado-1.html#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_log</span>(Sale_Price, <span class="at">skip =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb85-3"><a href="aprendizaje-supervisado-1.html#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Alley) <span class="sc">%&gt;%</span></span>
<span id="cb85-4"><a href="aprendizaje-supervisado-1.html#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rename</span>(<span class="at">Year_Remod =</span> Year_Remod_Add) <span class="sc">%&gt;%</span> </span>
<span id="cb85-5"><a href="aprendizaje-supervisado-1.html#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rename</span>(<span class="at">ThirdSsn_Porch =</span> Three_season_porch) <span class="sc">%&gt;%</span> </span>
<span id="cb85-6"><a href="aprendizaje-supervisado-1.html#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_ratio</span>(Bedroom_AbvGr, <span class="at">denom =</span> <span class="fu">denom_vars</span>(Gr_Liv_Area)) <span class="sc">%&gt;%</span> </span>
<span id="cb85-7"><a href="aprendizaje-supervisado-1.html#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(</span>
<span id="cb85-8"><a href="aprendizaje-supervisado-1.html#cb85-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_House =</span> Year_Sold <span class="sc">-</span> Year_Remod,</span>
<span id="cb85-9"><a href="aprendizaje-supervisado-1.html#cb85-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">TotalSF   =</span> Gr_Liv_Area <span class="sc">+</span> Total_Bsmt_SF,</span>
<span id="cb85-10"><a href="aprendizaje-supervisado-1.html#cb85-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">AvgRoomSF   =</span> Gr_Liv_Area <span class="sc">/</span> TotRms_AbvGrd,</span>
<span id="cb85-11"><a href="aprendizaje-supervisado-1.html#cb85-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Pool =</span> <span class="fu">if_else</span>(Pool_Area <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb85-12"><a href="aprendizaje-supervisado-1.html#cb85-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Exter_Cond =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Exter_Cond, <span class="at">Good =</span> <span class="fu">c</span>(<span class="st">&quot;Typical&quot;</span>, <span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Excellent&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb85-13"><a href="aprendizaje-supervisado-1.html#cb85-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_relevel</span>(Exter_Cond, <span class="at">ref_level =</span> <span class="st">&quot;Good&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb85-14"><a href="aprendizaje-supervisado-1.html#cb85-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_predictors</span>(), <span class="sc">-</span><span class="fu">all_nominal</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb85-15"><a href="aprendizaje-supervisado-1.html#cb85-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb85-16"><a href="aprendizaje-supervisado-1.html#cb85-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> Second_Flr_SF<span class="sc">:</span>First_Flr_SF) <span class="sc">%&gt;%</span> </span>
<span id="cb85-17"><a href="aprendizaje-supervisado-1.html#cb85-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;Bsmt_Cond&quot;</span>)<span class="sc">:</span>TotRms_AbvGrd) <span class="sc">%&gt;%</span> </span>
<span id="cb85-18"><a href="aprendizaje-supervisado-1.html#cb85-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(</span>
<span id="cb85-19"><a href="aprendizaje-supervisado-1.html#cb85-19" aria-hidden="true" tabindex="-1"></a>    First_Flr_SF, Second_Flr_SF, Year_Remod,</span>
<span id="cb85-20"><a href="aprendizaje-supervisado-1.html#cb85-20" aria-hidden="true" tabindex="-1"></a>    Bsmt_Full_Bath, Bsmt_Half_Bath, </span>
<span id="cb85-21"><a href="aprendizaje-supervisado-1.html#cb85-21" aria-hidden="true" tabindex="-1"></a>    Kitchen_AbvGr, BsmtFin_Type_1_Unf, </span>
<span id="cb85-22"><a href="aprendizaje-supervisado-1.html#cb85-22" aria-hidden="true" tabindex="-1"></a>    Total_Bsmt_SF, Kitchen_AbvGr, Pool_Area, </span>
<span id="cb85-23"><a href="aprendizaje-supervisado-1.html#cb85-23" aria-hidden="true" tabindex="-1"></a>    Gr_Liv_Area, Sale_Type_Oth, Sale_Type_VWD</span>
<span id="cb85-24"><a href="aprendizaje-supervisado-1.html#cb85-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb85-25"><a href="aprendizaje-supervisado-1.html#cb85-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>()</span></code></pre></div>
<p>Recordemos que la función <strong>recipe()</strong> solo son los pasos a seguir, necesitamos usar la función <strong>prep()</strong> que nos devuelve una receta actualizada con las estimaciones y la función <strong>juice()</strong> que nos devuelve la matriz de diseño.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="aprendizaje-supervisado-1.html#cb86-1" aria-hidden="true" tabindex="-1"></a>casa_juiced <span class="ot">&lt;-</span> <span class="fu">juice</span>(receta_casas)</span>
<span id="cb86-2"><a href="aprendizaje-supervisado-1.html#cb86-2" aria-hidden="true" tabindex="-1"></a>casa_juiced</span></code></pre></div>
<pre><code>## # A tibble: 2,197 × 275
##    Lot_Frontage Lot_Area Year_Built Mas_Vnr_Area BsmtFin_SF_1 BsmtFin_SF_2
##           &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
##  1       0.214    0.604       0.848       -0.572       -0.512       -0.293
##  2       0.363   -0.216      -0.114       -0.572       -0.512       -0.293
##  3       1.05    -0.0159      1.08        -0.572        1.26        -0.293
##  4      -0.173    4.87        1.15         3.49        -0.512       -0.293
##  5       0.512    0.256       1.11         0.526        1.26        -0.293
##  6      -0.233   -0.696      -0.844       -0.572        1.26        -0.293
##  7       0.125   -0.261      -0.446       -0.572       -0.512       -0.293
##  8       0.571   -0.193      -0.479       -0.572        0.819       -0.293
##  9       0.274    0.704       0.981       -0.572        1.26        -0.293
## 10       0.0651  -0.356      -0.712       -0.572        0.375       -0.293
## # … with 2,187 more rows, and 269 more variables: Bsmt_Unf_SF &lt;dbl&gt;,
## #   Full_Bath &lt;dbl&gt;, Half_Bath &lt;dbl&gt;, Bedroom_AbvGr &lt;dbl&gt;, TotRms_AbvGrd &lt;dbl&gt;,
## #   Fireplaces &lt;dbl&gt;, Garage_Cars &lt;dbl&gt;, Garage_Area &lt;dbl&gt;, Wood_Deck_SF &lt;dbl&gt;,
## #   Open_Porch_SF &lt;dbl&gt;, Enclosed_Porch &lt;dbl&gt;, ThirdSsn_Porch &lt;dbl&gt;,
## #   Screen_Porch &lt;dbl&gt;, Misc_Val &lt;dbl&gt;, Mo_Sold &lt;dbl&gt;, Year_Sold &lt;dbl&gt;,
## #   Longitude &lt;dbl&gt;, Latitude &lt;dbl&gt;, Sale_Price &lt;dbl&gt;,
## #   Bedroom_AbvGr_o_Gr_Liv_Area &lt;dbl&gt;, Age_House &lt;dbl&gt;, TotalSF &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="aprendizaje-supervisado-1.html#cb88-1" aria-hidden="true" tabindex="-1"></a>casa_test_bake <span class="ot">&lt;-</span> <span class="fu">bake</span>(receta_casas, <span class="at">new_data =</span> ames_test)</span>
<span id="cb88-2"><a href="aprendizaje-supervisado-1.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(casa_test_bake)</span></code></pre></div>
<pre><code>## Rows: 733
## Columns: 275
## $ Lot_Frontage                                          &lt;dbl&gt; 0.6607556, -1.72…
## $ Lot_Area                                              &lt;dbl&gt; 0.15995167, -0.2…
## $ Year_Built                                            &lt;dbl&gt; -0.34660802, 0.6…
## $ Mas_Vnr_Area                                          &lt;dbl&gt; -0.5721904, -0.5…
## $ BsmtFin_SF_1                                          &lt;dbl&gt; 0.81885215, -1.3…
## $ BsmtFin_SF_2                                          &lt;dbl&gt; 0.5851851, -0.29…
## $ Bsmt_Unf_SF                                           &lt;dbl&gt; -0.65580176, -0.…
## $ Full_Bath                                             &lt;dbl&gt; -1.0284858, 0.79…
## $ Half_Bath                                             &lt;dbl&gt; -0.7465678, -0.7…
## $ Bedroom_AbvGr                                         &lt;dbl&gt; -1.0749072, 0.15…
## $ TotRms_AbvGrd                                         &lt;dbl&gt; -0.9221672, -0.2…
## $ Fireplaces                                            &lt;dbl&gt; -0.9297733, -0.9…
## $ Garage_Cars                                           &lt;dbl&gt; -1.0124349, 0.29…
## $ Garage_Area                                           &lt;dbl&gt; 1.19047388, -0.2…
## $ Wood_Deck_SF                                          &lt;dbl&gt; 0.3353735, 3.013…
## $ Open_Porch_SF                                         &lt;dbl&gt; -0.70298891, -0.…
## $ Enclosed_Porch                                        &lt;dbl&gt; -0.3536614, -0.3…
## $ ThirdSsn_Porch                                        &lt;dbl&gt; -0.1029207, -0.1…
## $ Screen_Porch                                          &lt;dbl&gt; 1.9128593, -0.28…
## $ Misc_Val                                              &lt;dbl&gt; -0.09569659, 0.6…
## $ Mo_Sold                                               &lt;dbl&gt; -0.09320608, -1.…
## $ Year_Sold                                             &lt;dbl&gt; 1.672416, 1.6724…
## $ Longitude                                             &lt;dbl&gt; 0.90531385, 0.27…
## $ Latitude                                              &lt;dbl&gt; 1.00647452, 1.24…
## $ Sale_Price                                            &lt;int&gt; 105000, 185000, …
## $ Bedroom_AbvGr_o_Gr_Liv_Area                           &lt;dbl&gt; 0.34141287, 0.83…
## $ Age_House                                             &lt;dbl&gt; 1.21786294, -0.9…
## $ TotalSF                                               &lt;dbl&gt; -0.94110413, -0.…
## $ AvgRoomSF                                             &lt;dbl&gt; -1.11699593, -0.…
## $ Pool                                                  &lt;dbl&gt; -0.0709206, -0.0…
## $ MS_SubClass_One_Story_1945_and_Older                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ MS_SubClass_One_Story_with_Finished_Attic_All_Ages    &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ MS_SubClass_One_and_Half_Story_Unfinished_All_Ages    &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ MS_SubClass_One_and_Half_Story_Finished_All_Ages      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ MS_SubClass_Two_Story_1946_and_Newer                  &lt;dbl&gt; 0, 0, 1, 0, 0, 1…
## $ MS_SubClass_Two_Story_1945_and_Older                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ MS_SubClass_Two_and_Half_Story_All_Ages               &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ MS_SubClass_Split_or_Multilevel                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ MS_SubClass_Split_Foyer                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ MS_SubClass_Duplex_All_Styles_and_Ages                &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ MS_SubClass_One_Story_PUD_1946_and_Newer              &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ MS_SubClass_One_and_Half_Story_PUD_All_Ages           &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ MS_SubClass_Two_Story_PUD_1946_and_Newer              &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ MS_SubClass_PUD_Multilevel_Split_Level_Foyer          &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ MS_SubClass_Two_Family_conversion_All_Styles_and_Ages &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ MS_Zoning_Residential_High_Density                    &lt;dbl&gt; 1, 0, 0, 0, 0, 0…
## $ MS_Zoning_Residential_Low_Density                     &lt;dbl&gt; 0, 1, 1, 1, 1, 0…
## $ MS_Zoning_Residential_Medium_Density                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ MS_Zoning_A_agr                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ MS_Zoning_C_all                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ MS_Zoning_I_all                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Street_Pave                                           &lt;dbl&gt; 1, 1, 1, 1, 1, 1…
## $ Alley_No_Alley_Access                                 &lt;dbl&gt; 1, 1, 1, 1, 1, 1…
## $ Alley_Paved                                           &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Alley_unknown                                         &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Lot_Shape_Slightly_Irregular                          &lt;dbl&gt; 0, 1, 1, 0, 0, 0…
## $ Lot_Shape_Moderately_Irregular                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Lot_Shape_Irregular                                   &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Land_Contour_HLS                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Land_Contour_Low                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Land_Contour_Lvl                                      &lt;dbl&gt; 1, 1, 1, 1, 1, 1…
## $ Utilities_NoSeWa                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Utilities_NoSewr                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Lot_Config_CulDSac                                    &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Lot_Config_FR2                                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Lot_Config_FR3                                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Lot_Config_Inside                                     &lt;dbl&gt; 1, 1, 1, 0, 1, 1…
## $ Land_Slope_Mod                                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Land_Slope_Sev                                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_College_Creek                            &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Old_Town                                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Edwards                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Somerset                                 &lt;dbl&gt; 0, 0, 0, 0, 0, 1…
## $ Neighborhood_Northridge_Heights                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Gilbert                                  &lt;dbl&gt; 0, 1, 1, 1, 0, 0…
## $ Neighborhood_Sawyer                                   &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Northwest_Ames                           &lt;dbl&gt; 0, 0, 0, 0, 1, 0…
## $ Neighborhood_Sawyer_West                              &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Mitchell                                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Brookside                                &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Crawford                                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Iowa_DOT_and_Rail_Road                   &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Timberland                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Northridge                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Stone_Brook                              &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_South_and_West_of_Iowa_State_University  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Clear_Creek                              &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Meadow_Village                           &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Briardale                                &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Bloomington_Heights                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Veenker                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Northpark_Villa                          &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Blueste                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Greens                                   &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Green_Hills                              &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Landmark                                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Neighborhood_Hayden_Lake                              &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Condition_1_Feedr                                     &lt;dbl&gt; 1, 0, 0, 0, 0, 0…
## $ Condition_1_Norm                                      &lt;dbl&gt; 0, 1, 1, 1, 1, 1…
## $ Condition_1_PosA                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Condition_1_PosN                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Condition_1_RRAe                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Condition_1_RRAn                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Condition_1_RRNe                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Condition_1_RRNn                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Condition_2_Feedr                                     &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Condition_2_Norm                                      &lt;dbl&gt; 1, 1, 1, 1, 1, 1…
## $ Condition_2_PosA                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Condition_2_PosN                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Condition_2_RRAe                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Condition_2_RRAn                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Condition_2_RRNn                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Bldg_Type_TwoFmCon                                    &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Bldg_Type_Duplex                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Bldg_Type_Twnhs                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Bldg_Type_TwnhsE                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ House_Style_One_and_Half_Unf                          &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ House_Style_One_Story                                 &lt;dbl&gt; 1, 1, 0, 1, 1, 0…
## $ House_Style_SFoyer                                    &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ House_Style_SLvl                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ House_Style_Two_and_Half_Fin                          &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ House_Style_Two_and_Half_Unf                          &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ House_Style_Two_Story                                 &lt;dbl&gt; 0, 0, 1, 0, 0, 1…
## $ Overall_Cond_Poor                                     &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Overall_Cond_Fair                                     &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Overall_Cond_Below_Average                            &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Overall_Cond_Average                                  &lt;dbl&gt; 0, 0, 1, 1, 0, 1…
## $ Overall_Cond_Above_Average                            &lt;dbl&gt; 1, 0, 0, 0, 1, 0…
## $ Overall_Cond_Good                                     &lt;dbl&gt; 0, 1, 0, 0, 0, 0…
## $ Overall_Cond_Very_Good                                &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Overall_Cond_Excellent                                &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Overall_Cond_Very_Excellent                           &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Roof_Style_Gable                                      &lt;dbl&gt; 1, 1, 1, 1, 1, 1…
## $ Roof_Style_Gambrel                                    &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Roof_Style_Hip                                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Roof_Style_Mansard                                    &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Roof_Style_Shed                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Roof_Matl_CompShg                                     &lt;dbl&gt; 1, 1, 1, 1, 1, 1…
## $ Roof_Matl_Membran                                     &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Roof_Matl_Metal                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Roof_Matl_Roll                                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Roof_Matl_Tar.Grv                                     &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Roof_Matl_WdShake                                     &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Roof_Matl_WdShngl                                     &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_1st_AsphShn                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_1st_BrkComm                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_1st_BrkFace                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_1st_CBlock                                   &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_1st_CemntBd                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_1st_HdBoard                                  &lt;dbl&gt; 0, 1, 0, 0, 0, 0…
## $ Exterior_1st_ImStucc                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_1st_MetalSd                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_1st_Plywood                                  &lt;dbl&gt; 0, 0, 0, 0, 1, 0…
## $ Exterior_1st_PreCast                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_1st_Stone                                    &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_1st_Stucco                                   &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_1st_VinylSd                                  &lt;dbl&gt; 1, 0, 1, 1, 0, 1…
## $ Exterior_1st_Wd.Sdng                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_1st_WdShing                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_2nd_AsphShn                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_2nd_Brk.Cmn                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_2nd_BrkFace                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_2nd_CBlock                                   &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_2nd_CmentBd                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_2nd_HdBoard                                  &lt;dbl&gt; 0, 1, 0, 0, 0, 0…
## $ Exterior_2nd_ImStucc                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_2nd_MetalSd                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_2nd_Other                                    &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_2nd_Plywood                                  &lt;dbl&gt; 0, 0, 0, 0, 1, 0…
## $ Exterior_2nd_PreCast                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_2nd_Stone                                    &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_2nd_Stucco                                   &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_2nd_VinylSd                                  &lt;dbl&gt; 1, 0, 1, 1, 0, 1…
## $ Exterior_2nd_Wd.Sdng                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exterior_2nd_Wd.Shng                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Mas_Vnr_Type_BrkFace                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Mas_Vnr_Type_CBlock                                   &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Mas_Vnr_Type_None                                     &lt;dbl&gt; 1, 1, 1, 1, 0, 1…
## $ Mas_Vnr_Type_Stone                                    &lt;dbl&gt; 0, 0, 0, 0, 1, 0…
## $ Exter_Cond_Fair                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Exter_Cond_Poor                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Foundation_CBlock                                     &lt;dbl&gt; 1, 0, 0, 1, 1, 0…
## $ Foundation_PConc                                      &lt;dbl&gt; 0, 1, 1, 0, 0, 1…
## $ Foundation_Slab                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Foundation_Stone                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Foundation_Wood                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Bsmt_Cond_Fair                                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Bsmt_Cond_Good                                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Bsmt_Cond_No_Basement                                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Bsmt_Cond_Poor                                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Bsmt_Cond_Typical                                     &lt;dbl&gt; 1, 1, 1, 1, 1, 1…
## $ Bsmt_Exposure_Gd                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Bsmt_Exposure_Mn                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Bsmt_Exposure_No                                      &lt;dbl&gt; 1, 1, 1, 1, 1, 1…
## $ Bsmt_Exposure_No_Basement                             &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ BsmtFin_Type_1_BLQ                                    &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ BsmtFin_Type_1_GLQ                                    &lt;dbl&gt; 0, 0, 0, 0, 0, 1…
## $ BsmtFin_Type_1_LwQ                                    &lt;dbl&gt; 0, 0, 0, 1, 0, 0…
## $ BsmtFin_Type_1_No_Basement                            &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ BsmtFin_Type_1_Rec                                    &lt;dbl&gt; 1, 0, 0, 0, 0, 0…
## $ BsmtFin_Type_2_BLQ                                    &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ BsmtFin_Type_2_GLQ                                    &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ BsmtFin_Type_2_LwQ                                    &lt;dbl&gt; 1, 0, 0, 0, 0, 0…
## $ BsmtFin_Type_2_No_Basement                            &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ BsmtFin_Type_2_Rec                                    &lt;dbl&gt; 0, 0, 0, 0, 1, 0…
## $ BsmtFin_Type_2_Unf                                    &lt;dbl&gt; 0, 1, 1, 1, 0, 1…
## $ Heating_GasA                                          &lt;dbl&gt; 1, 1, 1, 1, 1, 1…
## $ Heating_GasW                                          &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Heating_Grav                                          &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Heating_OthW                                          &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Heating_Wall                                          &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Heating_QC_Fair                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Heating_QC_Good                                       &lt;dbl&gt; 0, 0, 1, 0, 0, 0…
## $ Heating_QC_Poor                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Heating_QC_Typical                                    &lt;dbl&gt; 1, 0, 0, 0, 1, 0…
## $ Central_Air_Y                                         &lt;dbl&gt; 1, 1, 1, 1, 1, 1…
## $ Electrical_FuseF                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Electrical_FuseP                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Electrical_Mix                                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Electrical_SBrkr                                      &lt;dbl&gt; 1, 1, 1, 1, 1, 1…
## $ Electrical_Unknown                                    &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Functional_Maj2                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Functional_Min1                                       &lt;dbl&gt; 0, 0, 0, 0, 1, 0…
## $ Functional_Min2                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Functional_Mod                                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Functional_Sal                                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Functional_Sev                                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Functional_Typ                                        &lt;dbl&gt; 1, 1, 1, 1, 0, 1…
## $ Garage_Type_Basment                                   &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Garage_Type_BuiltIn                                   &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Garage_Type_CarPort                                   &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Garage_Type_Detchd                                    &lt;dbl&gt; 0, 0, 0, 1, 0, 0…
## $ Garage_Type_More_Than_Two_Types                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Garage_Type_No_Garage                                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Garage_Finish_No_Garage                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Garage_Finish_RFn                                     &lt;dbl&gt; 0, 0, 0, 0, 0, 1…
## $ Garage_Finish_Unf                                     &lt;dbl&gt; 1, 0, 0, 1, 1, 0…
## $ Garage_Cond_Fair                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Garage_Cond_Good                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Garage_Cond_No_Garage                                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Garage_Cond_Poor                                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Garage_Cond_Typical                                   &lt;dbl&gt; 1, 1, 1, 1, 1, 1…
## $ Paved_Drive_Partial_Pavement                          &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Paved_Drive_Paved                                     &lt;dbl&gt; 1, 1, 1, 1, 1, 1…
## $ Pool_QC_Fair                                          &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Pool_QC_Good                                          &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Pool_QC_No_Pool                                       &lt;dbl&gt; 1, 1, 1, 1, 1, 1…
## $ Pool_QC_Typical                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Fence_Good_Wood                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Fence_Minimum_Privacy                                 &lt;dbl&gt; 1, 0, 0, 0, 1, 0…
## $ Fence_Minimum_Wood_Wire                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Fence_No_Fence                                        &lt;dbl&gt; 0, 0, 1, 1, 0, 1…
## $ Misc_Feature_Gar2                                     &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Misc_Feature_None                                     &lt;dbl&gt; 1, 0, 1, 1, 1, 1…
## $ Misc_Feature_Othr                                     &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Misc_Feature_Shed                                     &lt;dbl&gt; 0, 1, 0, 0, 0, 0…
## $ Misc_Feature_TenC                                     &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Sale_Type_Con                                         &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Sale_Type_ConLD                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Sale_Type_ConLI                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Sale_Type_ConLw                                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Sale_Type_CWD                                         &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Sale_Type_New                                         &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Sale_Type_WD.                                         &lt;dbl&gt; 1, 1, 1, 1, 1, 1…
## $ Sale_Condition_AdjLand                                &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Sale_Condition_Alloca                                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Sale_Condition_Family                                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Sale_Condition_Normal                                 &lt;dbl&gt; 1, 1, 1, 1, 1, 1…
## $ Sale_Condition_Partial                                &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Second_Flr_SF_x_First_Flr_SF                          &lt;dbl&gt; 0.52453728, -0.0…
## $ Bsmt_Cond_Fair_x_TotRms_AbvGrd                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Bsmt_Cond_Good_x_TotRms_AbvGrd                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Bsmt_Cond_No_Basement_x_TotRms_AbvGrd                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Bsmt_Cond_Poor_x_TotRms_AbvGrd                        &lt;dbl&gt; 0, 0, 0, 0, 0, 0…
## $ Bsmt_Cond_Typical_x_TotRms_AbvGrd                     &lt;dbl&gt; -0.9221672, -0.2…</code></pre>
</div>
</div>
<div id="clasificación-preparación-de-datos" class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Clasificación: Preparación de Datos</h3>
<p>Ahora prepararemos los datos para un ejemplo de churn, es decir, la <strong>tasa de cancelación de clientes</strong>. Usaremos datos de <a href="https://www.kaggle.com/blastchar/telco-customer-churn">Telco</a>.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="aprendizaje-supervisado-1.html#cb90-1" aria-hidden="true" tabindex="-1"></a>telco <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/Churn.csv&quot;</span>)</span>
<span id="cb90-2"><a href="aprendizaje-supervisado-1.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(telco)</span></code></pre></div>
<pre><code>## Rows: 7,043
## Columns: 21
## $ customerID       &lt;chr&gt; &quot;7590-VHVEG&quot;, &quot;5575-GNVDE&quot;, &quot;3668-QPYBK&quot;, &quot;7795-CFOCW…
## $ gender           &lt;chr&gt; &quot;Female&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Female&quot;, &quot;Female&quot;,…
## $ SeniorCitizen    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ Partner          &lt;chr&gt; &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Yes…
## $ Dependents       &lt;chr&gt; &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;…
## $ tenure           &lt;dbl&gt; 1, 34, 2, 45, 2, 8, 22, 10, 28, 62, 13, 16, 58, 49, 2…
## $ PhoneService     &lt;chr&gt; &quot;No&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;No&quot;, …
## $ MultipleLines    &lt;chr&gt; &quot;No phone service&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No phone service&quot;, &quot;…
## $ InternetService  &lt;chr&gt; &quot;DSL&quot;, &quot;DSL&quot;, &quot;DSL&quot;, &quot;DSL&quot;, &quot;Fiber optic&quot;, &quot;Fiber opt…
## $ OnlineSecurity   &lt;chr&gt; &quot;No&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;…
## $ OnlineBackup     &lt;chr&gt; &quot;Yes&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;N…
## $ DeviceProtection &lt;chr&gt; &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Y…
## $ TechSupport      &lt;chr&gt; &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Yes…
## $ StreamingTV      &lt;chr&gt; &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;Ye…
## $ StreamingMovies  &lt;chr&gt; &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Yes…
## $ Contract         &lt;chr&gt; &quot;Month-to-month&quot;, &quot;One year&quot;, &quot;Month-to-month&quot;, &quot;One …
## $ PaperlessBilling &lt;chr&gt; &quot;Yes&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;No&quot;, …
## $ PaymentMethod    &lt;chr&gt; &quot;Electronic check&quot;, &quot;Mailed check&quot;, &quot;Mailed check&quot;, &quot;…
## $ MonthlyCharges   &lt;dbl&gt; 29.85, 56.95, 53.85, 42.30, 70.70, 99.65, 89.10, 29.7…
## $ TotalCharges     &lt;dbl&gt; 29.85, 1889.50, 108.15, 1840.75, 151.65, 820.50, 1949…
## $ Churn            &lt;chr&gt; &quot;No&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Y…</code></pre>
<p>Como en el ejemplo de regresión, primero crearemos los conjuntos de entrenamiento y de prueba.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="aprendizaje-supervisado-1.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb92-2"><a href="aprendizaje-supervisado-1.html#cb92-2" aria-hidden="true" tabindex="-1"></a>telco_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(telco, <span class="at">prop =</span> .<span class="dv">7</span>)</span>
<span id="cb92-3"><a href="aprendizaje-supervisado-1.html#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="aprendizaje-supervisado-1.html#cb92-4" aria-hidden="true" tabindex="-1"></a>telco_train <span class="ot">&lt;-</span> <span class="fu">training</span>(telco_split)</span>
<span id="cb92-5"><a href="aprendizaje-supervisado-1.html#cb92-5" aria-hidden="true" tabindex="-1"></a>telco_test  <span class="ot">&lt;-</span> <span class="fu">testing</span>(telco_split)</span></code></pre></div>
<p>En el siguiente chunk definiremos la receta con funciones usadas en el ejemplo anterior más la función <em>step_num2factor()</em> que nos ayuda a categorizar una variable continua.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="aprendizaje-supervisado-1.html#cb93-1" aria-hidden="true" tabindex="-1"></a>binner <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb93-2"><a href="aprendizaje-supervisado-1.html#cb93-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">cut</span>(x, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">24</span>, <span class="dv">36</span>,<span class="dv">48</span>,<span class="dv">60</span>,<span class="dv">72</span>), <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb93-3"><a href="aprendizaje-supervisado-1.html#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>(x)</span>
<span id="cb93-4"><a href="aprendizaje-supervisado-1.html#cb93-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-5"><a href="aprendizaje-supervisado-1.html#cb93-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-6"><a href="aprendizaje-supervisado-1.html#cb93-6" aria-hidden="true" tabindex="-1"></a>telco_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Churn <span class="sc">~</span> ., <span class="at">data =</span> telco_train) <span class="sc">%&gt;%</span> </span>
<span id="cb93-7"><a href="aprendizaje-supervisado-1.html#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(customerID, <span class="at">new_role =</span> <span class="st">&quot;id variable&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb93-8"><a href="aprendizaje-supervisado-1.html#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_num2factor</span>(tenure, <span class="at">transform =</span> binner, </span>
<span id="cb93-9"><a href="aprendizaje-supervisado-1.html#cb93-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;0-1 year&quot;</span>, <span class="st">&quot;1-2 years&quot;</span>, <span class="st">&quot;2-3 years&quot;</span>, <span class="st">&quot;3-4 years&quot;</span>, <span class="st">&quot;4-5 years&quot;</span>, <span class="st">&quot;5-6 years&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb93-10"><a href="aprendizaje-supervisado-1.html#cb93-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb93-11"><a href="aprendizaje-supervisado-1.html#cb93-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb93-12"><a href="aprendizaje-supervisado-1.html#cb93-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_median</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb93-13"><a href="aprendizaje-supervisado-1.html#cb93-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(customerID, <span class="at">skip=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb93-14"><a href="aprendizaje-supervisado-1.html#cb93-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>()</span></code></pre></div>
<p>Ahora recuperamos la matriz de diseño con las funciones <em>prep()</em> y <em>juice()</em>.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="aprendizaje-supervisado-1.html#cb94-1" aria-hidden="true" tabindex="-1"></a>telco_juiced <span class="ot">&lt;-</span> <span class="fu">juice</span>(telco_rec)</span>
<span id="cb94-2"><a href="aprendizaje-supervisado-1.html#cb94-2" aria-hidden="true" tabindex="-1"></a>telco_juiced</span></code></pre></div>
<pre><code>## # A tibble: 4,930 × 35
##    SeniorCitizen MonthlyCharges TotalCharges Churn gender_Male Partner_Yes
##            &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt; &lt;fct&gt;       &lt;dbl&gt;       &lt;dbl&gt;
##  1        -0.442         -1.50        -0.663 No              0           0
##  2        -0.442          0.664        0.472 No              1           1
##  3        -0.442         -0.508       -0.546 No              0           0
##  4         2.26           0.649       -0.850 Yes             0           0
##  5        -0.442          0.167       -0.979 Yes             0           0
##  6        -0.442          0.842        0.975 No              1           1
##  7        -0.442          0.260       -0.648 No              1           0
##  8        -0.442         -0.668        0.178 No              1           1
##  9        -0.442         -1.20        -0.706 No              1           1
## 10        -0.442         -0.407       -0.348 No              0           0
## # … with 4,920 more rows, and 29 more variables: Dependents_Yes &lt;dbl&gt;,
## #   tenure_X1.2.years &lt;dbl&gt;, tenure_X2.3.years &lt;dbl&gt;, tenure_X3.4.years &lt;dbl&gt;,
## #   tenure_X4.5.years &lt;dbl&gt;, tenure_X5.6.years &lt;dbl&gt;, PhoneService_Yes &lt;dbl&gt;,
## #   MultipleLines_No.phone.service &lt;dbl&gt;, MultipleLines_Yes &lt;dbl&gt;,
## #   InternetService_Fiber.optic &lt;dbl&gt;, InternetService_No &lt;dbl&gt;,
## #   OnlineSecurity_No.internet.service &lt;dbl&gt;, OnlineSecurity_Yes &lt;dbl&gt;,
## #   OnlineBackup_No.internet.service &lt;dbl&gt;, OnlineBackup_Yes &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="aprendizaje-supervisado-1.html#cb96-1" aria-hidden="true" tabindex="-1"></a>telco_test_bake <span class="ot">&lt;-</span>  <span class="fu">bake</span>(telco_rec, <span class="at">new_data =</span> telco_test)</span>
<span id="cb96-2"><a href="aprendizaje-supervisado-1.html#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(telco_test_bake)</span></code></pre></div>
<pre><code>## Rows: 2,113
## Columns: 36
## $ customerID                            &lt;chr&gt; &quot;5575-GNVDE&quot;, &quot;9305-CDSKC&quot;, &quot;671…
## $ SeniorCitizen                         &lt;dbl&gt; -0.4417148, -0.4417148, -0.44171…
## $ MonthlyCharges                        &lt;dbl&gt; -0.27067882, 1.14914329, -1.1751…
## $ TotalCharges                          &lt;dbl&gt; -0.1752116, -0.6472105, -0.87618…
## $ Churn                                 &lt;fct&gt; No, Yes, No, No, No, No, No, No,…
## $ gender_Male                           &lt;dbl&gt; 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0,…
## $ Partner_Yes                           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1,…
## $ Dependents_Yes                        &lt;dbl&gt; 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0,…
## $ tenure_X1.2.years                     &lt;dbl&gt; 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0,…
## $ tenure_X2.3.years                     &lt;dbl&gt; 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ tenure_X3.4.years                     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ tenure_X4.5.years                     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,…
## $ tenure_X5.6.years                     &lt;dbl&gt; 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1,…
## $ PhoneService_Yes                      &lt;dbl&gt; 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1,…
## $ MultipleLines_No.phone.service        &lt;dbl&gt; 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0,…
## $ MultipleLines_Yes                     &lt;dbl&gt; 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1,…
## $ InternetService_Fiber.optic           &lt;dbl&gt; 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1,…
## $ InternetService_No                    &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0,…
## $ OnlineSecurity_No.internet.service    &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0,…
## $ OnlineSecurity_Yes                    &lt;dbl&gt; 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1,…
## $ OnlineBackup_No.internet.service      &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0,…
## $ OnlineBackup_Yes                      &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1,…
## $ DeviceProtection_No.internet.service  &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0,…
## $ DeviceProtection_Yes                  &lt;dbl&gt; 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1,…
## $ TechSupport_No.internet.service       &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0,…
## $ TechSupport_Yes                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1,…
## $ StreamingTV_No.internet.service       &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0,…
## $ StreamingTV_Yes                       &lt;dbl&gt; 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0,…
## $ StreamingMovies_No.internet.service   &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0,…
## $ StreamingMovies_Yes                   &lt;dbl&gt; 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0,…
## $ Contract_One.year                     &lt;dbl&gt; 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,…
## $ Contract_Two.year                     &lt;dbl&gt; 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1,…
## $ PaperlessBilling_Yes                  &lt;dbl&gt; 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1,…
## $ PaymentMethod_Credit.card..automatic. &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1,…
## $ PaymentMethod_Electronic.check        &lt;dbl&gt; 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0,…
## $ PaymentMethod_Mailed.check            &lt;dbl&gt; 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,…</code></pre>
<p>Estos fueron dos ejemplos aplicados de la paquetería <em>recipies</em>, existen distintas funciones <em>step</em> que pueden implementarse en recetas para usarse con <em>tidymodels</em>, en las secciones siguientes les daremos su uso para ajustar un modelo completo.</p>
</div>
</div>
<div id="regresión-lineal" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Regresión Lineal</h2>
<p>En esta sección aprenderemos sobre <em><strong>regresión lineal simple y múltiple</strong></em>, como se ajusta un modelo de regresión en <em>R</em>, las métricas de desempeño para problemas de regresión y como podemos comparar modelos con estas métricas. Existen dos tipos de modelos de regresión lineal:</p>
<ul>
<li><strong>Regresión lineal simple:</strong> En la regresión lineal simple se utiliza <strong>una variable independiente o explicativa “X”</strong> (numérica o categórica) para estimar una variable dependiente o de respuesta numérica <em><strong>“Y”</strong></em> mediante el ajuste de una recta permita conocer la relación existente entre ambas variables. Dicha relación entre variables se expresa como:</li>
</ul>
<p><span class="math display">\[Y = \beta_0 + \beta_1X_1 + \epsilon \approx b + mx\]</span>
<strong>Donde:</strong></p>
<blockquote>
<p><span class="math inline">\(\epsilon \sim Norm(0,\sigma^2)\)</span> (error aleatorio)</p>
<p><span class="math inline">\(\beta_0\)</span> = Coeficiente de regresión 0 (Ordenada al origen o intercepto)</p>
<p><span class="math inline">\(\beta_1\)</span> = Coeficiente de regresión 1 (Pendiente o regresor de variable <span class="math inline">\(X_1\)</span>)</p>
<p><span class="math inline">\(X_1\)</span> = Variable explicativa observada</p>
<p><span class="math inline">\(Y\)</span> = Respuesta numérica</p>
</blockquote>
<p>Debido a que los valores reales de <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> son desconocidos, procedemos a estimarlos estadísticamente:</p>
<p><span class="math display">\[\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1X_1\]</span>
Con <span class="math inline">\(\hat{\beta}_0\)</span> el estimado de la ordenada al origen y <span class="math inline">\(\hat{\beta}_1\)</span> el estimado de la pendiente.</p>
<div id="htmlwidget-9cb9cb1fd3f43ee7565a" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9cb9cb1fd3f43ee7565a">{"x":{"visdat":{"1b6a9b30060c5b":["function () ","plotlyVisDat"]},"cur_data":"1b6a9b30060c5b","attrs":{"1b6a9b30060c5b":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"type":"scatter","mode":"markers","inherit":true},"1b6a9b30060c5b.1":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":[55.7960652924429,52.4655115657133,26.9312663274514,33.0372814931227,14.1641437083206,49.1349578389833,20.2701588739918,-14.7006552566709,58.5715267313844,43.0289426733121,45.8044041122536,36.3678352198525,23.6007126007216,33.0372814931227,30.2618200541812,-5.26408636426986,33.0372814931227,43.0289426733121,43.0289426733121,4.72757481591949,43.0289426733121,30.2618200541812,30.2618200541812,14.1641437083206,65.232634184844,55.7960652924429,43.0289426733121,20.2701588739918,33.0372814931227,52.4655115657131,14.1641437083206,-18.0312089834007,45.8044041122536,33.0372814931227,39.6983889465823,74.1141107894568,45.8044041122536,45.8044041122536,71.3386493505153,36.3678352198525,68.5631879115738,61.9020804581142,65.232634184844,55.7960652924429,17.4946974350504,14.1641437083206,17.4946974350504,58.5715267313844,39.6983889465823,61.9020804581142,68.5631879115738,33.0372814931227,58.5715267313844,49.1349578389833,52.4655115657131,49.1349578389833,30.2618200541812,55.7960652924429,55.7960652924429,55.7960652924429,45.8044041122536,58.5715267313844,20.2701588739918,55.7960652924429,58.5715267313844,55.7960652924429,71.3386493505153,74.6692030772451,39.6983889465823,52.4655115657131,33.0372814931227,33.0372814931227,43.0289426733121,39.6983889465823,61.9020804581142,55.7960652924429,36.3678352198525,39.6983889465823,10.8335899815908,17.4946974350504,43.0289426733121,77.9997568039748,52.4655115657131,43.0289426733121,84.1057719696461,61.9020804581142,61.9020804581142,58.5715267313844,68.5631879115738,81.3303105307046,71.3386493505153,55.7960652924429,10.8335899815908,36.3678352198525,39.6983889465823,36.3678352198525,43.0289426733121,14.1641437083206,10.8335899815908,61.9020804581142,36.3678352198525,33.0372814931227,58.5715267313844,20.2701588739918,39.6983889465823,39.6983889465823,52.4655115657131,26.9312663274514,45.8044041122536,39.6983889465823,39.6983889465823,4.72757481591949,58.5715267313844,17.4946974350504,52.4655115657131,33.0372814931227],"type":"scatter","mode":"lines","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Wind"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Ozone"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[7.4,8,12.6,11.5,14.9,8.6,13.8,20.1,6.9,9.7,9.2,10.9,13.2,11.5,12,18.4,11.5,9.7,9.7,16.6,9.7,12,12,14.9,5.7,7.4,9.7,13.8,11.5,8,14.9,20.7,9.2,11.5,10.3,4.1,9.2,9.2,4.6,10.9,5.1,6.3,5.7,7.4,14.3,14.9,14.3,6.9,10.3,6.3,5.1,11.5,6.9,8.6,8,8.6,12,7.4,7.4,7.4,9.2,6.9,13.8,7.4,6.9,7.4,4.6,4,10.3,8,11.5,11.5,9.7,10.3,6.3,7.4,10.9,10.3,15.5,14.3,9.7,3.4,8,9.7,2.3,6.3,6.3,6.9,5.1,2.8,4.6,7.4,15.5,10.9,10.3,10.9,9.7,14.9,15.5,6.3,10.9,11.5,6.9,13.8,10.3,10.3,8,12.6,9.2,10.3,10.3,16.6,6.9,14.3,8,11.5],"y":[41,36,12,18,28,23,19,8,7,16,11,14,18,14,34,6,30,11,1,11,4,32,23,45,115,37,29,71,39,23,21,37,20,12,13,135,49,32,64,40,77,97,97,85,10,27,7,48,35,61,79,63,16,80,108,20,52,82,50,64,59,39,9,16,78,35,66,122,89,110,44,28,65,22,59,23,31,44,21,9,45,168,73,76,118,84,85,96,78,73,91,47,32,20,23,21,24,44,21,28,9,13,46,18,13,24,16,13,23,36,7,14,30,14,18,20],"type":"scatter","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2.3,2.8,3.4,4,4.1,4.6,4.6,4.6,5.1,5.1,5.1,5.7,5.7,6.3,6.3,6.3,6.3,6.3,6.3,6.9,6.9,6.9,6.9,6.9,6.9,6.9,6.9,7.4,7.4,7.4,7.4,7.4,7.4,7.4,7.4,7.4,7.4,8,8,8,8,8,8,8,8.6,8.6,8.6,9.2,9.2,9.2,9.2,9.2,9.2,9.7,9.7,9.7,9.7,9.7,9.7,9.7,9.7,9.7,10.3,10.3,10.3,10.3,10.3,10.3,10.3,10.3,10.3,10.3,10.9,10.9,10.9,10.9,10.9,10.9,11.5,11.5,11.5,11.5,11.5,11.5,11.5,11.5,11.5,11.5,12,12,12,12,12.6,12.6,13.2,13.8,13.8,13.8,13.8,14.3,14.3,14.3,14.3,14.9,14.9,14.9,14.9,14.9,15.5,15.5,15.5,16.6,16.6,18.4,20.1,20.7],"y":[84.1057719696461,81.3303105307046,77.9997568039748,74.6692030772451,74.1141107894568,71.3386493505153,71.3386493505153,71.3386493505153,68.5631879115738,68.5631879115738,68.5631879115738,65.232634184844,65.232634184844,61.9020804581142,61.9020804581142,61.9020804581142,61.9020804581142,61.9020804581142,61.9020804581142,58.5715267313844,58.5715267313844,58.5715267313844,58.5715267313844,58.5715267313844,58.5715267313844,58.5715267313844,58.5715267313844,55.7960652924429,55.7960652924429,55.7960652924429,55.7960652924429,55.7960652924429,55.7960652924429,55.7960652924429,55.7960652924429,55.7960652924429,55.7960652924429,52.4655115657133,52.4655115657131,52.4655115657131,52.4655115657131,52.4655115657131,52.4655115657131,52.4655115657131,49.1349578389833,49.1349578389833,49.1349578389833,45.8044041122536,45.8044041122536,45.8044041122536,45.8044041122536,45.8044041122536,45.8044041122536,43.0289426733121,43.0289426733121,43.0289426733121,43.0289426733121,43.0289426733121,43.0289426733121,43.0289426733121,43.0289426733121,43.0289426733121,39.6983889465823,39.6983889465823,39.6983889465823,39.6983889465823,39.6983889465823,39.6983889465823,39.6983889465823,39.6983889465823,39.6983889465823,39.6983889465823,36.3678352198525,36.3678352198525,36.3678352198525,36.3678352198525,36.3678352198525,36.3678352198525,33.0372814931227,33.0372814931227,33.0372814931227,33.0372814931227,33.0372814931227,33.0372814931227,33.0372814931227,33.0372814931227,33.0372814931227,33.0372814931227,30.2618200541812,30.2618200541812,30.2618200541812,30.2618200541812,26.9312663274514,26.9312663274514,23.6007126007216,20.2701588739918,20.2701588739918,20.2701588739918,20.2701588739918,17.4946974350504,17.4946974350504,17.4946974350504,17.4946974350504,14.1641437083206,14.1641437083206,14.1641437083206,14.1641437083206,14.1641437083206,10.8335899815908,10.8335899815908,10.8335899815908,4.72757481591949,4.72757481591949,-5.26408636426986,-14.7006552566709,-18.0312089834007],"type":"scatter","mode":"lines","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<ul>
<li><strong>Regresión lineal múltiple:</strong> Cuando se utiliza <strong>más de una</strong> variable independiente, el proceso se denomina regresión lineal múltiple. En este escenario no es una recta sino un hiper-plano lo que se ajusta a partir de las covariables explicativas <span class="math inline">\(\{X_1, X_2, X_3, ...,X_n\}\)</span></li>
</ul>
<p>El objetivo de un modelo de regresión múltiple es tratar de explicar la relación que existe entre una
variable dependiente (variable respuesta) <span class="math inline">\(&quot;Y&quot;\)</span> un conjunto de variables independientes (variables
explicativas) <span class="math inline">\(\{X1,..., Xm\}\)</span>, el modelo es de la forma:</p>
<p><span class="math display">\[Y = \beta_0 + \beta_1X_1 + \cdot \cdot \cdot + \beta_mX_m + \epsilon\]</span></p>
<ul>
<li><p><strong>Donde:</strong></p></li>
<li><p><span class="math inline">\(Y\)</span> como variable respuesta.</p></li>
<li><p><span class="math inline">\(X_1,X_2,...,X_m\)</span> como las variables explicativas, independientes o regresoras.</p></li>
<li><p><span class="math inline">\(\beta_1, \beta_2,...,\beta_m\)</span> Se conocen como coeficientes parciales de regresión. Cada una de ellas puede interpretarse como el efecto promedio que tiene el incremento de una unidad de la variable predictora <span class="math inline">\(X_i\)</span> sobre la variable dependiente <span class="math inline">\(Y\)</span>, manteniéndose constantes el resto de variables.</p></li>
</ul>
<div id="htmlwidget-d8e12a0124838a1515d7" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d8e12a0124838a1515d7">{"x":{"visdat":{"1b6a9b49005a5d":["function () ","plotlyVisDat"]},"cur_data":"1b6a9b49005a5d","attrs":{"1b6a9b49005a5d":{"x":{},"y":{},"z":{},"text":{},"mode":"markers","marker":{"color":["red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green"]},"size":1,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"},"1b6a9b49005a5d.1":{"x":[4.3,4.35,4.4,4.45,4.5,4.55,4.6,4.65,4.7,4.75,4.8,4.85,4.9,4.95,5,5.05,5.1,5.15,5.2,5.25,5.3,5.35,5.4,5.45,5.5,5.55,5.6,5.65,5.7,5.75,5.8,5.85,5.9,5.95,6,6.05,6.1,6.15,6.2,6.25,6.3,6.35,6.4,6.45,6.5,6.55,6.6,6.65,6.7,6.75,6.8,6.85,6.9,6.95,7,7.05,7.1,7.15,7.2,7.25,7.3,7.35,7.4,7.45,7.5,7.55,7.6,7.65,7.7,7.75,7.8,7.85,7.9],"y":[2,2.05,2.1,2.15,2.2,2.25,2.3,2.35,2.4,2.45,2.5,2.55,2.6,2.65,2.7,2.75,2.8,2.85,2.9,2.95,3,3.05,3.1,3.15,3.2,3.25,3.3,3.35,3.4,3.45,3.5,3.55,3.6,3.65,3.7,3.75,3.8,3.85,3.9,3.95,4,4.05,4.1,4.15,4.2,4.25,4.3,4.35,4.4],"z":[[3.21788560449767,3.29590065492146,3.37391570534526,3.45193075576905,3.52994580619285,3.60796085661665,3.68597590704044,3.76399095746424,3.84200600788803,3.92002105831183,3.99803610873563,4.07605115915942,4.15406620958322,4.23208126000701,4.31009631043081,4.38811136085461,4.4661264112784,4.5441414617022,4.62215651212599,4.70017156254979,4.77818661297359,4.85620166339738,4.93421671382118,5.01223176424497,5.09024681466877,5.16826186509257,5.24627691551636,5.32429196594016,5.40230701636395,5.48032206678775,5.55833711721155,5.63635216763534,5.71436721805914,5.79238226848294,5.87039731890673,5.94841236933053,6.02642741975432,6.10444247017812,6.18245752060191,6.26047257102571,6.33848762144951,6.4165026718733,6.4945177222971,6.57253277272089,6.65054782314469,6.72856287356849,6.80657792399228,6.88459297441608,6.96260802483988,7.04062307526367,7.11863812568747,7.19665317611126,7.27466822653506,7.35268327695885,7.43069832738265,7.50871337780645,7.58672842823024,7.66474347865404,7.74275852907784,7.82077357950163,7.89878862992543,7.97680368034922,8.05481873077302,8.13283378119682,8.21084883162061,8.28886388204441,8.3668789324682,8.444893982892,8.52290903331579,8.60092408373959,8.67893913416339,8.75695418458718,8.83496923501098],[3.13060038619895,3.20861543662274,3.28663048704654,3.36464553747033,3.44266058789413,3.52067563831793,3.59869068874172,3.67670573916552,3.75472078958931,3.83273584001311,3.91075089043691,3.9887659408607,4.0667809912845,4.14479604170829,4.22281109213209,4.30082614255589,4.37884119297968,4.45685624340348,4.53487129382727,4.61288634425107,4.69090139467487,4.76891644509866,4.84693149552246,4.92494654594626,5.00296159637005,5.08097664679385,5.15899169721764,5.23700674764144,5.31502179806524,5.39303684848903,5.47105189891283,5.54906694933662,5.62708199976042,5.70509705018422,5.78311210060801,5.86112715103181,5.9391422014556,6.0171572518794,6.0951723023032,6.17318735272699,6.25120240315079,6.32921745357458,6.40723250399838,6.48524755442218,6.56326260484597,6.64127765526977,6.71929270569356,6.79730775611736,6.87532280654116,6.95333785696495,7.03135290738875,7.10936795781254,7.18738300823634,7.26539805866014,7.34341310908393,7.42142815950773,7.49944320993152,7.57745826035532,7.65547331077912,7.73348836120291,7.81150341162671,7.8895184620505,7.9675335124743,8.0455485628981,8.12356361332189,8.20157866374569,8.27959371416948,8.35760876459328,8.43562381501708,8.51363886544087,8.59165391586467,8.66966896628846,8.74768401671226],[3.04331516790023,3.12133021832402,3.19934526874782,3.27736031917161,3.35537536959541,3.43339042001921,3.511405470443,3.5894205208668,3.66743557129059,3.74545062171439,3.82346567213819,3.90148072256198,3.97949577298578,4.05751082340957,4.13552587383337,4.21354092425717,4.29155597468096,4.36957102510476,4.44758607552855,4.52560112595235,4.60361617637615,4.68163122679994,4.75964627722374,4.83766132764754,4.91567637807133,4.99369142849513,5.07170647891892,5.14972152934272,5.22773657976651,5.30575163019031,5.38376668061411,5.4617817310379,5.5397967814617,5.6178118318855,5.69582688230929,5.77384193273309,5.85185698315688,5.92987203358068,6.00788708400448,6.08590213442827,6.16391718485207,6.24193223527586,6.31994728569966,6.39796233612345,6.47597738654725,6.55399243697105,6.63200748739484,6.71002253781864,6.78803758824244,6.86605263866623,6.94406768909003,7.02208273951382,7.10009778993762,7.17811284036142,7.25612789078521,7.33414294120901,7.4121579916328,7.4901730420566,7.5681880924804,7.64620314290419,7.72421819332799,7.80223324375178,7.88024829417558,7.95826334459938,8.03627839502317,8.11429344544697,8.19230849587076,8.27032354629456,8.34833859671836,8.42635364714215,8.50436869756595,8.58238374798974,8.66039879841354],[2.95602994960151,3.0340450000253,3.1120600504491,3.19007510087289,3.26809015129669,3.34610520172049,3.42412025214428,3.50213530256808,3.58015035299188,3.65816540341567,3.73618045383947,3.81419550426326,3.89221055468706,3.97022560511086,4.04824065553465,4.12625570595845,4.20427075638224,4.28228580680604,4.36030085722983,4.43831590765363,4.51633095807743,4.59434600850122,4.67236105892502,4.75037610934882,4.82839115977261,4.90640621019641,4.9844212606202,5.062436311044,5.14045136146779,5.21846641189159,5.29648146231539,5.37449651273918,5.45251156316298,5.53052661358678,5.60854166401057,5.68655671443437,5.76457176485816,5.84258681528196,5.92060186570576,5.99861691612955,6.07663196655335,6.15464701697714,6.23266206740094,6.31067711782473,6.38869216824853,6.46670721867233,6.54472226909612,6.62273731951992,6.70075236994372,6.77876742036751,6.85678247079131,6.9347975212151,7.0128125716389,7.0908276220627,7.16884267248649,7.24685772291029,7.32487277333408,7.40288782375788,7.48090287418168,7.55891792460547,7.63693297502927,7.71494802545306,7.79296307587686,7.87097812630066,7.94899317672445,8.02700822714825,8.10502327757204,8.18303832799584,8.26105337841964,8.33906842884343,8.41708347926723,8.49509852969102,8.57311358011482],[2.86874473130279,2.94675978172658,3.02477483215038,3.10278988257417,3.18080493299797,3.25881998342177,3.33683503384556,3.41485008426936,3.49286513469315,3.57088018511695,3.64889523554075,3.72691028596454,3.80492533638834,3.88294038681213,3.96095543723593,4.03897048765973,4.11698553808352,4.19500058850732,4.27301563893111,4.35103068935491,4.42904573977871,4.5070607902025,4.5850758406263,4.6630908910501,4.74110594147389,4.81912099189769,4.89713604232148,4.97515109274528,5.05316614316907,5.13118119359287,5.20919624401667,5.28721129444046,5.36522634486426,5.44324139528806,5.52125644571185,5.59927149613565,5.67728654655944,5.75530159698324,5.83331664740704,5.91133169783083,5.98934674825463,6.06736179867842,6.14537684910222,6.22339189952601,6.30140694994981,6.37942200037361,6.4574370507974,6.5354521012212,6.613467151645,6.69148220206879,6.76949725249259,6.84751230291638,6.92552735334018,7.00354240376398,7.08155745418777,7.15957250461157,7.23758755503536,7.31560260545916,7.39361765588296,7.47163270630675,7.54964775673055,7.62766280715434,7.70567785757814,7.78369290800194,7.86170795842573,7.93972300884953,8.01773805927332,8.09575310969712,8.17376816012091,8.25178321054471,8.32979826096851,8.4078133113923,8.4858283618161],[2.78145951300407,2.85947456342786,2.93748961385166,3.01550466427546,3.09351971469925,3.17153476512305,3.24954981554684,3.32756486597064,3.40557991639444,3.48359496681823,3.56161001724203,3.63962506766582,3.71764011808962,3.79565516851342,3.87367021893721,3.95168526936101,4.0297003197848,4.1077153702086,4.1857304206324,4.26374547105619,4.34176052147999,4.41977557190378,4.49779062232758,4.57580567275138,4.65382072317517,4.73183577359897,4.80985082402276,4.88786587444656,4.96588092487036,5.04389597529415,5.12191102571795,5.19992607614174,5.27794112656554,5.35595617698934,5.43397122741313,5.51198627783693,5.59000132826072,5.66801637868452,5.74603142910832,5.82404647953211,5.90206152995591,5.9800765803797,6.0580916308035,6.1361066812273,6.21412173165109,6.29213678207489,6.37015183249868,6.44816688292248,6.52618193334628,6.60419698377007,6.68221203419387,6.76022708461766,6.83824213504146,6.91625718546526,6.99427223588905,7.07228728631285,7.15030233673664,7.22831738716044,7.30633243758424,7.38434748800803,7.46236253843183,7.54037758885562,7.61839263927942,7.69640768970322,7.77442274012701,7.85243779055081,7.9304528409746,8.0084678913984,8.0864829418222,8.16449799224599,8.24251304266979,8.32052809309359,8.39854314351738],[2.69417429470535,2.77218934512914,2.85020439555294,2.92821944597674,3.00623449640053,3.08424954682433,3.16226459724812,3.24027964767192,3.31829469809572,3.39630974851951,3.47432479894331,3.5523398493671,3.6303548997909,3.7083699502147,3.78638500063849,3.86440005106229,3.94241510148608,4.02043015190988,4.09844520233368,4.17646025275747,4.25447530318127,4.33249035360506,4.41050540402886,4.48852045445266,4.56653550487645,4.64455055530025,4.72256560572404,4.80058065614784,4.87859570657164,4.95661075699543,5.03462580741923,5.11264085784302,5.19065590826682,5.26867095869062,5.34668600911441,5.42470105953821,5.502716109962,5.5807311603858,5.6587462108096,5.73676126123339,5.81477631165719,5.89279136208098,5.97080641250478,6.04882146292858,6.12683651335237,6.20485156377617,6.28286661419996,6.36088166462376,6.43889671504756,6.51691176547135,6.59492681589515,6.67294186631894,6.75095691674274,6.82897196716654,6.90698701759033,6.98500206801413,7.06301711843792,7.14103216886172,7.21904721928552,7.29706226970931,7.37507732013311,7.4530923705569,7.5311074209807,7.6091224714045,7.68713752182829,7.76515257225209,7.84316762267588,7.92118267309968,7.99919772352348,8.07721277394727,8.15522782437107,8.23324287479486,8.31125792521866],[2.60688907640663,2.68490412683042,2.76291917725422,2.84093422767801,2.91894927810181,2.99696432852561,3.0749793789494,3.1529944293732,3.231009479797,3.30902453022079,3.38703958064459,3.46505463106838,3.54306968149218,3.62108473191598,3.69909978233977,3.77711483276357,3.85512988318736,3.93314493361116,4.01115998403495,4.08917503445875,4.16719008488255,4.24520513530634,4.32322018573014,4.40123523615394,4.47925028657773,4.55726533700153,4.63528038742532,4.71329543784912,4.79131048827292,4.86932553869671,4.94734058912051,5.0253556395443,5.1033706899681,5.1813857403919,5.25940079081569,5.33741584123949,5.41543089166328,5.49344594208708,5.57146099251088,5.64947604293467,5.72749109335847,5.80550614378226,5.88352119420606,5.96153624462986,6.03955129505365,6.11756634547745,6.19558139590124,6.27359644632504,6.35161149674884,6.42962654717263,6.50764159759643,6.58565664802022,6.66367169844402,6.74168674886782,6.81970179929161,6.89771684971541,6.9757319001392,7.053746950563,7.1317620009868,7.20977705141059,7.28779210183439,7.36580715225818,7.44382220268198,7.52183725310578,7.59985230352957,7.67786735395337,7.75588240437716,7.83389745480096,7.91191250522476,7.98992755564855,8.06794260607235,8.14595765649614,8.22397270691994],[2.51960385810791,2.5976189085317,2.6756339589555,2.7536490093793,2.83166405980309,2.90967911022689,2.98769416065068,3.06570921107448,3.14372426149828,3.22173931192207,3.29975436234587,3.37776941276966,3.45578446319346,3.53379951361726,3.61181456404105,3.68982961446485,3.76784466488864,3.84585971531244,3.92387476573624,4.00188981616003,4.07990486658383,4.15791991700762,4.23593496743142,4.31395001785522,4.39196506827901,4.46998011870281,4.5479951691266,4.6260102195504,4.7040252699742,4.78204032039799,4.86005537082179,4.93807042124558,5.01608547166938,5.09410052209318,5.17211557251697,5.25013062294077,5.32814567336456,5.40616072378836,5.48417577421216,5.56219082463595,5.64020587505975,5.71822092548354,5.79623597590734,5.87425102633114,5.95226607675493,6.03028112717873,6.10829617760252,6.18631122802632,6.26432627845012,6.34234132887391,6.42035637929771,6.4983714297215,6.5763864801453,6.6544015305691,6.73241658099289,6.81043163141669,6.88844668184049,6.96646173226428,7.04447678268808,7.12249183311187,7.20050688353567,7.27852193395946,7.35653698438326,7.43455203480706,7.51256708523085,7.59058213565465,7.66859718607844,7.74661223650224,7.82462728692604,7.90264233734983,7.98065738777363,8.05867243819743,8.13668748862122],[2.43231863980919,2.51033369023298,2.58834874065678,2.66636379108058,2.74437884150437,2.82239389192817,2.90040894235196,2.97842399277576,3.05643904319956,3.13445409362335,3.21246914404715,3.29048419447094,3.36849924489474,3.44651429531854,3.52452934574233,3.60254439616613,3.68055944658992,3.75857449701372,3.83658954743752,3.91460459786131,3.99261964828511,4.0706346987089,4.1486497491327,4.2266647995565,4.30467984998029,4.38269490040409,4.46070995082788,4.53872500125168,4.61674005167548,4.69475510209927,4.77277015252307,4.85078520294686,4.92880025337066,5.00681530379446,5.08483035421825,5.16284540464205,5.24086045506584,5.31887550548964,5.39689055591344,5.47490560633723,5.55292065676103,5.63093570718482,5.70895075760862,5.78696580803242,5.86498085845621,5.94299590888001,6.0210109593038,6.0990260097276,6.1770410601514,6.25505611057519,6.33307116099899,6.41108621142278,6.48910126184658,6.56711631227038,6.64513136269417,6.72314641311797,6.80116146354177,6.87917651396556,6.95719156438936,7.03520661481315,7.11322166523695,7.19123671566074,7.26925176608454,7.34726681650834,7.42528186693213,7.50329691735593,7.58131196777972,7.65932701820352,7.73734206862732,7.81535711905111,7.89337216947491,7.97138721989871,8.0494022703225],[2.34503342151047,2.42304847193426,2.50106352235806,2.57907857278186,2.65709362320565,2.73510867362945,2.81312372405324,2.89113877447704,2.96915382490084,3.04716887532463,3.12518392574843,3.20319897617222,3.28121402659602,3.35922907701982,3.43724412744361,3.51525917786741,3.5932742282912,3.671289278715,3.7493043291388,3.82731937956259,3.90533442998639,3.98334948041018,4.06136453083398,4.13937958125778,4.21739463168157,4.29540968210537,4.37342473252916,4.45143978295296,4.52945483337676,4.60746988380055,4.68548493422435,4.76349998464814,4.84151503507194,4.91953008549574,4.99754513591953,5.07556018634333,5.15357523676712,5.23159028719092,5.30960533761472,5.38762038803851,5.46563543846231,5.5436504888861,5.6216655393099,5.6996805897337,5.77769564015749,5.85571069058129,5.93372574100508,6.01174079142888,6.08975584185268,6.16777089227647,6.24578594270027,6.32380099312406,6.40181604354786,6.47983109397166,6.55784614439545,6.63586119481925,6.71387624524305,6.79189129566684,6.86990634609064,6.94792139651443,7.02593644693823,7.10395149736202,7.18196654778582,7.25998159820962,7.33799664863341,7.41601169905721,7.494026749481,7.5720417999048,7.6500568503286,7.72807190075239,7.80608695117619,7.88410200159999,7.96211705202378],[2.25774820321175,2.33576325363554,2.41377830405934,2.49179335448314,2.56980840490693,2.64782345533073,2.72583850575452,2.80385355617832,2.88186860660212,2.95988365702591,3.03789870744971,3.1159137578735,3.1939288082973,3.2719438587211,3.34995890914489,3.42797395956869,3.50598900999248,3.58400406041628,3.66201911084008,3.74003416126387,3.81804921168767,3.89606426211146,3.97407931253526,4.05209436295906,4.13010941338285,4.20812446380665,4.28613951423044,4.36415456465424,4.44216961507804,4.52018466550183,4.59819971592563,4.67621476634943,4.75422981677322,4.83224486719702,4.91025991762081,4.98827496804461,5.0662900184684,5.1443050688922,5.222320119316,5.30033516973979,5.37835022016359,5.45636527058738,5.53438032101118,5.61239537143498,5.69041042185877,5.76842547228257,5.84644052270637,5.92445557313016,6.00247062355396,6.08048567397775,6.15850072440155,6.23651577482535,6.31453082524914,6.39254587567294,6.47056092609673,6.54857597652053,6.62659102694433,6.70460607736812,6.78262112779192,6.86063617821571,6.93865122863951,7.01666627906331,7.0946813294871,7.1726963799109,7.25071143033469,7.32872648075849,7.40674153118229,7.48475658160608,7.56277163202988,7.64078668245368,7.71880173287747,7.79681678330127,7.87483183372506],[2.17046298491303,2.24847803533682,2.32649308576062,2.40450813618442,2.48252318660821,2.56053823703201,2.6385532874558,2.7165683378796,2.7945833883034,2.87259843872719,2.95061348915099,3.02862853957478,3.10664358999858,3.18465864042238,3.26267369084617,3.34068874126997,3.41870379169376,3.49671884211756,3.57473389254136,3.65274894296515,3.73076399338895,3.80877904381274,3.88679409423654,3.96480914466034,4.04282419508413,4.12083924550793,4.19885429593172,4.27686934635552,4.35488439677932,4.43289944720311,4.51091449762691,4.5889295480507,4.6669445984745,4.7449596488983,4.82297469932209,4.90098974974589,4.97900480016968,5.05701985059348,5.13503490101728,5.21304995144107,5.29106500186487,5.36908005228866,5.44709510271246,5.52511015313626,5.60312520356005,5.68114025398385,5.75915530440764,5.83717035483144,5.91518540525524,5.99320045567903,6.07121550610283,6.14923055652662,6.22724560695042,6.30526065737422,6.38327570779801,6.46129075822181,6.53930580864561,6.6173208590694,6.6953359094932,6.77335095991699,6.85136601034079,6.92938106076458,7.00739611118838,7.08541116161218,7.16342621203597,7.24144126245977,7.31945631288356,7.39747136330736,7.47548641373116,7.55350146415495,7.63151651457875,7.70953156500255,7.78754661542634],[2.08317776661431,2.1611928170381,2.2392078674619,2.3172229178857,2.39523796830949,2.47325301873329,2.55126806915708,2.62928311958088,2.70729817000468,2.78531322042847,2.86332827085227,2.94134332127606,3.01935837169986,3.09737342212366,3.17538847254745,3.25340352297125,3.33141857339504,3.40943362381884,3.48744867424264,3.56546372466643,3.64347877509023,3.72149382551402,3.79950887593782,3.87752392636162,3.95553897678541,4.03355402720921,4.111569077633,4.1895841280568,4.2675991784806,4.34561422890439,4.42362927932819,4.50164432975199,4.57965938017578,4.65767443059958,4.73568948102337,4.81370453144717,4.89171958187096,4.96973463229476,5.04774968271856,5.12576473314235,5.20377978356615,5.28179483398994,5.35980988441374,5.43782493483754,5.51583998526133,5.59385503568513,5.67187008610893,5.74988513653272,5.82790018695652,5.90591523738031,5.98393028780411,6.0619453382279,6.1399603886517,6.2179754390755,6.29599048949929,6.37400553992309,6.45202059034689,6.53003564077068,6.60805069119448,6.68606574161827,6.76408079204207,6.84209584246587,6.92011089288966,6.99812594331346,7.07614099373725,7.15415604416105,7.23217109458484,7.31018614500864,7.38820119543244,7.46621624585624,7.54423129628003,7.62224634670383,7.70026139712762],[1.99589254831559,2.07390759873938,2.15192264916318,2.22993769958698,2.30795275001077,2.38596780043457,2.46398285085836,2.54199790128216,2.62001295170596,2.69802800212975,2.77604305255355,2.85405810297734,2.93207315340114,3.01008820382494,3.08810325424873,3.16611830467253,3.24413335509632,3.32214840552012,3.40016345594392,3.47817850636771,3.55619355679151,3.6342086072153,3.7122236576391,3.7902387080629,3.86825375848669,3.94626880891049,4.02428385933428,4.10229890975808,4.18031396018188,4.25832901060567,4.33634406102947,4.41435911145327,4.49237416187706,4.57038921230086,4.64840426272465,4.72641931314845,4.80443436357224,4.88244941399604,4.96046446441984,5.03847951484363,5.11649456526743,5.19450961569122,5.27252466611502,5.35053971653882,5.42855476696261,5.50656981738641,5.58458486781021,5.662599918234,5.7406149686578,5.81863001908159,5.89664506950539,5.97466011992918,6.05267517035298,6.13069022077678,6.20870527120057,6.28672032162437,6.36473537204817,6.44275042247196,6.52076547289576,6.59878052331955,6.67679557374335,6.75481062416715,6.83282567459094,6.91084072501474,6.98885577543853,7.06687082586233,7.14488587628612,7.22290092670992,7.30091597713372,7.37893102755752,7.45694607798131,7.53496112840511,7.6129761788289],[1.90860733001687,1.98662238044066,2.06463743086446,2.14265248128826,2.22066753171205,2.29868258213585,2.37669763255964,2.45471268298344,2.53272773340724,2.61074278383103,2.68875783425483,2.76677288467862,2.84478793510242,2.92280298552622,3.00081803595001,3.07883308637381,3.1568481367976,3.2348631872214,3.3128782376452,3.39089328806899,3.46890833849279,3.54692338891658,3.62493843934038,3.70295348976418,3.78096854018797,3.85898359061177,3.93699864103556,4.01501369145936,4.09302874188316,4.17104379230695,4.24905884273075,4.32707389315455,4.40508894357834,4.48310399400214,4.56111904442593,4.63913409484973,4.71714914527352,4.79516419569732,4.87317924612112,4.95119429654491,5.02920934696871,5.1072243973925,5.1852394478163,5.2632544982401,5.34126954866389,5.41928459908769,5.49729964951149,5.57531469993528,5.65332975035908,5.73134480078287,5.80935985120667,5.88737490163046,5.96538995205426,6.04340500247806,6.12142005290185,6.19943510332565,6.27745015374945,6.35546520417324,6.43348025459704,6.51149530502083,6.58951035544463,6.66752540586843,6.74554045629222,6.82355550671602,6.90157055713981,6.97958560756361,7.0576006579874,7.1356157084112,7.213630758835,7.2916458092588,7.36966085968259,7.44767591010639,7.52569096053018],[1.82132211171815,1.89933716214194,1.97735221256574,2.05536726298954,2.13338231341333,2.21139736383713,2.28941241426092,2.36742746468472,2.44544251510852,2.52345756553231,2.60147261595611,2.6794876663799,2.7575027168037,2.8355177672275,2.91353281765129,2.99154786807509,3.06956291849889,3.14757796892268,3.22559301934648,3.30360806977027,3.38162312019407,3.45963817061787,3.53765322104166,3.61566827146546,3.69368332188925,3.77169837231305,3.84971342273685,3.92772847316064,4.00574352358444,4.08375857400823,4.16177362443203,4.23978867485583,4.31780372527962,4.39581877570342,4.47383382612721,4.55184887655101,4.62986392697481,4.7078789773986,4.7858940278224,4.86390907824619,4.94192412866999,5.01993917909379,5.09795422951758,5.17596927994138,5.25398433036518,5.33199938078897,5.41001443121277,5.48802948163656,5.56604453206036,5.64405958248415,5.72207463290795,5.80008968333175,5.87810473375554,5.95611978417934,6.03413483460313,6.11214988502693,6.19016493545073,6.26817998587452,6.34619503629832,6.42421008672212,6.50222513714591,6.58024018756971,6.6582552379935,6.7362702884173,6.81428533884109,6.89230038926489,6.97031543968869,7.04833049011248,7.12634554053628,7.20436059096008,7.28237564138387,7.36039069180767,7.43840574223146],[1.73403689341943,1.81205194384322,1.89006699426702,1.96808204469082,2.04609709511461,2.12411214553841,2.2021271959622,2.280142246386,2.3581572968098,2.43617234723359,2.51418739765739,2.59220244808118,2.67021749850498,2.74823254892878,2.82624759935257,2.90426264977637,2.98227770020017,3.06029275062396,3.13830780104776,3.21632285147155,3.29433790189535,3.37235295231915,3.45036800274294,3.52838305316674,3.60639810359053,3.68441315401433,3.76242820443812,3.84044325486192,3.91845830528572,3.99647335570951,4.07448840613331,4.15250345655711,4.2305185069809,4.3085335574047,4.38654860782849,4.46456365825229,4.54257870867609,4.62059375909988,4.69860880952368,4.77662385994747,4.85463891037127,4.93265396079507,5.01066901121886,5.08868406164266,5.16669911206646,5.24471416249025,5.32272921291405,5.40074426333784,5.47875931376164,5.55677436418543,5.63478941460923,5.71280446503303,5.79081951545682,5.86883456588062,5.94684961630441,6.02486466672821,6.10287971715201,6.1808947675758,6.2589098179996,6.3369248684234,6.41493991884719,6.49295496927099,6.57097001969478,6.64898507011858,6.72700012054237,6.80501517096617,6.88303022138997,6.96104527181376,7.03906032223756,7.11707537266136,7.19509042308515,7.27310547350895,7.35112052393274],[1.64675167512071,1.7247667255445,1.8027817759683,1.8807968263921,1.95881187681589,2.03682692723969,2.11484197766348,2.19285702808728,2.27087207851108,2.34888712893487,2.42690217935867,2.50491722978246,2.58293228020626,2.66094733063006,2.73896238105385,2.81697743147765,2.89499248190145,2.97300753232524,3.05102258274904,3.12903763317283,3.20705268359663,3.28506773402043,3.36308278444422,3.44109783486802,3.51911288529181,3.59712793571561,3.6751429861394,3.7531580365632,3.831173086987,3.90918813741079,3.98720318783459,4.06521823825839,4.14323328868218,4.22124833910598,4.29926338952977,4.37727843995357,4.45529349037737,4.53330854080116,4.61132359122496,4.68933864164875,4.76735369207255,4.84536874249634,4.92338379292014,5.00139884334394,5.07941389376774,5.15742894419153,5.23544399461533,5.31345904503912,5.39147409546292,5.46948914588671,5.54750419631051,5.62551924673431,5.7035342971581,5.7815493475819,5.85956439800569,5.93757944842949,6.01559449885329,6.09360954927708,6.17162459970088,6.24963965012468,6.32765470054847,6.40566975097227,6.48368480139606,6.56169985181986,6.63971490224365,6.71772995266745,6.79574500309125,6.87376005351504,6.95177510393884,7.02979015436264,7.10780520478643,7.18582025521023,7.26383530563402],[1.55946645682199,1.63748150724578,1.71549655766958,1.79351160809338,1.87152665851717,1.94954170894097,2.02755675936476,2.10557180978856,2.18358686021236,2.26160191063615,2.33961696105995,2.41763201148374,2.49564706190754,2.57366211233134,2.65167716275513,2.72969221317893,2.80770726360273,2.88572231402652,2.96373736445032,3.04175241487411,3.11976746529791,3.19778251572171,3.2757975661455,3.3538126165693,3.43182766699309,3.50984271741689,3.58785776784068,3.66587281826448,3.74388786868828,3.82190291911207,3.89991796953587,3.97793301995967,4.05594807038346,4.13396312080726,4.21197817123105,4.28999322165485,4.36800827207865,4.44602332250244,4.52403837292624,4.60205342335003,4.68006847377383,4.75808352419762,4.83609857462142,4.91411362504522,4.99212867546902,5.07014372589281,5.14815877631661,5.2261738267404,5.3041888771642,5.38220392758799,5.46021897801179,5.53823402843559,5.61624907885938,5.69426412928318,5.77227917970697,5.85029423013077,5.92830928055457,6.00632433097836,6.08433938140216,6.16235443182596,6.24036948224975,6.31838453267355,6.39639958309734,6.47441463352114,6.55242968394493,6.63044473436873,6.70845978479253,6.78647483521632,6.86448988564012,6.94250493606392,7.02051998648771,7.09853503691151,7.1765500873353],[1.47218123852327,1.55019628894707,1.62821133937086,1.70622638979466,1.78424144021845,1.86225649064225,1.94027154106605,2.01828659148984,2.09630164191364,2.17431669233743,2.25233174276123,2.33034679318503,2.40836184360882,2.48637689403262,2.56439194445641,2.64240699488021,2.72042204530401,2.7984370957278,2.8764521461516,2.9544671965754,3.03248224699919,3.11049729742299,3.18851234784678,3.26652739827058,3.34454244869437,3.42255749911817,3.50057254954197,3.57858759996576,3.65660265038956,3.73461770081335,3.81263275123715,3.89064780166095,3.96866285208474,4.04667790250854,4.12469295293234,4.20270800335613,4.28072305377993,4.35873810420372,4.43675315462752,4.51476820505131,4.59278325547511,4.67079830589891,4.7488133563227,4.8268284067465,4.9048434571703,4.98285850759409,5.06087355801789,5.13888860844168,5.21690365886548,5.29491870928928,5.37293375971307,5.45094881013687,5.52896386056066,5.60697891098446,5.68499396140825,5.76300901183205,5.84102406225585,5.91903911267964,5.99705416310344,6.07506921352724,6.15308426395103,6.23109931437483,6.30911436479862,6.38712941522242,6.46514446564622,6.54315951607001,6.62117456649381,6.6991896169176,6.7772046673414,6.8552197177652,6.93323476818899,7.01124981861279,7.08926486903658],[1.38489602022455,1.46291107064835,1.54092612107214,1.61894117149594,1.69695622191973,1.77497127234353,1.85298632276733,1.93100137319112,2.00901642361492,2.08703147403871,2.16504652446251,2.24306157488631,2.3210766253101,2.3990916757339,2.47710672615769,2.55512177658149,2.63313682700529,2.71115187742908,2.78916692785288,2.86718197827668,2.94519702870047,3.02321207912427,3.10122712954806,3.17924217997186,3.25725723039565,3.33527228081945,3.41328733124325,3.49130238166704,3.56931743209084,3.64733248251463,3.72534753293843,3.80336258336223,3.88137763378602,3.95939268420982,4.03740773463362,4.11542278505741,4.19343783548121,4.271452885905,4.3494679363288,4.42748298675259,4.50549803717639,4.58351308760019,4.66152813802398,4.73954318844778,4.81755823887158,4.89557328929537,4.97358833971917,5.05160339014296,5.12961844056676,5.20763349099056,5.28564854141435,5.36366359183815,5.44167864226194,5.51969369268574,5.59770874310953,5.67572379353333,5.75373884395713,5.83175389438092,5.90976894480472,5.98778399522852,6.06579904565231,6.14381409607611,6.2218291464999,6.2998441969237,6.3778592473475,6.45587429777129,6.53388934819509,6.61190439861888,6.68991944904268,6.76793449946648,6.84594954989027,6.92396460031407,7.00197965073786],[1.29761080192583,1.37562585234962,1.45364090277342,1.53165595319722,1.60967100362101,1.68768605404481,1.76570110446861,1.8437161548924,1.9217312053162,1.99974625573999,2.07776130616379,2.15577635658759,2.23379140701138,2.31180645743518,2.38982150785897,2.46783655828277,2.54585160870657,2.62386665913036,2.70188170955416,2.77989675997796,2.85791181040175,2.93592686082555,3.01394191124934,3.09195696167314,3.16997201209693,3.24798706252073,3.32600211294453,3.40401716336832,3.48203221379212,3.56004726421591,3.63806231463971,3.71607736506351,3.7940924154873,3.8721074659111,3.9501225163349,4.02813756675869,4.10615261718249,4.18416766760628,4.26218271803008,4.34019776845387,4.41821281887767,4.49622786930147,4.57424291972526,4.65225797014906,4.73027302057286,4.80828807099665,4.88630312142045,4.96431817184424,5.04233322226804,5.12034827269184,5.19836332311563,5.27637837353943,5.35439342396322,5.43240847438702,5.51042352481081,5.58843857523461,5.66645362565841,5.7444686760822,5.822483726506,5.9004987769298,5.97851382735359,6.05652887777739,6.13454392820118,6.21255897862498,6.29057402904878,6.36858907947257,6.44660412989637,6.52461918032016,6.60263423074396,6.68064928116776,6.75866433159155,6.83667938201535,6.91469443243914],[1.21032558362711,1.2883406340509,1.3663556844747,1.4443707348985,1.52238578532229,1.60040083574609,1.67841588616989,1.75643093659368,1.83444598701748,1.91246103744127,1.99047608786507,2.06849113828887,2.14650618871266,2.22452123913646,2.30253628956025,2.38055133998405,2.45856639040785,2.53658144083164,2.61459649125544,2.69261154167924,2.77062659210303,2.84864164252683,2.92665669295062,3.00467174337442,3.08268679379821,3.16070184422201,3.23871689464581,3.3167319450696,3.3947469954934,3.47276204591719,3.55077709634099,3.62879214676479,3.70680719718858,3.78482224761238,3.86283729803618,3.94085234845997,4.01886739888377,4.09688244930756,4.17489749973136,4.25291255015515,4.33092760057895,4.40894265100275,4.48695770142654,4.56497275185034,4.64298780227414,4.72100285269793,4.79901790312173,4.87703295354552,4.95504800396932,5.03306305439312,5.11107810481691,5.18909315524071,5.2671082056645,5.3451232560883,5.42313830651209,5.50115335693589,5.57916840735969,5.65718345778348,5.73519850820728,5.81321355863108,5.89122860905487,5.96924365947867,6.04725870990246,6.12527376032626,6.20328881075006,6.28130386117385,6.35931891159765,6.43733396202144,6.51534901244524,6.59336406286904,6.67137911329283,6.74939416371663,6.82740921414042],[1.12304036532839,1.20105541575218,1.27907046617598,1.35708551659978,1.43510056702357,1.51311561744737,1.59113066787117,1.66914571829496,1.74716076871876,1.82517581914255,1.90319086956635,1.98120591999015,2.05922097041394,2.13723602083774,2.21525107126153,2.29326612168533,2.37128117210913,2.44929622253292,2.52731127295672,2.60532632338052,2.68334137380431,2.76135642422811,2.8393714746519,2.9173865250757,2.99540157549949,3.07341662592329,3.15143167634709,3.22944672677088,3.30746177719468,3.38547682761847,3.46349187804227,3.54150692846607,3.61952197888986,3.69753702931366,3.77555207973746,3.85356713016125,3.93158218058505,4.00959723100884,4.08761228143264,4.16562733185643,4.24364238228023,4.32165743270403,4.39967248312782,4.47768753355162,4.55570258397542,4.63371763439921,4.71173268482301,4.7897477352468,4.8677627856706,4.9457778360944,5.02379288651819,5.10180793694199,5.17982298736578,5.25783803778958,5.33585308821337,5.41386813863717,5.49188318906097,5.56989823948476,5.64791328990856,5.72592834033236,5.80394339075615,5.88195844117995,5.95997349160374,6.03798854202754,6.11600359245134,6.19401864287513,6.27203369329893,6.35004874372272,6.42806379414652,6.50607884457032,6.58409389499411,6.66210894541791,6.7401239958417],[1.03575514702967,1.11377019745347,1.19178524787726,1.26980029830106,1.34781534872485,1.42583039914865,1.50384544957245,1.58186049999624,1.65987555042004,1.73789060084383,1.81590565126763,1.89392070169143,1.97193575211522,2.04995080253902,2.12796585296281,2.20598090338661,2.28399595381041,2.3620110042342,2.440026054658,2.5180411050818,2.59605615550559,2.67407120592939,2.75208625635318,2.83010130677698,2.90811635720078,2.98613140762457,3.06414645804837,3.14216150847216,3.22017655889596,3.29819160931975,3.37620665974355,3.45422171016735,3.53223676059114,3.61025181101494,3.68826686143874,3.76628191186253,3.84429696228633,3.92231201271012,4.00032706313392,4.07834211355772,4.15635716398151,4.23437221440531,4.3123872648291,4.3904023152529,4.4684173656767,4.54643241610049,4.62444746652429,4.70246251694808,4.78047756737188,4.85849261779568,4.93650766821947,5.01452271864327,5.09253776906706,5.17055281949086,5.24856786991466,5.32658292033845,5.40459797076225,5.48261302118605,5.56062807160984,5.63864312203364,5.71665817245743,5.79467322288123,5.87268827330502,5.95070332372882,6.02871837415262,6.10673342457641,6.18474847500021,6.262763525424,6.3407785758478,6.4187936262716,6.49680867669539,6.57482372711919,6.65283877754299],[0.948469928730951,1.02648497915475,1.10450002957854,1.18251508000234,1.26053013042614,1.33854518084993,1.41656023127373,1.49457528169752,1.57259033212132,1.65060538254512,1.72862043296891,1.80663548339271,1.8846505338165,1.9626655842403,2.0406806346641,2.11869568508789,2.19671073551169,2.27472578593548,2.35274083635928,2.43075588678308,2.50877093720687,2.58678598763067,2.66480103805447,2.74281608847826,2.82083113890206,2.89884618932585,2.97686123974965,3.05487629017344,3.13289134059724,3.21090639102104,3.28892144144483,3.36693649186863,3.44495154229242,3.52296659271622,3.60098164314002,3.67899669356381,3.75701174398761,3.83502679441141,3.9130418448352,3.991056895259,4.06907194568279,4.14708699610659,4.22510204653038,4.30311709695418,4.38113214737798,4.45914719780177,4.53716224822557,4.61517729864937,4.69319234907316,4.77120739949696,4.84922244992075,4.92723750034455,5.00525255076835,5.08326760119214,5.16128265161594,5.23929770203973,5.31731275246353,5.39532780288733,5.47334285331112,5.55135790373492,5.62937295415871,5.70738800458251,5.78540305500631,5.8634181054301,5.9414331558539,6.01944820627769,6.09746325670149,6.17547830712529,6.25349335754908,6.33150840797288,6.40952345839667,6.48753850882047,6.56555355924427],[0.86118471043223,0.939199760856026,1.01721481127982,1.09522986170362,1.17324491212741,1.25125996255121,1.32927501297501,1.4072900633988,1.4853051138226,1.56332016424639,1.64133521467019,1.71935026509399,1.79736531551778,1.87538036594158,1.95339541636537,2.03141046678917,2.10942551721297,2.18744056763676,2.26545561806056,2.34347066848436,2.42148571890815,2.49950076933195,2.57751581975574,2.65553087017954,2.73354592060334,2.81156097102713,2.88957602145093,2.96759107187472,3.04560612229852,3.12362117272231,3.20163622314611,3.27965127356991,3.3576663239937,3.4356813744175,3.5136964248413,3.59171147526509,3.66972652568889,3.74774157611268,3.82575662653648,3.90377167696028,3.98178672738407,4.05980177780787,4.13781682823166,4.21583187865546,4.29384692907926,4.37186197950305,4.44987702992685,4.52789208035064,4.60590713077444,4.68392218119824,4.76193723162203,4.83995228204583,4.91796733246962,4.99598238289342,5.07399743331722,5.15201248374101,5.23002753416481,5.30804258458861,5.3860576350124,5.4640726854362,5.54208773585999,5.62010278628379,5.69811783670758,5.77613288713138,5.85414793755518,5.93216298797897,6.01017803840277,6.08819308882656,6.16620813925036,6.24422318967416,6.32223824009795,6.40025329052175,6.47826834094555],[0.77389949213351,0.851914542557306,0.929929592981102,1.0079446434049,1.08595969382869,1.16397474425249,1.24198979467629,1.32000484510008,1.39801989552388,1.47603494594767,1.55404999637147,1.63206504679527,1.71008009721906,1.78809514764286,1.86611019806665,1.94412524849045,2.02214029891425,2.10015534933804,2.17817039976184,2.25618545018564,2.33420050060943,2.41221555103323,2.49023060145702,2.56824565188082,2.64626070230462,2.72427575272841,2.80229080315221,2.880305853576,2.9583209039998,3.03633595442359,3.11435100484739,3.19236605527119,3.27038110569498,3.34839615611878,3.42641120654258,3.50442625696637,3.58244130739017,3.66045635781396,3.73847140823776,3.81648645866156,3.89450150908535,3.97251655950915,4.05053160993294,4.12854666035674,4.20656171078054,4.28457676120433,4.36259181162813,4.44060686205192,4.51862191247572,4.59663696289952,4.67465201332331,4.75266706374711,4.8306821141709,4.9086971645947,4.9867122150185,5.06472726544229,5.14274231586609,5.22075736628989,5.29877241671368,5.37678746713748,5.45480251756127,5.53281756798507,5.61083261840886,5.68884766883266,5.76686271925646,5.84487776968025,5.92289282010405,6.00090787052784,6.07892292095164,6.15693797137544,6.23495302179923,6.31296807222303,6.39098312264683],[0.686614273834791,0.764629324258586,0.842644374682383,0.920659425106179,0.998674475529976,1.07668952595377,1.15470457637757,1.23271962680136,1.31073467722516,1.38874972764896,1.46676477807275,1.54477982849655,1.62279487892034,1.70080992934414,1.77882497976794,1.85684003019173,1.93485508061553,2.01287013103932,2.09088518146312,2.16890023188692,2.24691528231071,2.32493033273451,2.4029453831583,2.4809604335821,2.5589754840059,2.63699053442969,2.71500558485349,2.79302063527728,2.87103568570108,2.94905073612488,3.02706578654867,3.10508083697247,3.18309588739626,3.26111093782006,3.33912598824386,3.41714103866765,3.49515608909145,3.57317113951525,3.65118618993904,3.72920124036284,3.80721629078663,3.88523134121043,3.96324639163422,4.04126144205802,4.11927649248182,4.19729154290561,4.27530659332941,4.35332164375321,4.431336694177,4.5093517446008,4.58736679502459,4.66538184544839,4.74339689587219,4.82141194629598,4.89942699671978,4.97744204714357,5.05545709756737,5.13347214799117,5.21148719841496,5.28950224883876,5.36751729926255,5.44553234968635,5.52354740011015,5.60156245053394,5.67957750095774,5.75759255138153,5.83560760180533,5.91362265222913,5.99163770265292,6.06965275307672,6.14766780350051,6.22568285392431,6.30369790434811],[0.599329055536071,0.677344105959866,0.755359156383663,0.833374206807459,0.911389257231256,0.989404307655051,1.06741935807885,1.14543440850264,1.22344945892644,1.30146450935024,1.37947955977403,1.45749461019783,1.53550966062162,1.61352471104542,1.69153976146922,1.76955481189301,1.84756986231681,1.9255849127406,2.0035999631644,2.0816150135882,2.15963006401199,2.23764511443579,2.31566016485958,2.39367521528338,2.47169026570718,2.54970531613097,2.62772036655477,2.70573541697856,2.78375046740236,2.86176551782616,2.93978056824995,3.01779561867375,3.09581066909754,3.17382571952134,3.25184076994514,3.32985582036893,3.40787087079273,3.48588592121652,3.56390097164032,3.64191602206412,3.71993107248791,3.79794612291171,3.8759611733355,3.9539762237593,4.0319912741831,4.11000632460689,4.18802137503069,4.26603642545449,4.34405147587828,4.42206652630208,4.50008157672587,4.57809662714967,4.65611167757347,4.73412672799726,4.81214177842106,4.89015682884485,4.96817187926865,5.04618692969245,5.12420198011624,5.20221703054004,5.28023208096383,5.35824713138763,5.43626218181143,5.51427723223522,5.59229228265902,5.67030733308281,5.74832238350661,5.82633743393041,5.9043524843542,5.982367534778,6.06038258520179,6.13839763562559,6.21641268604939],[0.512043837237352,0.590058887661147,0.668073938084944,0.74608898850874,0.824104038932536,0.902119089356332,0.980134139780128,1.05814919020392,1.13616424062772,1.21417929105152,1.29219434147531,1.37020939189911,1.44822444232291,1.5262394927467,1.6042545431705,1.68226959359429,1.76028464401809,1.83829969444188,1.91631474486568,1.99432979528948,2.07234484571327,2.15035989613707,2.22837494656087,2.30638999698466,2.38440504740846,2.46242009783225,2.54043514825605,2.61845019867985,2.69646524910364,2.77448029952744,2.85249534995123,2.93051040037503,3.00852545079882,3.08654050122262,3.16455555164642,3.24257060207021,3.32058565249401,3.39860070291781,3.4766157533416,3.5546308037654,3.63264585418919,3.71066090461299,3.78867595503679,3.86669100546058,3.94470605588438,4.02272110630817,4.10073615673197,4.17875120715577,4.25676625757956,4.33478130800336,4.41279635842715,4.49081140885095,4.56882645927475,4.64684150969854,4.72485656012234,4.80287161054613,4.88088666096993,4.95890171139373,5.03691676181752,5.11493181224132,5.19294686266511,5.27096191308891,5.34897696351271,5.4269920139365,5.5050070643603,5.58302211478409,5.66103716520789,5.73905221563169,5.81706726605548,5.89508231647928,5.97309736690307,6.05111241732687,6.12912746775067],[0.424758618938632,0.502773669362427,0.580788719786224,0.65880377021002,0.736818820633816,0.814833871057612,0.892848921481407,0.970863971905203,1.048879022329,1.1268940727528,1.20490912317659,1.28292417360039,1.36093922402419,1.43895427444798,1.51696932487178,1.59498437529557,1.67299942571937,1.75101447614316,1.82902952656696,1.90704457699076,1.98505962741455,2.06307467783835,2.14108972826215,2.21910477868594,2.29711982910974,2.37513487953353,2.45314992995733,2.53116498038113,2.60918003080492,2.68719508122872,2.76521013165251,2.84322518207631,2.9212402325001,2.9992552829239,3.0772703333477,3.15528538377149,3.23330043419529,3.31131548461909,3.38933053504288,3.46734558546668,3.54536063589047,3.62337568631427,3.70139073673807,3.77940578716186,3.85742083758566,3.93543588800945,4.01345093843325,4.09146598885705,4.16948103928084,4.24749608970464,4.32551114012843,4.40352619055223,4.48154124097603,4.55955629139982,4.63757134182362,4.71558639224741,4.79360144267121,4.87161649309501,4.9496315435188,5.0276465939426,5.10566164436639,5.18367669479019,5.26169174521399,5.33970679563778,5.41772184606158,5.49573689648537,5.57375194690917,5.65176699733297,5.72978204775676,5.80779709818056,5.88581214860435,5.96382719902815,6.04184224945195],[0.337473400639911,0.415488451063706,0.493503501487503,0.571518551911299,0.649533602335095,0.727548652758891,0.805563703182687,0.883578753606482,0.961593804030279,1.03960885445407,1.11762390487787,1.19563895530167,1.27365400572546,1.35166905614926,1.42968410657306,1.50769915699685,1.58571420742065,1.66372925784444,1.74174430826824,1.81975935869204,1.89777440911583,1.97578945953963,2.05380450996342,2.13181956038722,2.20983461081102,2.28784966123481,2.36586471165861,2.4438797620824,2.5218948125062,2.59990986293,2.67792491335379,2.75593996377759,2.83395501420138,2.91197006462518,2.98998511504898,3.06800016547277,3.14601521589657,3.22403026632036,3.30204531674416,3.38006036716796,3.45807541759175,3.53609046801555,3.61410551843934,3.69212056886314,3.77013561928694,3.84815066971073,3.92616572013453,4.00418077055833,4.08219582098212,4.16021087140592,4.23822592182971,4.31624097225351,4.3942560226773,4.4722710731011,4.5502861235249,4.62830117394869,4.70631622437249,4.78433127479629,4.86234632522008,4.94036137564388,5.01837642606767,5.09639147649147,5.17440652691527,5.25242157733906,5.33043662776286,5.40845167818665,5.48646672861045,5.56448177903424,5.64249682945804,5.72051187988184,5.79852693030563,5.87654198072943,5.95455703115323],[0.250188182341192,0.328203232764987,0.406218283188784,0.48423333361258,0.562248384036376,0.640263434460172,0.718278484883967,0.796293535307763,0.87430858573156,0.952323636155356,1.03033868657915,1.10835373700295,1.18636878742675,1.26438383785054,1.34239888827434,1.42041393869813,1.49842898912193,1.57644403954572,1.65445908996952,1.73247414039332,1.81048919081711,1.88850424124091,1.96651929166471,2.0445343420885,2.1225493925123,2.20056444293609,2.27857949335989,2.35659454378369,2.43460959420748,2.51262464463128,2.59063969505507,2.66865474547887,2.74666979590266,2.82468484632646,2.90269989675026,2.98071494717405,3.05872999759785,3.13674504802165,3.21476009844544,3.29277514886924,3.37079019929303,3.44880524971683,3.52682030014063,3.60483535056442,3.68285040098822,3.76086545141201,3.83888050183581,3.91689555225961,3.9949106026834,4.0729256531072,4.15094070353099,4.22895575395479,4.30697080437859,4.38498585480238,4.46300090522618,4.54101595564997,4.61903100607377,4.69704605649757,4.77506110692136,4.85307615734516,4.93109120776895,5.00910625819275,5.08712130861655,5.16513635904034,5.24315140946414,5.32116645988793,5.39918151031173,5.47719656073553,5.55521161115932,5.63322666158312,5.71124171200691,5.78925676243071,5.86727181285451],[0.162902964042472,0.240918014466268,0.318933064890064,0.396948115313861,0.474963165737657,0.552978216161453,0.630993266585248,0.709008317009044,0.787023367432841,0.865038417856637,0.943053468280433,1.02106851870423,1.09908356912803,1.17709861955182,1.25511366997562,1.33312872039941,1.41114377082321,1.48915882124701,1.5671738716708,1.6451889220946,1.72320397251839,1.80121902294219,1.87923407336599,1.95724912378978,2.03526417421358,2.11327922463737,2.19129427506117,2.26930932548497,2.34732437590876,2.42533942633256,2.50335447675635,2.58136952718015,2.65938457760395,2.73739962802774,2.81541467845154,2.89342972887533,2.97144477929913,3.04945982972293,3.12747488014672,3.20548993057052,3.28350498099431,3.36152003141811,3.43953508184191,3.5175501322657,3.5955651826895,3.67358023311329,3.75159528353709,3.82961033396089,3.90762538438468,3.98564043480848,4.06365548523227,4.14167053565607,4.21968558607987,4.29770063650366,4.37571568692746,4.45373073735125,4.53174578777505,4.60976083819885,4.68777588862264,4.76579093904644,4.84380598947023,4.92182103989403,4.99983609031783,5.07785114074162,5.15586619116542,5.23388124158921,5.31189629201301,5.38991134243681,5.4679263928606,5.5459414432844,5.62395649370819,5.70197154413199,5.77998659455579],[0.0756177457437524,0.153632796167548,0.231647846591344,0.309662897015141,0.387677947438937,0.465692997862733,0.543708048286528,0.621723098710324,0.699738149134121,0.777753199557917,0.855768249981713,0.933783300405508,1.01179835082931,1.0898134012531,1.1678284516769,1.24584350210069,1.32385855252449,1.40187360294829,1.47988865337208,1.55790370379588,1.63591875421967,1.71393380464347,1.79194885506727,1.86996390549106,1.94797895591486,2.02599400633865,2.10400905676245,2.18202410718625,2.26003915761004,2.33805420803384,2.41606925845763,2.49408430888143,2.57209935930523,2.65011440972902,2.72812946015282,2.80614451057661,2.88415956100041,2.96217461142421,3.040189661848,3.1182047122718,3.19621976269559,3.27423481311939,3.35224986354319,3.43026491396698,3.50827996439078,3.58629501481457,3.66431006523837,3.74232511566217,3.82034016608596,3.89835521650976,3.97637026693355,4.05438531735735,4.13240036778115,4.21041541820494,4.28843046862874,4.36644551905253,4.44446056947633,4.52247561990013,4.60049067032392,4.67850572074772,4.75652077117151,4.83453582159531,4.91255087201911,4.9905659224429,5.0685809728667,5.14659602329049,5.22461107371429,5.30262612413809,5.38064117456188,5.45865622498568,5.53667127540947,5.61468632583327,5.69270137625707],[-0.0116674725549677,0.0663475778688278,0.144362628292624,0.222377678716421,0.300392729140217,0.378407779564013,0.456422829987808,0.534437880411604,0.612452930835401,0.690467981259197,0.768483031682993,0.846498082106788,0.924513132530586,1.00252818295438,1.08054323337818,1.15855828380197,1.23657333422577,1.31458838464957,1.39260343507336,1.47061848549716,1.54863353592095,1.62664858634475,1.70466363676855,1.78267868719234,1.86069373761614,1.93870878803993,2.01672383846373,2.09473888888753,2.17275393931132,2.25076898973512,2.32878404015891,2.40679909058271,2.48481414100651,2.5628291914303,2.6408442418541,2.71885929227789,2.79687434270169,2.87488939312549,2.95290444354928,3.03091949397308,3.10893454439687,3.18694959482067,3.26496464524447,3.34297969566826,3.42099474609206,3.49900979651585,3.57702484693965,3.65503989736345,3.73305494778724,3.81106999821104,3.88908504863483,3.96710009905863,4.04511514948243,4.12313019990622,4.20114525033002,4.27916030075381,4.35717535117761,4.43519040160141,4.5132054520252,4.591220502449,4.66923555287279,4.74725060329659,4.82526565372039,4.90328070414418,4.98129575456798,5.05931080499177,5.13732585541557,5.21534090583937,5.29335595626316,5.37137100668696,5.44938605711075,5.52740110753455,5.60541615795835],[-0.0989526908536877,-0.0209376404298922,0.0570774099939042,0.135092460417701,0.213107510841497,0.291122561265293,0.369137611689088,0.447152662112884,0.525167712536681,0.603182762960476,0.681197813384273,0.759212863808068,0.837227914231866,0.915242964655661,0.993258015079457,1.07127306550325,1.14928811592705,1.22730316635085,1.30531821677464,1.38333326719844,1.46134831762223,1.53936336804603,1.61737841846983,1.69539346889362,1.77340851931742,1.85142356974121,1.92943862016501,2.00745367058881,2.0854687210126,2.1634837714364,2.24149882186019,2.31951387228399,2.39752892270779,2.47554397313158,2.55355902355538,2.63157407397917,2.70958912440297,2.78760417482677,2.86561922525056,2.94363427567436,3.02164932609815,3.09966437652195,3.17767942694575,3.25569447736954,3.33370952779334,3.41172457821713,3.48973962864093,3.56775467906473,3.64576972948852,3.72378477991232,3.80179983033611,3.87981488075991,3.95782993118371,4.0358449816075,4.1138600320313,4.19187508245509,4.26989013287889,4.34790518330269,4.42592023372648,4.50393528415028,4.58195033457407,4.65996538499787,4.73798043542167,4.81599548584546,4.89401053626926,4.97202558669305,5.05004063711685,5.12805568754065,5.20607073796444,5.28408578838824,5.36210083881203,5.44011588923583,5.51813093965963],[-0.186237909152408,-0.108222858728612,-0.0302078083048158,0.0478072421189806,0.125822292542777,0.203837342966573,0.281852393390368,0.359867443814164,0.437882494237961,0.515897544661756,0.593912595085553,0.671927645509348,0.749942695933146,0.827957746356941,0.905972796780737,0.983987847204533,1.06200289762833,1.14001794805213,1.21803299847592,1.29604804889972,1.37406309932351,1.45207814974731,1.53009320017111,1.6081082505949,1.6861233010187,1.76413835144249,1.84215340186629,1.92016845229009,1.99818350271388,2.07619855313768,2.15421360356147,2.23222865398527,2.31024370440907,2.38825875483286,2.46627380525666,2.54428885568045,2.62230390610425,2.70031895652805,2.77833400695184,2.85634905737564,2.93436410779943,3.01237915822323,3.09039420864703,3.16840925907082,3.24642430949462,3.32443935991841,3.40245441034221,3.48046946076601,3.5584845111898,3.6364995616136,3.71451461203739,3.79252966246119,3.87054471288499,3.94855976330878,4.02657481373258,4.10458986415637,4.18260491458017,4.26061996500397,4.33863501542776,4.41665006585156,4.49466511627535,4.57268016669915,4.65069521712295,4.72871026754674,4.80672531797054,4.88474036839433,4.96275541881813,5.04077046924193,5.11878551966572,5.19680057008952,5.27481562051331,5.35283067093711,5.43084572136091],[-0.273523127451127,-0.195508077027331,-0.117493026603535,-0.0394779761797386,0.0385370742440578,0.116552124667853,0.194567175091649,0.272582225515444,0.350597275939242,0.428612326363037,0.506627376786834,0.584642427210629,0.662657477634427,0.740672528058222,0.818687578482018,0.896702628905814,0.97471767932961,1.05273272975341,1.1307477801772,1.208762830601,1.28677788102479,1.36479293144859,1.44280798187239,1.52082303229618,1.59883808271998,1.67685313314377,1.75486818356757,1.83288323399137,1.91089828441516,1.98891333483896,2.06692838526275,2.14494343568655,2.22295848611035,2.30097353653414,2.37898858695794,2.45700363738173,2.53501868780553,2.61303373822933,2.69104878865312,2.76906383907692,2.84707888950071,2.92509393992451,3.00310899034831,3.0811240407721,3.1591390911959,3.23715414161969,3.31516919204349,3.39318424246729,3.47119929289108,3.54921434331488,3.62722939373867,3.70524444416247,3.78325949458627,3.86127454501006,3.93928959543386,4.01730464585766,4.09531969628145,4.17333474670525,4.25134979712904,4.32936484755284,4.40737989797663,4.48539494840043,4.56340999882423,4.64142504924802,4.71944009967182,4.79745515009561,4.87547020051941,4.95348525094321,5.031500301367,5.1095153517908,5.1875304022146,5.26554545263839,5.34356050306219],[-0.360808345749848,-0.282793295326052,-0.204778244902256,-0.12676319447846,-0.0487481440546631,0.0292669063691324,0.107281956792928,0.185297007216723,0.263312057640521,0.341327108064316,0.419342158488113,0.497357208911908,0.575372259335706,0.653387309759501,0.731402360183297,0.809417410607093,0.887432461030889,0.965447511454685,1.04346256187848,1.12147761230228,1.19949266272607,1.27750771314987,1.35552276357367,1.43353781399746,1.51155286442126,1.58956791484505,1.66758296526885,1.74559801569265,1.82361306611644,1.90162811654024,1.97964316696403,2.05765821738783,2.13567326781163,2.21368831823542,2.29170336865922,2.36971841908301,2.44773346950681,2.52574851993061,2.6037635703544,2.6817786207782,2.75979367120199,2.83780872162579,2.91582377204959,2.99383882247338,3.07185387289718,3.14986892332097,3.22788397374477,3.30589902416857,3.38391407459236,3.46192912501616,3.53994417543995,3.61795922586375,3.69597427628755,3.77398932671134,3.85200437713514,3.93001942755893,4.00803447798273,4.08604952840653,4.16406457883032,4.24207962925412,4.32009467967791,4.39810973010171,4.47612478052551,4.5541398309493,4.6321548813731,4.71016993179689,4.78818498222069,4.86620003264449,4.94421508306828,5.02223013349208,5.10024518391587,5.17826023433967,5.25627528476347],[-0.448093564048566,-0.370078513624771,-0.292063463200974,-0.214048412777178,-0.136033362353381,-0.0580183119295858,0.0199967384942097,0.0980117889180052,0.176026839341803,0.254041889765598,0.332056940189394,0.41007199061319,0.488087041036987,0.566102091460783,0.644117141884578,0.722132192308375,0.80014724273217,0.878162293155967,0.956177343579762,1.03419239400356,1.11220744442736,1.19022249485115,1.26823754527495,1.34625259569874,1.42426764612254,1.50228269654633,1.58029774697013,1.65831279739393,1.73632784781772,1.81434289824152,1.89235794866531,1.97037299908911,2.04838804951291,2.1264030999367,2.2044181503605,2.2824332007843,2.36044825120809,2.43846330163189,2.51647835205568,2.59449340247948,2.67250845290327,2.75052350332707,2.82853855375087,2.90655360417466,2.98456865459846,3.06258370502226,3.14059875544605,3.21861380586985,3.29662885629364,3.37464390671744,3.45265895714124,3.53067400756503,3.60868905798883,3.68670410841262,3.76471915883642,3.84273420926022,3.92074925968401,3.99876431010781,4.0767793605316,4.1547944109554,4.2328094613792,4.31082451180299,4.38883956222679,4.46685461265058,4.54486966307438,4.62288471349818,4.70089976392197,4.77891481434577,4.85692986476956,4.93494491519336,5.01295996561716,5.09097501604095,5.16899006646475],[-0.535378782347287,-0.457363731923492,-0.379348681499695,-0.301333631075899,-0.223318580652102,-0.145303530228307,-0.0672884798045112,0.0107265706192843,0.0887416210430816,0.166756671466877,0.244771721890674,0.322786772314469,0.400801822738266,0.478816873162062,0.556831923585857,0.634846974009654,0.712862024433449,0.790877074857246,0.868892125281041,0.946907175704839,1.02492222612863,1.10293727655243,1.18095232697623,1.25896737740002,1.33698242782382,1.41499747824761,1.49301252867141,1.57102757909521,1.649042629519,1.7270576799428,1.80507273036659,1.88308778079039,1.96110283121419,2.03911788163798,2.11713293206178,2.19514798248557,2.27316303290937,2.35117808333317,2.42919313375696,2.50720818418076,2.58522323460455,2.66323828502835,2.74125333545215,2.81926838587594,2.89728343629974,2.97529848672353,3.05331353714733,3.13132858757113,3.20934363799492,3.28735868841872,3.36537373884251,3.44338878926631,3.52140383969011,3.5994188901139,3.6774339405377,3.7554489909615,3.83346404138529,3.91147909180909,3.98949414223288,4.06750919265668,4.14552424308047,4.22353929350427,4.30155434392807,4.37956939435186,4.45758444477566,4.53559949519945,4.61361454562325,4.69162959604705,4.76964464647084,4.84765969689464,4.92567474731844,5.00368979774223,5.08170484816603],[-0.622664000646006,-0.544648950222211,-0.466633899798414,-0.388618849374618,-0.310603798950821,-0.232588748527026,-0.15457369810323,-0.0765586476794349,0.00145640274436243,0.079471453168158,0.157486503591954,0.23550155401575,0.313516604439547,0.391531654863343,0.469546705287138,0.547561755710935,0.62557680613473,0.703591856558527,0.781606906982322,0.859621957406119,0.937637007829915,1.01565205825371,1.09366710867751,1.1716821591013,1.2496972095251,1.32771225994889,1.40572731037269,1.48374236079649,1.56175741122028,1.63977246164408,1.71778751206787,1.79580256249167,1.87381761291547,1.95183266333926,2.02984771376306,2.10786276418686,2.18587781461065,2.26389286503445,2.34190791545824,2.41992296588204,2.49793801630583,2.57595306672963,2.65396811715343,2.73198316757722,2.80999821800102,2.88801326842482,2.96602831884861,3.04404336927241,3.1220584196962,3.20007347012,3.2780885205438,3.35610357096759,3.43411862139139,3.51213367181518,3.59014872223898,3.66816377266278,3.74617882308657,3.82419387351037,3.90220892393416,3.98022397435796,4.05823902478176,4.13625407520555,4.21426912562935,4.29228417605314,4.37029922647694,4.44831427690074,4.52632932732453,4.60434437774833,4.68235942817212,4.76037447859592,4.83838952901972,4.91640457944351,4.99441962986731],[-0.709949218944726,-0.631934168520931,-0.553919118097134,-0.475904067673338,-0.397889017249542,-0.319873966825746,-0.24185891640195,-0.163843865978155,-0.0858288155543576,-0.00781376513056209,0.0702012852932343,0.14821633571703,0.226231386140827,0.304246436564623,0.382261486988418,0.460276537412215,0.53829158783601,0.616306638259807,0.694321688683602,0.772336739107399,0.850351789531195,0.92836683995499,1.00638189037879,1.08439694080258,1.16241199122638,1.24042704165017,1.31844209207397,1.39645714249777,1.47447219292156,1.55248724334536,1.63050229376915,1.70851734419295,1.78653239461675,1.86454744504054,1.94256249546434,2.02057754588813,2.09859259631193,2.17660764673573,2.25462269715952,2.33263774758332,2.41065279800711,2.48866784843091,2.56668289885471,2.6446979492785,2.7227129997023,2.8007280501261,2.87874310054989,2.95675815097369,3.03477320139748,3.11278825182128,3.19080330224508,3.26881835266887,3.34683340309267,3.42484845351646,3.50286350394026,3.58087855436406,3.65889360478785,3.73690865521165,3.81492370563544,3.89293875605924,3.97095380648304,4.04896885690683,4.12698390733063,4.20499895775442,4.28301400817822,4.36102905860202,4.43904410902581,4.51705915944961,4.5950742098734,4.6730892602972,4.751104310721,4.82911936114479,4.90713441156859],[-0.797234437243447,-0.719219386819652,-0.641204336395855,-0.563189285972059,-0.485174235548262,-0.407159185124467,-0.329144134700671,-0.251129084276876,-0.173114033853079,-0.095098983429283,-0.0170839330054866,0.0609311174183089,0.138946167842106,0.216961218265902,0.294976268689697,0.372991319113494,0.451006369537289,0.529021419961086,0.607036470384881,0.685051520808678,0.763066571232474,0.84108162165627,0.919096672080067,0.997111722503862,1.07512677292766,1.15314182335145,1.23115687377525,1.30917192419905,1.38718697462284,1.46520202504664,1.54321707547043,1.62123212589423,1.69924717631803,1.77726222674182,1.85527727716562,1.93329232758941,2.01130737801321,2.08932242843701,2.1673374788608,2.2453525292846,2.32336757970839,2.40138263013219,2.47939768055599,2.55741273097978,2.63542778140358,2.71344283182737,2.79145788225117,2.86947293267497,2.94748798309876,3.02550303352256,3.10351808394635,3.18153313437015,3.25954818479395,3.33756323521774,3.41557828564154,3.49359333606534,3.57160838648913,3.64962343691293,3.72763848733672,3.80565353776052,3.88366858818431,3.96168363860811,4.03969868903191,4.1177137394557,4.1957287898795,4.27374384030329,4.35175889072709,4.42977394115089,4.50778899157468,4.58580404199848,4.66381909242228,4.74183414284607,4.81984919326987],[-0.884519655542165,-0.806504605118369,-0.728489554694573,-0.650474504270776,-0.57245945384698,-0.494444403423184,-0.416429352999389,-0.338414302575593,-0.260399252151796,-0.182384201728,-0.104369151304204,-0.0263541008804085,0.0516609495433888,0.129675999967184,0.20769105039098,0.285706100814776,0.363721151238572,0.441736201662368,0.519751252086164,0.597766302509961,0.675781352933757,0.753796403357552,0.831811453781349,0.909826504205145,0.987841554628941,1.06585660505274,1.14387165547653,1.22188670590033,1.29990175632412,1.37791680674792,1.45593185717172,1.53394690759551,1.61196195801931,1.68997700844311,1.7679920588669,1.8460071092907,1.92402215971449,2.00203721013829,2.08005226056209,2.15806731098588,2.23608236140968,2.31409741183347,2.39211246225727,2.47012751268106,2.54814256310486,2.62615761352866,2.70417266395245,2.78218771437625,2.86020276480005,2.93821781522384,3.01623286564764,3.09424791607143,3.17226296649523,3.25027801691903,3.32829306734282,3.40630811776662,3.48432316819041,3.56233821861421,3.64035326903801,3.7183683194618,3.7963833698856,3.87439842030939,3.95241347073319,4.03042852115699,4.10844357158078,4.18645862200458,4.26447367242837,4.34248872285217,4.42050377327597,4.49851882369976,4.57653387412356,4.65454892454735,4.73256397497115],[-0.971804873840886,-0.893789823417091,-0.815774772993294,-0.737759722569498,-0.659744672145702,-0.581729621721906,-0.503714571298111,-0.425699520874315,-0.347684470450518,-0.269669420026722,-0.191654369602926,-0.11363931917913,-0.035624268755333,0.0423907816684626,0.120405832092258,0.198420882516054,0.27643593293985,0.354450983363646,0.432466033787442,0.510481084211239,0.588496134635035,0.66651118505883,0.744526235482628,0.822541285906423,0.900556336330219,0.978571386754014,1.05658643717781,1.13460148760161,1.2126165380254,1.2906315884492,1.36864663887299,1.44666168929679,1.52467673972059,1.60269179014438,1.68070684056818,1.75872189099197,1.83673694141577,1.91475199183957,1.99276704226336,2.07078209268716,2.14879714311095,2.22681219353475,2.30482724395855,2.38284229438234,2.46085734480614,2.53887239522994,2.61688744565373,2.69490249607753,2.77291754650132,2.85093259692512,2.92894764734891,3.00696269777271,3.08497774819651,3.1629927986203,3.2410078490441,3.3190228994679,3.39703794989169,3.47505300031549,3.55306805073928,3.63108310116308,3.70909815158688,3.78711320201067,3.86512825243447,3.94314330285826,4.02115835328206,4.09917340370585,4.17718845412965,4.25520350455345,4.33321855497724,4.41123360540104,4.48924865582484,4.56726370624863,4.64527875667243]],"text":{},"mode":"markers","marker":{"color":["red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green"]},"size":1,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Sepal.Length"},"yaxis":{"title":"Sepal.Width"},"zaxis":{"title":"Petal.Length"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[5.1,4.9,4.7,4.6,5,5.4,4.6,5,4.4,4.9,5.4,4.8,4.8,4.3,5.8,5.7,5.4,5.1,5.7,5.1,5.4,5.1,4.6,5.1,4.8,5,5,5.2,5.2,4.7,4.8,5.4,5.2,5.5,4.9,5,5.5,4.9,4.4,5.1,5,4.5,4.4,5,5.1,4.8,5.1,4.6,5.3,5,7,6.4,6.9,5.5,6.5,5.7,6.3,4.9,6.6,5.2,5,5.9,6,6.1,5.6,6.7,5.6,5.8,6.2,5.6,5.9,6.1,6.3,6.1,6.4,6.6,6.8,6.7,6,5.7,5.5,5.5,5.8,6,5.4,6,6.7,6.3,5.6,5.5,5.5,6.1,5.8,5,5.6,5.7,5.7,6.2,5.1,5.7,6.3,5.8,7.1,6.3,6.5,7.6,4.9,7.3,6.7,7.2,6.5,6.4,6.8,5.7,5.8,6.4,6.5,7.7,7.7,6,6.9,5.6,7.7,6.3,6.7,7.2,6.2,6.1,6.4,7.2,7.4,7.9,6.4,6.3,6.1,7.7,6.3,6.4,6,6.9,6.7,6.9,5.8,6.8,6.7,6.7,6.3,6.5,6.2,5.9],"y":[3.5,3,3.2,3.1,3.6,3.9,3.4,3.4,2.9,3.1,3.7,3.4,3,3,4,4.4,3.9,3.5,3.8,3.8,3.4,3.7,3.6,3.3,3.4,3,3.4,3.5,3.4,3.2,3.1,3.4,4.1,4.2,3.1,3.2,3.5,3.6,3,3.4,3.5,2.3,3.2,3.5,3.8,3,3.8,3.2,3.7,3.3,3.2,3.2,3.1,2.3,2.8,2.8,3.3,2.4,2.9,2.7,2,3,2.2,2.9,2.9,3.1,3,2.7,2.2,2.5,3.2,2.8,2.5,2.8,2.9,3,2.8,3,2.9,2.6,2.4,2.4,2.7,2.7,3,3.4,3.1,2.3,3,2.5,2.6,3,2.6,2.3,2.7,3,2.9,2.9,2.5,2.8,3.3,2.7,3,2.9,3,3,2.5,2.9,2.5,3.6,3.2,2.7,3,2.5,2.8,3.2,3,3.8,2.6,2.2,3.2,2.8,2.8,2.7,3.3,3.2,2.8,3,2.8,3,2.8,3.8,2.8,2.8,2.6,3,3.4,3.1,3,3.1,3.1,3.1,2.7,3.2,3.3,3,2.5,3,3.4,3],"z":[1.4,1.4,1.3,1.5,1.4,1.7,1.4,1.5,1.4,1.5,1.5,1.6,1.4,1.1,1.2,1.5,1.3,1.4,1.7,1.5,1.7,1.5,1,1.7,1.9,1.6,1.6,1.5,1.4,1.6,1.6,1.5,1.5,1.4,1.5,1.2,1.3,1.4,1.3,1.5,1.3,1.3,1.3,1.6,1.9,1.4,1.6,1.4,1.5,1.4,4.7,4.5,4.9,4,4.6,4.5,4.7,3.3,4.6,3.9,3.5,4.2,4,4.7,3.6,4.4,4.5,4.1,4.5,3.9,4.8,4,4.9,4.7,4.3,4.4,4.8,5,4.5,3.5,3.8,3.7,3.9,5.1,4.5,4.5,4.7,4.4,4.1,4,4.4,4.6,4,3.3,4.2,4.2,4.2,4.3,3,4.1,6,5.1,5.9,5.6,5.8,6.6,4.5,6.3,5.8,6.1,5.1,5.3,5.5,5,5.1,5.3,5.5,6.7,6.9,5,5.7,4.9,6.7,4.9,5.7,6,4.8,4.9,5.6,5.8,6.1,6.4,5.6,5.1,5.6,6.1,5.6,5.5,4.8,5.4,5.6,5.1,5.1,5.9,5.7,5.2,5,5.2,5.4,5.1],"text":["setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica"],"mode":"markers","marker":{"color":["red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green"],"size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(31,119,180,1)"}},"type":"scatter3d","textfont":{"size":55},"error_y":{"color":"rgba(31,119,180,1)","width":55},"error_x":{"color":"rgba(31,119,180,1)","width":55},"line":{"color":"rgba(31,119,180,1)","width":55},"frame":null},{"colorbar":{"title":"Petal.Length","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[4.3,4.35,4.4,4.45,4.5,4.55,4.6,4.65,4.7,4.75,4.8,4.85,4.9,4.95,5,5.05,5.1,5.15,5.2,5.25,5.3,5.35,5.4,5.45,5.5,5.55,5.6,5.65,5.7,5.75,5.8,5.85,5.9,5.95,6,6.05,6.1,6.15,6.2,6.25,6.3,6.35,6.4,6.45,6.5,6.55,6.6,6.65,6.7,6.75,6.8,6.85,6.9,6.95,7,7.05,7.1,7.15,7.2,7.25,7.3,7.35,7.4,7.45,7.5,7.55,7.6,7.65,7.7,7.75,7.8,7.85,7.9],"y":[2,2.05,2.1,2.15,2.2,2.25,2.3,2.35,2.4,2.45,2.5,2.55,2.6,2.65,2.7,2.75,2.8,2.85,2.9,2.95,3,3.05,3.1,3.15,3.2,3.25,3.3,3.35,3.4,3.45,3.5,3.55,3.6,3.65,3.7,3.75,3.8,3.85,3.9,3.95,4,4.05,4.1,4.15,4.2,4.25,4.3,4.35,4.4],"z":[[3.21788560449767,3.29590065492146,3.37391570534526,3.45193075576905,3.52994580619285,3.60796085661665,3.68597590704044,3.76399095746424,3.84200600788803,3.92002105831183,3.99803610873563,4.07605115915942,4.15406620958322,4.23208126000701,4.31009631043081,4.38811136085461,4.4661264112784,4.5441414617022,4.62215651212599,4.70017156254979,4.77818661297359,4.85620166339738,4.93421671382118,5.01223176424497,5.09024681466877,5.16826186509257,5.24627691551636,5.32429196594016,5.40230701636395,5.48032206678775,5.55833711721155,5.63635216763534,5.71436721805914,5.79238226848294,5.87039731890673,5.94841236933053,6.02642741975432,6.10444247017812,6.18245752060191,6.26047257102571,6.33848762144951,6.4165026718733,6.4945177222971,6.57253277272089,6.65054782314469,6.72856287356849,6.80657792399228,6.88459297441608,6.96260802483988,7.04062307526367,7.11863812568747,7.19665317611126,7.27466822653506,7.35268327695885,7.43069832738265,7.50871337780645,7.58672842823024,7.66474347865404,7.74275852907784,7.82077357950163,7.89878862992543,7.97680368034922,8.05481873077302,8.13283378119682,8.21084883162061,8.28886388204441,8.3668789324682,8.444893982892,8.52290903331579,8.60092408373959,8.67893913416339,8.75695418458718,8.83496923501098],[3.13060038619895,3.20861543662274,3.28663048704654,3.36464553747033,3.44266058789413,3.52067563831793,3.59869068874172,3.67670573916552,3.75472078958931,3.83273584001311,3.91075089043691,3.9887659408607,4.0667809912845,4.14479604170829,4.22281109213209,4.30082614255589,4.37884119297968,4.45685624340348,4.53487129382727,4.61288634425107,4.69090139467487,4.76891644509866,4.84693149552246,4.92494654594626,5.00296159637005,5.08097664679385,5.15899169721764,5.23700674764144,5.31502179806524,5.39303684848903,5.47105189891283,5.54906694933662,5.62708199976042,5.70509705018422,5.78311210060801,5.86112715103181,5.9391422014556,6.0171572518794,6.0951723023032,6.17318735272699,6.25120240315079,6.32921745357458,6.40723250399838,6.48524755442218,6.56326260484597,6.64127765526977,6.71929270569356,6.79730775611736,6.87532280654116,6.95333785696495,7.03135290738875,7.10936795781254,7.18738300823634,7.26539805866014,7.34341310908393,7.42142815950773,7.49944320993152,7.57745826035532,7.65547331077912,7.73348836120291,7.81150341162671,7.8895184620505,7.9675335124743,8.0455485628981,8.12356361332189,8.20157866374569,8.27959371416948,8.35760876459328,8.43562381501708,8.51363886544087,8.59165391586467,8.66966896628846,8.74768401671226],[3.04331516790023,3.12133021832402,3.19934526874782,3.27736031917161,3.35537536959541,3.43339042001921,3.511405470443,3.5894205208668,3.66743557129059,3.74545062171439,3.82346567213819,3.90148072256198,3.97949577298578,4.05751082340957,4.13552587383337,4.21354092425717,4.29155597468096,4.36957102510476,4.44758607552855,4.52560112595235,4.60361617637615,4.68163122679994,4.75964627722374,4.83766132764754,4.91567637807133,4.99369142849513,5.07170647891892,5.14972152934272,5.22773657976651,5.30575163019031,5.38376668061411,5.4617817310379,5.5397967814617,5.6178118318855,5.69582688230929,5.77384193273309,5.85185698315688,5.92987203358068,6.00788708400448,6.08590213442827,6.16391718485207,6.24193223527586,6.31994728569966,6.39796233612345,6.47597738654725,6.55399243697105,6.63200748739484,6.71002253781864,6.78803758824244,6.86605263866623,6.94406768909003,7.02208273951382,7.10009778993762,7.17811284036142,7.25612789078521,7.33414294120901,7.4121579916328,7.4901730420566,7.5681880924804,7.64620314290419,7.72421819332799,7.80223324375178,7.88024829417558,7.95826334459938,8.03627839502317,8.11429344544697,8.19230849587076,8.27032354629456,8.34833859671836,8.42635364714215,8.50436869756595,8.58238374798974,8.66039879841354],[2.95602994960151,3.0340450000253,3.1120600504491,3.19007510087289,3.26809015129669,3.34610520172049,3.42412025214428,3.50213530256808,3.58015035299188,3.65816540341567,3.73618045383947,3.81419550426326,3.89221055468706,3.97022560511086,4.04824065553465,4.12625570595845,4.20427075638224,4.28228580680604,4.36030085722983,4.43831590765363,4.51633095807743,4.59434600850122,4.67236105892502,4.75037610934882,4.82839115977261,4.90640621019641,4.9844212606202,5.062436311044,5.14045136146779,5.21846641189159,5.29648146231539,5.37449651273918,5.45251156316298,5.53052661358678,5.60854166401057,5.68655671443437,5.76457176485816,5.84258681528196,5.92060186570576,5.99861691612955,6.07663196655335,6.15464701697714,6.23266206740094,6.31067711782473,6.38869216824853,6.46670721867233,6.54472226909612,6.62273731951992,6.70075236994372,6.77876742036751,6.85678247079131,6.9347975212151,7.0128125716389,7.0908276220627,7.16884267248649,7.24685772291029,7.32487277333408,7.40288782375788,7.48090287418168,7.55891792460547,7.63693297502927,7.71494802545306,7.79296307587686,7.87097812630066,7.94899317672445,8.02700822714825,8.10502327757204,8.18303832799584,8.26105337841964,8.33906842884343,8.41708347926723,8.49509852969102,8.57311358011482],[2.86874473130279,2.94675978172658,3.02477483215038,3.10278988257417,3.18080493299797,3.25881998342177,3.33683503384556,3.41485008426936,3.49286513469315,3.57088018511695,3.64889523554075,3.72691028596454,3.80492533638834,3.88294038681213,3.96095543723593,4.03897048765973,4.11698553808352,4.19500058850732,4.27301563893111,4.35103068935491,4.42904573977871,4.5070607902025,4.5850758406263,4.6630908910501,4.74110594147389,4.81912099189769,4.89713604232148,4.97515109274528,5.05316614316907,5.13118119359287,5.20919624401667,5.28721129444046,5.36522634486426,5.44324139528806,5.52125644571185,5.59927149613565,5.67728654655944,5.75530159698324,5.83331664740704,5.91133169783083,5.98934674825463,6.06736179867842,6.14537684910222,6.22339189952601,6.30140694994981,6.37942200037361,6.4574370507974,6.5354521012212,6.613467151645,6.69148220206879,6.76949725249259,6.84751230291638,6.92552735334018,7.00354240376398,7.08155745418777,7.15957250461157,7.23758755503536,7.31560260545916,7.39361765588296,7.47163270630675,7.54964775673055,7.62766280715434,7.70567785757814,7.78369290800194,7.86170795842573,7.93972300884953,8.01773805927332,8.09575310969712,8.17376816012091,8.25178321054471,8.32979826096851,8.4078133113923,8.4858283618161],[2.78145951300407,2.85947456342786,2.93748961385166,3.01550466427546,3.09351971469925,3.17153476512305,3.24954981554684,3.32756486597064,3.40557991639444,3.48359496681823,3.56161001724203,3.63962506766582,3.71764011808962,3.79565516851342,3.87367021893721,3.95168526936101,4.0297003197848,4.1077153702086,4.1857304206324,4.26374547105619,4.34176052147999,4.41977557190378,4.49779062232758,4.57580567275138,4.65382072317517,4.73183577359897,4.80985082402276,4.88786587444656,4.96588092487036,5.04389597529415,5.12191102571795,5.19992607614174,5.27794112656554,5.35595617698934,5.43397122741313,5.51198627783693,5.59000132826072,5.66801637868452,5.74603142910832,5.82404647953211,5.90206152995591,5.9800765803797,6.0580916308035,6.1361066812273,6.21412173165109,6.29213678207489,6.37015183249868,6.44816688292248,6.52618193334628,6.60419698377007,6.68221203419387,6.76022708461766,6.83824213504146,6.91625718546526,6.99427223588905,7.07228728631285,7.15030233673664,7.22831738716044,7.30633243758424,7.38434748800803,7.46236253843183,7.54037758885562,7.61839263927942,7.69640768970322,7.77442274012701,7.85243779055081,7.9304528409746,8.0084678913984,8.0864829418222,8.16449799224599,8.24251304266979,8.32052809309359,8.39854314351738],[2.69417429470535,2.77218934512914,2.85020439555294,2.92821944597674,3.00623449640053,3.08424954682433,3.16226459724812,3.24027964767192,3.31829469809572,3.39630974851951,3.47432479894331,3.5523398493671,3.6303548997909,3.7083699502147,3.78638500063849,3.86440005106229,3.94241510148608,4.02043015190988,4.09844520233368,4.17646025275747,4.25447530318127,4.33249035360506,4.41050540402886,4.48852045445266,4.56653550487645,4.64455055530025,4.72256560572404,4.80058065614784,4.87859570657164,4.95661075699543,5.03462580741923,5.11264085784302,5.19065590826682,5.26867095869062,5.34668600911441,5.42470105953821,5.502716109962,5.5807311603858,5.6587462108096,5.73676126123339,5.81477631165719,5.89279136208098,5.97080641250478,6.04882146292858,6.12683651335237,6.20485156377617,6.28286661419996,6.36088166462376,6.43889671504756,6.51691176547135,6.59492681589515,6.67294186631894,6.75095691674274,6.82897196716654,6.90698701759033,6.98500206801413,7.06301711843792,7.14103216886172,7.21904721928552,7.29706226970931,7.37507732013311,7.4530923705569,7.5311074209807,7.6091224714045,7.68713752182829,7.76515257225209,7.84316762267588,7.92118267309968,7.99919772352348,8.07721277394727,8.15522782437107,8.23324287479486,8.31125792521866],[2.60688907640663,2.68490412683042,2.76291917725422,2.84093422767801,2.91894927810181,2.99696432852561,3.0749793789494,3.1529944293732,3.231009479797,3.30902453022079,3.38703958064459,3.46505463106838,3.54306968149218,3.62108473191598,3.69909978233977,3.77711483276357,3.85512988318736,3.93314493361116,4.01115998403495,4.08917503445875,4.16719008488255,4.24520513530634,4.32322018573014,4.40123523615394,4.47925028657773,4.55726533700153,4.63528038742532,4.71329543784912,4.79131048827292,4.86932553869671,4.94734058912051,5.0253556395443,5.1033706899681,5.1813857403919,5.25940079081569,5.33741584123949,5.41543089166328,5.49344594208708,5.57146099251088,5.64947604293467,5.72749109335847,5.80550614378226,5.88352119420606,5.96153624462986,6.03955129505365,6.11756634547745,6.19558139590124,6.27359644632504,6.35161149674884,6.42962654717263,6.50764159759643,6.58565664802022,6.66367169844402,6.74168674886782,6.81970179929161,6.89771684971541,6.9757319001392,7.053746950563,7.1317620009868,7.20977705141059,7.28779210183439,7.36580715225818,7.44382220268198,7.52183725310578,7.59985230352957,7.67786735395337,7.75588240437716,7.83389745480096,7.91191250522476,7.98992755564855,8.06794260607235,8.14595765649614,8.22397270691994],[2.51960385810791,2.5976189085317,2.6756339589555,2.7536490093793,2.83166405980309,2.90967911022689,2.98769416065068,3.06570921107448,3.14372426149828,3.22173931192207,3.29975436234587,3.37776941276966,3.45578446319346,3.53379951361726,3.61181456404105,3.68982961446485,3.76784466488864,3.84585971531244,3.92387476573624,4.00188981616003,4.07990486658383,4.15791991700762,4.23593496743142,4.31395001785522,4.39196506827901,4.46998011870281,4.5479951691266,4.6260102195504,4.7040252699742,4.78204032039799,4.86005537082179,4.93807042124558,5.01608547166938,5.09410052209318,5.17211557251697,5.25013062294077,5.32814567336456,5.40616072378836,5.48417577421216,5.56219082463595,5.64020587505975,5.71822092548354,5.79623597590734,5.87425102633114,5.95226607675493,6.03028112717873,6.10829617760252,6.18631122802632,6.26432627845012,6.34234132887391,6.42035637929771,6.4983714297215,6.5763864801453,6.6544015305691,6.73241658099289,6.81043163141669,6.88844668184049,6.96646173226428,7.04447678268808,7.12249183311187,7.20050688353567,7.27852193395946,7.35653698438326,7.43455203480706,7.51256708523085,7.59058213565465,7.66859718607844,7.74661223650224,7.82462728692604,7.90264233734983,7.98065738777363,8.05867243819743,8.13668748862122],[2.43231863980919,2.51033369023298,2.58834874065678,2.66636379108058,2.74437884150437,2.82239389192817,2.90040894235196,2.97842399277576,3.05643904319956,3.13445409362335,3.21246914404715,3.29048419447094,3.36849924489474,3.44651429531854,3.52452934574233,3.60254439616613,3.68055944658992,3.75857449701372,3.83658954743752,3.91460459786131,3.99261964828511,4.0706346987089,4.1486497491327,4.2266647995565,4.30467984998029,4.38269490040409,4.46070995082788,4.53872500125168,4.61674005167548,4.69475510209927,4.77277015252307,4.85078520294686,4.92880025337066,5.00681530379446,5.08483035421825,5.16284540464205,5.24086045506584,5.31887550548964,5.39689055591344,5.47490560633723,5.55292065676103,5.63093570718482,5.70895075760862,5.78696580803242,5.86498085845621,5.94299590888001,6.0210109593038,6.0990260097276,6.1770410601514,6.25505611057519,6.33307116099899,6.41108621142278,6.48910126184658,6.56711631227038,6.64513136269417,6.72314641311797,6.80116146354177,6.87917651396556,6.95719156438936,7.03520661481315,7.11322166523695,7.19123671566074,7.26925176608454,7.34726681650834,7.42528186693213,7.50329691735593,7.58131196777972,7.65932701820352,7.73734206862732,7.81535711905111,7.89337216947491,7.97138721989871,8.0494022703225],[2.34503342151047,2.42304847193426,2.50106352235806,2.57907857278186,2.65709362320565,2.73510867362945,2.81312372405324,2.89113877447704,2.96915382490084,3.04716887532463,3.12518392574843,3.20319897617222,3.28121402659602,3.35922907701982,3.43724412744361,3.51525917786741,3.5932742282912,3.671289278715,3.7493043291388,3.82731937956259,3.90533442998639,3.98334948041018,4.06136453083398,4.13937958125778,4.21739463168157,4.29540968210537,4.37342473252916,4.45143978295296,4.52945483337676,4.60746988380055,4.68548493422435,4.76349998464814,4.84151503507194,4.91953008549574,4.99754513591953,5.07556018634333,5.15357523676712,5.23159028719092,5.30960533761472,5.38762038803851,5.46563543846231,5.5436504888861,5.6216655393099,5.6996805897337,5.77769564015749,5.85571069058129,5.93372574100508,6.01174079142888,6.08975584185268,6.16777089227647,6.24578594270027,6.32380099312406,6.40181604354786,6.47983109397166,6.55784614439545,6.63586119481925,6.71387624524305,6.79189129566684,6.86990634609064,6.94792139651443,7.02593644693823,7.10395149736202,7.18196654778582,7.25998159820962,7.33799664863341,7.41601169905721,7.494026749481,7.5720417999048,7.6500568503286,7.72807190075239,7.80608695117619,7.88410200159999,7.96211705202378],[2.25774820321175,2.33576325363554,2.41377830405934,2.49179335448314,2.56980840490693,2.64782345533073,2.72583850575452,2.80385355617832,2.88186860660212,2.95988365702591,3.03789870744971,3.1159137578735,3.1939288082973,3.2719438587211,3.34995890914489,3.42797395956869,3.50598900999248,3.58400406041628,3.66201911084008,3.74003416126387,3.81804921168767,3.89606426211146,3.97407931253526,4.05209436295906,4.13010941338285,4.20812446380665,4.28613951423044,4.36415456465424,4.44216961507804,4.52018466550183,4.59819971592563,4.67621476634943,4.75422981677322,4.83224486719702,4.91025991762081,4.98827496804461,5.0662900184684,5.1443050688922,5.222320119316,5.30033516973979,5.37835022016359,5.45636527058738,5.53438032101118,5.61239537143498,5.69041042185877,5.76842547228257,5.84644052270637,5.92445557313016,6.00247062355396,6.08048567397775,6.15850072440155,6.23651577482535,6.31453082524914,6.39254587567294,6.47056092609673,6.54857597652053,6.62659102694433,6.70460607736812,6.78262112779192,6.86063617821571,6.93865122863951,7.01666627906331,7.0946813294871,7.1726963799109,7.25071143033469,7.32872648075849,7.40674153118229,7.48475658160608,7.56277163202988,7.64078668245368,7.71880173287747,7.79681678330127,7.87483183372506],[2.17046298491303,2.24847803533682,2.32649308576062,2.40450813618442,2.48252318660821,2.56053823703201,2.6385532874558,2.7165683378796,2.7945833883034,2.87259843872719,2.95061348915099,3.02862853957478,3.10664358999858,3.18465864042238,3.26267369084617,3.34068874126997,3.41870379169376,3.49671884211756,3.57473389254136,3.65274894296515,3.73076399338895,3.80877904381274,3.88679409423654,3.96480914466034,4.04282419508413,4.12083924550793,4.19885429593172,4.27686934635552,4.35488439677932,4.43289944720311,4.51091449762691,4.5889295480507,4.6669445984745,4.7449596488983,4.82297469932209,4.90098974974589,4.97900480016968,5.05701985059348,5.13503490101728,5.21304995144107,5.29106500186487,5.36908005228866,5.44709510271246,5.52511015313626,5.60312520356005,5.68114025398385,5.75915530440764,5.83717035483144,5.91518540525524,5.99320045567903,6.07121550610283,6.14923055652662,6.22724560695042,6.30526065737422,6.38327570779801,6.46129075822181,6.53930580864561,6.6173208590694,6.6953359094932,6.77335095991699,6.85136601034079,6.92938106076458,7.00739611118838,7.08541116161218,7.16342621203597,7.24144126245977,7.31945631288356,7.39747136330736,7.47548641373116,7.55350146415495,7.63151651457875,7.70953156500255,7.78754661542634],[2.08317776661431,2.1611928170381,2.2392078674619,2.3172229178857,2.39523796830949,2.47325301873329,2.55126806915708,2.62928311958088,2.70729817000468,2.78531322042847,2.86332827085227,2.94134332127606,3.01935837169986,3.09737342212366,3.17538847254745,3.25340352297125,3.33141857339504,3.40943362381884,3.48744867424264,3.56546372466643,3.64347877509023,3.72149382551402,3.79950887593782,3.87752392636162,3.95553897678541,4.03355402720921,4.111569077633,4.1895841280568,4.2675991784806,4.34561422890439,4.42362927932819,4.50164432975199,4.57965938017578,4.65767443059958,4.73568948102337,4.81370453144717,4.89171958187096,4.96973463229476,5.04774968271856,5.12576473314235,5.20377978356615,5.28179483398994,5.35980988441374,5.43782493483754,5.51583998526133,5.59385503568513,5.67187008610893,5.74988513653272,5.82790018695652,5.90591523738031,5.98393028780411,6.0619453382279,6.1399603886517,6.2179754390755,6.29599048949929,6.37400553992309,6.45202059034689,6.53003564077068,6.60805069119448,6.68606574161827,6.76408079204207,6.84209584246587,6.92011089288966,6.99812594331346,7.07614099373725,7.15415604416105,7.23217109458484,7.31018614500864,7.38820119543244,7.46621624585624,7.54423129628003,7.62224634670383,7.70026139712762],[1.99589254831559,2.07390759873938,2.15192264916318,2.22993769958698,2.30795275001077,2.38596780043457,2.46398285085836,2.54199790128216,2.62001295170596,2.69802800212975,2.77604305255355,2.85405810297734,2.93207315340114,3.01008820382494,3.08810325424873,3.16611830467253,3.24413335509632,3.32214840552012,3.40016345594392,3.47817850636771,3.55619355679151,3.6342086072153,3.7122236576391,3.7902387080629,3.86825375848669,3.94626880891049,4.02428385933428,4.10229890975808,4.18031396018188,4.25832901060567,4.33634406102947,4.41435911145327,4.49237416187706,4.57038921230086,4.64840426272465,4.72641931314845,4.80443436357224,4.88244941399604,4.96046446441984,5.03847951484363,5.11649456526743,5.19450961569122,5.27252466611502,5.35053971653882,5.42855476696261,5.50656981738641,5.58458486781021,5.662599918234,5.7406149686578,5.81863001908159,5.89664506950539,5.97466011992918,6.05267517035298,6.13069022077678,6.20870527120057,6.28672032162437,6.36473537204817,6.44275042247196,6.52076547289576,6.59878052331955,6.67679557374335,6.75481062416715,6.83282567459094,6.91084072501474,6.98885577543853,7.06687082586233,7.14488587628612,7.22290092670992,7.30091597713372,7.37893102755752,7.45694607798131,7.53496112840511,7.6129761788289],[1.90860733001687,1.98662238044066,2.06463743086446,2.14265248128826,2.22066753171205,2.29868258213585,2.37669763255964,2.45471268298344,2.53272773340724,2.61074278383103,2.68875783425483,2.76677288467862,2.84478793510242,2.92280298552622,3.00081803595001,3.07883308637381,3.1568481367976,3.2348631872214,3.3128782376452,3.39089328806899,3.46890833849279,3.54692338891658,3.62493843934038,3.70295348976418,3.78096854018797,3.85898359061177,3.93699864103556,4.01501369145936,4.09302874188316,4.17104379230695,4.24905884273075,4.32707389315455,4.40508894357834,4.48310399400214,4.56111904442593,4.63913409484973,4.71714914527352,4.79516419569732,4.87317924612112,4.95119429654491,5.02920934696871,5.1072243973925,5.1852394478163,5.2632544982401,5.34126954866389,5.41928459908769,5.49729964951149,5.57531469993528,5.65332975035908,5.73134480078287,5.80935985120667,5.88737490163046,5.96538995205426,6.04340500247806,6.12142005290185,6.19943510332565,6.27745015374945,6.35546520417324,6.43348025459704,6.51149530502083,6.58951035544463,6.66752540586843,6.74554045629222,6.82355550671602,6.90157055713981,6.97958560756361,7.0576006579874,7.1356157084112,7.213630758835,7.2916458092588,7.36966085968259,7.44767591010639,7.52569096053018],[1.82132211171815,1.89933716214194,1.97735221256574,2.05536726298954,2.13338231341333,2.21139736383713,2.28941241426092,2.36742746468472,2.44544251510852,2.52345756553231,2.60147261595611,2.6794876663799,2.7575027168037,2.8355177672275,2.91353281765129,2.99154786807509,3.06956291849889,3.14757796892268,3.22559301934648,3.30360806977027,3.38162312019407,3.45963817061787,3.53765322104166,3.61566827146546,3.69368332188925,3.77169837231305,3.84971342273685,3.92772847316064,4.00574352358444,4.08375857400823,4.16177362443203,4.23978867485583,4.31780372527962,4.39581877570342,4.47383382612721,4.55184887655101,4.62986392697481,4.7078789773986,4.7858940278224,4.86390907824619,4.94192412866999,5.01993917909379,5.09795422951758,5.17596927994138,5.25398433036518,5.33199938078897,5.41001443121277,5.48802948163656,5.56604453206036,5.64405958248415,5.72207463290795,5.80008968333175,5.87810473375554,5.95611978417934,6.03413483460313,6.11214988502693,6.19016493545073,6.26817998587452,6.34619503629832,6.42421008672212,6.50222513714591,6.58024018756971,6.6582552379935,6.7362702884173,6.81428533884109,6.89230038926489,6.97031543968869,7.04833049011248,7.12634554053628,7.20436059096008,7.28237564138387,7.36039069180767,7.43840574223146],[1.73403689341943,1.81205194384322,1.89006699426702,1.96808204469082,2.04609709511461,2.12411214553841,2.2021271959622,2.280142246386,2.3581572968098,2.43617234723359,2.51418739765739,2.59220244808118,2.67021749850498,2.74823254892878,2.82624759935257,2.90426264977637,2.98227770020017,3.06029275062396,3.13830780104776,3.21632285147155,3.29433790189535,3.37235295231915,3.45036800274294,3.52838305316674,3.60639810359053,3.68441315401433,3.76242820443812,3.84044325486192,3.91845830528572,3.99647335570951,4.07448840613331,4.15250345655711,4.2305185069809,4.3085335574047,4.38654860782849,4.46456365825229,4.54257870867609,4.62059375909988,4.69860880952368,4.77662385994747,4.85463891037127,4.93265396079507,5.01066901121886,5.08868406164266,5.16669911206646,5.24471416249025,5.32272921291405,5.40074426333784,5.47875931376164,5.55677436418543,5.63478941460923,5.71280446503303,5.79081951545682,5.86883456588062,5.94684961630441,6.02486466672821,6.10287971715201,6.1808947675758,6.2589098179996,6.3369248684234,6.41493991884719,6.49295496927099,6.57097001969478,6.64898507011858,6.72700012054237,6.80501517096617,6.88303022138997,6.96104527181376,7.03906032223756,7.11707537266136,7.19509042308515,7.27310547350895,7.35112052393274],[1.64675167512071,1.7247667255445,1.8027817759683,1.8807968263921,1.95881187681589,2.03682692723969,2.11484197766348,2.19285702808728,2.27087207851108,2.34888712893487,2.42690217935867,2.50491722978246,2.58293228020626,2.66094733063006,2.73896238105385,2.81697743147765,2.89499248190145,2.97300753232524,3.05102258274904,3.12903763317283,3.20705268359663,3.28506773402043,3.36308278444422,3.44109783486802,3.51911288529181,3.59712793571561,3.6751429861394,3.7531580365632,3.831173086987,3.90918813741079,3.98720318783459,4.06521823825839,4.14323328868218,4.22124833910598,4.29926338952977,4.37727843995357,4.45529349037737,4.53330854080116,4.61132359122496,4.68933864164875,4.76735369207255,4.84536874249634,4.92338379292014,5.00139884334394,5.07941389376774,5.15742894419153,5.23544399461533,5.31345904503912,5.39147409546292,5.46948914588671,5.54750419631051,5.62551924673431,5.7035342971581,5.7815493475819,5.85956439800569,5.93757944842949,6.01559449885329,6.09360954927708,6.17162459970088,6.24963965012468,6.32765470054847,6.40566975097227,6.48368480139606,6.56169985181986,6.63971490224365,6.71772995266745,6.79574500309125,6.87376005351504,6.95177510393884,7.02979015436264,7.10780520478643,7.18582025521023,7.26383530563402],[1.55946645682199,1.63748150724578,1.71549655766958,1.79351160809338,1.87152665851717,1.94954170894097,2.02755675936476,2.10557180978856,2.18358686021236,2.26160191063615,2.33961696105995,2.41763201148374,2.49564706190754,2.57366211233134,2.65167716275513,2.72969221317893,2.80770726360273,2.88572231402652,2.96373736445032,3.04175241487411,3.11976746529791,3.19778251572171,3.2757975661455,3.3538126165693,3.43182766699309,3.50984271741689,3.58785776784068,3.66587281826448,3.74388786868828,3.82190291911207,3.89991796953587,3.97793301995967,4.05594807038346,4.13396312080726,4.21197817123105,4.28999322165485,4.36800827207865,4.44602332250244,4.52403837292624,4.60205342335003,4.68006847377383,4.75808352419762,4.83609857462142,4.91411362504522,4.99212867546902,5.07014372589281,5.14815877631661,5.2261738267404,5.3041888771642,5.38220392758799,5.46021897801179,5.53823402843559,5.61624907885938,5.69426412928318,5.77227917970697,5.85029423013077,5.92830928055457,6.00632433097836,6.08433938140216,6.16235443182596,6.24036948224975,6.31838453267355,6.39639958309734,6.47441463352114,6.55242968394493,6.63044473436873,6.70845978479253,6.78647483521632,6.86448988564012,6.94250493606392,7.02051998648771,7.09853503691151,7.1765500873353],[1.47218123852327,1.55019628894707,1.62821133937086,1.70622638979466,1.78424144021845,1.86225649064225,1.94027154106605,2.01828659148984,2.09630164191364,2.17431669233743,2.25233174276123,2.33034679318503,2.40836184360882,2.48637689403262,2.56439194445641,2.64240699488021,2.72042204530401,2.7984370957278,2.8764521461516,2.9544671965754,3.03248224699919,3.11049729742299,3.18851234784678,3.26652739827058,3.34454244869437,3.42255749911817,3.50057254954197,3.57858759996576,3.65660265038956,3.73461770081335,3.81263275123715,3.89064780166095,3.96866285208474,4.04667790250854,4.12469295293234,4.20270800335613,4.28072305377993,4.35873810420372,4.43675315462752,4.51476820505131,4.59278325547511,4.67079830589891,4.7488133563227,4.8268284067465,4.9048434571703,4.98285850759409,5.06087355801789,5.13888860844168,5.21690365886548,5.29491870928928,5.37293375971307,5.45094881013687,5.52896386056066,5.60697891098446,5.68499396140825,5.76300901183205,5.84102406225585,5.91903911267964,5.99705416310344,6.07506921352724,6.15308426395103,6.23109931437483,6.30911436479862,6.38712941522242,6.46514446564622,6.54315951607001,6.62117456649381,6.6991896169176,6.7772046673414,6.8552197177652,6.93323476818899,7.01124981861279,7.08926486903658],[1.38489602022455,1.46291107064835,1.54092612107214,1.61894117149594,1.69695622191973,1.77497127234353,1.85298632276733,1.93100137319112,2.00901642361492,2.08703147403871,2.16504652446251,2.24306157488631,2.3210766253101,2.3990916757339,2.47710672615769,2.55512177658149,2.63313682700529,2.71115187742908,2.78916692785288,2.86718197827668,2.94519702870047,3.02321207912427,3.10122712954806,3.17924217997186,3.25725723039565,3.33527228081945,3.41328733124325,3.49130238166704,3.56931743209084,3.64733248251463,3.72534753293843,3.80336258336223,3.88137763378602,3.95939268420982,4.03740773463362,4.11542278505741,4.19343783548121,4.271452885905,4.3494679363288,4.42748298675259,4.50549803717639,4.58351308760019,4.66152813802398,4.73954318844778,4.81755823887158,4.89557328929537,4.97358833971917,5.05160339014296,5.12961844056676,5.20763349099056,5.28564854141435,5.36366359183815,5.44167864226194,5.51969369268574,5.59770874310953,5.67572379353333,5.75373884395713,5.83175389438092,5.90976894480472,5.98778399522852,6.06579904565231,6.14381409607611,6.2218291464999,6.2998441969237,6.3778592473475,6.45587429777129,6.53388934819509,6.61190439861888,6.68991944904268,6.76793449946648,6.84594954989027,6.92396460031407,7.00197965073786],[1.29761080192583,1.37562585234962,1.45364090277342,1.53165595319722,1.60967100362101,1.68768605404481,1.76570110446861,1.8437161548924,1.9217312053162,1.99974625573999,2.07776130616379,2.15577635658759,2.23379140701138,2.31180645743518,2.38982150785897,2.46783655828277,2.54585160870657,2.62386665913036,2.70188170955416,2.77989675997796,2.85791181040175,2.93592686082555,3.01394191124934,3.09195696167314,3.16997201209693,3.24798706252073,3.32600211294453,3.40401716336832,3.48203221379212,3.56004726421591,3.63806231463971,3.71607736506351,3.7940924154873,3.8721074659111,3.9501225163349,4.02813756675869,4.10615261718249,4.18416766760628,4.26218271803008,4.34019776845387,4.41821281887767,4.49622786930147,4.57424291972526,4.65225797014906,4.73027302057286,4.80828807099665,4.88630312142045,4.96431817184424,5.04233322226804,5.12034827269184,5.19836332311563,5.27637837353943,5.35439342396322,5.43240847438702,5.51042352481081,5.58843857523461,5.66645362565841,5.7444686760822,5.822483726506,5.9004987769298,5.97851382735359,6.05652887777739,6.13454392820118,6.21255897862498,6.29057402904878,6.36858907947257,6.44660412989637,6.52461918032016,6.60263423074396,6.68064928116776,6.75866433159155,6.83667938201535,6.91469443243914],[1.21032558362711,1.2883406340509,1.3663556844747,1.4443707348985,1.52238578532229,1.60040083574609,1.67841588616989,1.75643093659368,1.83444598701748,1.91246103744127,1.99047608786507,2.06849113828887,2.14650618871266,2.22452123913646,2.30253628956025,2.38055133998405,2.45856639040785,2.53658144083164,2.61459649125544,2.69261154167924,2.77062659210303,2.84864164252683,2.92665669295062,3.00467174337442,3.08268679379821,3.16070184422201,3.23871689464581,3.3167319450696,3.3947469954934,3.47276204591719,3.55077709634099,3.62879214676479,3.70680719718858,3.78482224761238,3.86283729803618,3.94085234845997,4.01886739888377,4.09688244930756,4.17489749973136,4.25291255015515,4.33092760057895,4.40894265100275,4.48695770142654,4.56497275185034,4.64298780227414,4.72100285269793,4.79901790312173,4.87703295354552,4.95504800396932,5.03306305439312,5.11107810481691,5.18909315524071,5.2671082056645,5.3451232560883,5.42313830651209,5.50115335693589,5.57916840735969,5.65718345778348,5.73519850820728,5.81321355863108,5.89122860905487,5.96924365947867,6.04725870990246,6.12527376032626,6.20328881075006,6.28130386117385,6.35931891159765,6.43733396202144,6.51534901244524,6.59336406286904,6.67137911329283,6.74939416371663,6.82740921414042],[1.12304036532839,1.20105541575218,1.27907046617598,1.35708551659978,1.43510056702357,1.51311561744737,1.59113066787117,1.66914571829496,1.74716076871876,1.82517581914255,1.90319086956635,1.98120591999015,2.05922097041394,2.13723602083774,2.21525107126153,2.29326612168533,2.37128117210913,2.44929622253292,2.52731127295672,2.60532632338052,2.68334137380431,2.76135642422811,2.8393714746519,2.9173865250757,2.99540157549949,3.07341662592329,3.15143167634709,3.22944672677088,3.30746177719468,3.38547682761847,3.46349187804227,3.54150692846607,3.61952197888986,3.69753702931366,3.77555207973746,3.85356713016125,3.93158218058505,4.00959723100884,4.08761228143264,4.16562733185643,4.24364238228023,4.32165743270403,4.39967248312782,4.47768753355162,4.55570258397542,4.63371763439921,4.71173268482301,4.7897477352468,4.8677627856706,4.9457778360944,5.02379288651819,5.10180793694199,5.17982298736578,5.25783803778958,5.33585308821337,5.41386813863717,5.49188318906097,5.56989823948476,5.64791328990856,5.72592834033236,5.80394339075615,5.88195844117995,5.95997349160374,6.03798854202754,6.11600359245134,6.19401864287513,6.27203369329893,6.35004874372272,6.42806379414652,6.50607884457032,6.58409389499411,6.66210894541791,6.7401239958417],[1.03575514702967,1.11377019745347,1.19178524787726,1.26980029830106,1.34781534872485,1.42583039914865,1.50384544957245,1.58186049999624,1.65987555042004,1.73789060084383,1.81590565126763,1.89392070169143,1.97193575211522,2.04995080253902,2.12796585296281,2.20598090338661,2.28399595381041,2.3620110042342,2.440026054658,2.5180411050818,2.59605615550559,2.67407120592939,2.75208625635318,2.83010130677698,2.90811635720078,2.98613140762457,3.06414645804837,3.14216150847216,3.22017655889596,3.29819160931975,3.37620665974355,3.45422171016735,3.53223676059114,3.61025181101494,3.68826686143874,3.76628191186253,3.84429696228633,3.92231201271012,4.00032706313392,4.07834211355772,4.15635716398151,4.23437221440531,4.3123872648291,4.3904023152529,4.4684173656767,4.54643241610049,4.62444746652429,4.70246251694808,4.78047756737188,4.85849261779568,4.93650766821947,5.01452271864327,5.09253776906706,5.17055281949086,5.24856786991466,5.32658292033845,5.40459797076225,5.48261302118605,5.56062807160984,5.63864312203364,5.71665817245743,5.79467322288123,5.87268827330502,5.95070332372882,6.02871837415262,6.10673342457641,6.18474847500021,6.262763525424,6.3407785758478,6.4187936262716,6.49680867669539,6.57482372711919,6.65283877754299],[0.948469928730951,1.02648497915475,1.10450002957854,1.18251508000234,1.26053013042614,1.33854518084993,1.41656023127373,1.49457528169752,1.57259033212132,1.65060538254512,1.72862043296891,1.80663548339271,1.8846505338165,1.9626655842403,2.0406806346641,2.11869568508789,2.19671073551169,2.27472578593548,2.35274083635928,2.43075588678308,2.50877093720687,2.58678598763067,2.66480103805447,2.74281608847826,2.82083113890206,2.89884618932585,2.97686123974965,3.05487629017344,3.13289134059724,3.21090639102104,3.28892144144483,3.36693649186863,3.44495154229242,3.52296659271622,3.60098164314002,3.67899669356381,3.75701174398761,3.83502679441141,3.9130418448352,3.991056895259,4.06907194568279,4.14708699610659,4.22510204653038,4.30311709695418,4.38113214737798,4.45914719780177,4.53716224822557,4.61517729864937,4.69319234907316,4.77120739949696,4.84922244992075,4.92723750034455,5.00525255076835,5.08326760119214,5.16128265161594,5.23929770203973,5.31731275246353,5.39532780288733,5.47334285331112,5.55135790373492,5.62937295415871,5.70738800458251,5.78540305500631,5.8634181054301,5.9414331558539,6.01944820627769,6.09746325670149,6.17547830712529,6.25349335754908,6.33150840797288,6.40952345839667,6.48753850882047,6.56555355924427],[0.86118471043223,0.939199760856026,1.01721481127982,1.09522986170362,1.17324491212741,1.25125996255121,1.32927501297501,1.4072900633988,1.4853051138226,1.56332016424639,1.64133521467019,1.71935026509399,1.79736531551778,1.87538036594158,1.95339541636537,2.03141046678917,2.10942551721297,2.18744056763676,2.26545561806056,2.34347066848436,2.42148571890815,2.49950076933195,2.57751581975574,2.65553087017954,2.73354592060334,2.81156097102713,2.88957602145093,2.96759107187472,3.04560612229852,3.12362117272231,3.20163622314611,3.27965127356991,3.3576663239937,3.4356813744175,3.5136964248413,3.59171147526509,3.66972652568889,3.74774157611268,3.82575662653648,3.90377167696028,3.98178672738407,4.05980177780787,4.13781682823166,4.21583187865546,4.29384692907926,4.37186197950305,4.44987702992685,4.52789208035064,4.60590713077444,4.68392218119824,4.76193723162203,4.83995228204583,4.91796733246962,4.99598238289342,5.07399743331722,5.15201248374101,5.23002753416481,5.30804258458861,5.3860576350124,5.4640726854362,5.54208773585999,5.62010278628379,5.69811783670758,5.77613288713138,5.85414793755518,5.93216298797897,6.01017803840277,6.08819308882656,6.16620813925036,6.24422318967416,6.32223824009795,6.40025329052175,6.47826834094555],[0.77389949213351,0.851914542557306,0.929929592981102,1.0079446434049,1.08595969382869,1.16397474425249,1.24198979467629,1.32000484510008,1.39801989552388,1.47603494594767,1.55404999637147,1.63206504679527,1.71008009721906,1.78809514764286,1.86611019806665,1.94412524849045,2.02214029891425,2.10015534933804,2.17817039976184,2.25618545018564,2.33420050060943,2.41221555103323,2.49023060145702,2.56824565188082,2.64626070230462,2.72427575272841,2.80229080315221,2.880305853576,2.9583209039998,3.03633595442359,3.11435100484739,3.19236605527119,3.27038110569498,3.34839615611878,3.42641120654258,3.50442625696637,3.58244130739017,3.66045635781396,3.73847140823776,3.81648645866156,3.89450150908535,3.97251655950915,4.05053160993294,4.12854666035674,4.20656171078054,4.28457676120433,4.36259181162813,4.44060686205192,4.51862191247572,4.59663696289952,4.67465201332331,4.75266706374711,4.8306821141709,4.9086971645947,4.9867122150185,5.06472726544229,5.14274231586609,5.22075736628989,5.29877241671368,5.37678746713748,5.45480251756127,5.53281756798507,5.61083261840886,5.68884766883266,5.76686271925646,5.84487776968025,5.92289282010405,6.00090787052784,6.07892292095164,6.15693797137544,6.23495302179923,6.31296807222303,6.39098312264683],[0.686614273834791,0.764629324258586,0.842644374682383,0.920659425106179,0.998674475529976,1.07668952595377,1.15470457637757,1.23271962680136,1.31073467722516,1.38874972764896,1.46676477807275,1.54477982849655,1.62279487892034,1.70080992934414,1.77882497976794,1.85684003019173,1.93485508061553,2.01287013103932,2.09088518146312,2.16890023188692,2.24691528231071,2.32493033273451,2.4029453831583,2.4809604335821,2.5589754840059,2.63699053442969,2.71500558485349,2.79302063527728,2.87103568570108,2.94905073612488,3.02706578654867,3.10508083697247,3.18309588739626,3.26111093782006,3.33912598824386,3.41714103866765,3.49515608909145,3.57317113951525,3.65118618993904,3.72920124036284,3.80721629078663,3.88523134121043,3.96324639163422,4.04126144205802,4.11927649248182,4.19729154290561,4.27530659332941,4.35332164375321,4.431336694177,4.5093517446008,4.58736679502459,4.66538184544839,4.74339689587219,4.82141194629598,4.89942699671978,4.97744204714357,5.05545709756737,5.13347214799117,5.21148719841496,5.28950224883876,5.36751729926255,5.44553234968635,5.52354740011015,5.60156245053394,5.67957750095774,5.75759255138153,5.83560760180533,5.91362265222913,5.99163770265292,6.06965275307672,6.14766780350051,6.22568285392431,6.30369790434811],[0.599329055536071,0.677344105959866,0.755359156383663,0.833374206807459,0.911389257231256,0.989404307655051,1.06741935807885,1.14543440850264,1.22344945892644,1.30146450935024,1.37947955977403,1.45749461019783,1.53550966062162,1.61352471104542,1.69153976146922,1.76955481189301,1.84756986231681,1.9255849127406,2.0035999631644,2.0816150135882,2.15963006401199,2.23764511443579,2.31566016485958,2.39367521528338,2.47169026570718,2.54970531613097,2.62772036655477,2.70573541697856,2.78375046740236,2.86176551782616,2.93978056824995,3.01779561867375,3.09581066909754,3.17382571952134,3.25184076994514,3.32985582036893,3.40787087079273,3.48588592121652,3.56390097164032,3.64191602206412,3.71993107248791,3.79794612291171,3.8759611733355,3.9539762237593,4.0319912741831,4.11000632460689,4.18802137503069,4.26603642545449,4.34405147587828,4.42206652630208,4.50008157672587,4.57809662714967,4.65611167757347,4.73412672799726,4.81214177842106,4.89015682884485,4.96817187926865,5.04618692969245,5.12420198011624,5.20221703054004,5.28023208096383,5.35824713138763,5.43626218181143,5.51427723223522,5.59229228265902,5.67030733308281,5.74832238350661,5.82633743393041,5.9043524843542,5.982367534778,6.06038258520179,6.13839763562559,6.21641268604939],[0.512043837237352,0.590058887661147,0.668073938084944,0.74608898850874,0.824104038932536,0.902119089356332,0.980134139780128,1.05814919020392,1.13616424062772,1.21417929105152,1.29219434147531,1.37020939189911,1.44822444232291,1.5262394927467,1.6042545431705,1.68226959359429,1.76028464401809,1.83829969444188,1.91631474486568,1.99432979528948,2.07234484571327,2.15035989613707,2.22837494656087,2.30638999698466,2.38440504740846,2.46242009783225,2.54043514825605,2.61845019867985,2.69646524910364,2.77448029952744,2.85249534995123,2.93051040037503,3.00852545079882,3.08654050122262,3.16455555164642,3.24257060207021,3.32058565249401,3.39860070291781,3.4766157533416,3.5546308037654,3.63264585418919,3.71066090461299,3.78867595503679,3.86669100546058,3.94470605588438,4.02272110630817,4.10073615673197,4.17875120715577,4.25676625757956,4.33478130800336,4.41279635842715,4.49081140885095,4.56882645927475,4.64684150969854,4.72485656012234,4.80287161054613,4.88088666096993,4.95890171139373,5.03691676181752,5.11493181224132,5.19294686266511,5.27096191308891,5.34897696351271,5.4269920139365,5.5050070643603,5.58302211478409,5.66103716520789,5.73905221563169,5.81706726605548,5.89508231647928,5.97309736690307,6.05111241732687,6.12912746775067],[0.424758618938632,0.502773669362427,0.580788719786224,0.65880377021002,0.736818820633816,0.814833871057612,0.892848921481407,0.970863971905203,1.048879022329,1.1268940727528,1.20490912317659,1.28292417360039,1.36093922402419,1.43895427444798,1.51696932487178,1.59498437529557,1.67299942571937,1.75101447614316,1.82902952656696,1.90704457699076,1.98505962741455,2.06307467783835,2.14108972826215,2.21910477868594,2.29711982910974,2.37513487953353,2.45314992995733,2.53116498038113,2.60918003080492,2.68719508122872,2.76521013165251,2.84322518207631,2.9212402325001,2.9992552829239,3.0772703333477,3.15528538377149,3.23330043419529,3.31131548461909,3.38933053504288,3.46734558546668,3.54536063589047,3.62337568631427,3.70139073673807,3.77940578716186,3.85742083758566,3.93543588800945,4.01345093843325,4.09146598885705,4.16948103928084,4.24749608970464,4.32551114012843,4.40352619055223,4.48154124097603,4.55955629139982,4.63757134182362,4.71558639224741,4.79360144267121,4.87161649309501,4.9496315435188,5.0276465939426,5.10566164436639,5.18367669479019,5.26169174521399,5.33970679563778,5.41772184606158,5.49573689648537,5.57375194690917,5.65176699733297,5.72978204775676,5.80779709818056,5.88581214860435,5.96382719902815,6.04184224945195],[0.337473400639911,0.415488451063706,0.493503501487503,0.571518551911299,0.649533602335095,0.727548652758891,0.805563703182687,0.883578753606482,0.961593804030279,1.03960885445407,1.11762390487787,1.19563895530167,1.27365400572546,1.35166905614926,1.42968410657306,1.50769915699685,1.58571420742065,1.66372925784444,1.74174430826824,1.81975935869204,1.89777440911583,1.97578945953963,2.05380450996342,2.13181956038722,2.20983461081102,2.28784966123481,2.36586471165861,2.4438797620824,2.5218948125062,2.59990986293,2.67792491335379,2.75593996377759,2.83395501420138,2.91197006462518,2.98998511504898,3.06800016547277,3.14601521589657,3.22403026632036,3.30204531674416,3.38006036716796,3.45807541759175,3.53609046801555,3.61410551843934,3.69212056886314,3.77013561928694,3.84815066971073,3.92616572013453,4.00418077055833,4.08219582098212,4.16021087140592,4.23822592182971,4.31624097225351,4.3942560226773,4.4722710731011,4.5502861235249,4.62830117394869,4.70631622437249,4.78433127479629,4.86234632522008,4.94036137564388,5.01837642606767,5.09639147649147,5.17440652691527,5.25242157733906,5.33043662776286,5.40845167818665,5.48646672861045,5.56448177903424,5.64249682945804,5.72051187988184,5.79852693030563,5.87654198072943,5.95455703115323],[0.250188182341192,0.328203232764987,0.406218283188784,0.48423333361258,0.562248384036376,0.640263434460172,0.718278484883967,0.796293535307763,0.87430858573156,0.952323636155356,1.03033868657915,1.10835373700295,1.18636878742675,1.26438383785054,1.34239888827434,1.42041393869813,1.49842898912193,1.57644403954572,1.65445908996952,1.73247414039332,1.81048919081711,1.88850424124091,1.96651929166471,2.0445343420885,2.1225493925123,2.20056444293609,2.27857949335989,2.35659454378369,2.43460959420748,2.51262464463128,2.59063969505507,2.66865474547887,2.74666979590266,2.82468484632646,2.90269989675026,2.98071494717405,3.05872999759785,3.13674504802165,3.21476009844544,3.29277514886924,3.37079019929303,3.44880524971683,3.52682030014063,3.60483535056442,3.68285040098822,3.76086545141201,3.83888050183581,3.91689555225961,3.9949106026834,4.0729256531072,4.15094070353099,4.22895575395479,4.30697080437859,4.38498585480238,4.46300090522618,4.54101595564997,4.61903100607377,4.69704605649757,4.77506110692136,4.85307615734516,4.93109120776895,5.00910625819275,5.08712130861655,5.16513635904034,5.24315140946414,5.32116645988793,5.39918151031173,5.47719656073553,5.55521161115932,5.63322666158312,5.71124171200691,5.78925676243071,5.86727181285451],[0.162902964042472,0.240918014466268,0.318933064890064,0.396948115313861,0.474963165737657,0.552978216161453,0.630993266585248,0.709008317009044,0.787023367432841,0.865038417856637,0.943053468280433,1.02106851870423,1.09908356912803,1.17709861955182,1.25511366997562,1.33312872039941,1.41114377082321,1.48915882124701,1.5671738716708,1.6451889220946,1.72320397251839,1.80121902294219,1.87923407336599,1.95724912378978,2.03526417421358,2.11327922463737,2.19129427506117,2.26930932548497,2.34732437590876,2.42533942633256,2.50335447675635,2.58136952718015,2.65938457760395,2.73739962802774,2.81541467845154,2.89342972887533,2.97144477929913,3.04945982972293,3.12747488014672,3.20548993057052,3.28350498099431,3.36152003141811,3.43953508184191,3.5175501322657,3.5955651826895,3.67358023311329,3.75159528353709,3.82961033396089,3.90762538438468,3.98564043480848,4.06365548523227,4.14167053565607,4.21968558607987,4.29770063650366,4.37571568692746,4.45373073735125,4.53174578777505,4.60976083819885,4.68777588862264,4.76579093904644,4.84380598947023,4.92182103989403,4.99983609031783,5.07785114074162,5.15586619116542,5.23388124158921,5.31189629201301,5.38991134243681,5.4679263928606,5.5459414432844,5.62395649370819,5.70197154413199,5.77998659455579],[0.0756177457437524,0.153632796167548,0.231647846591344,0.309662897015141,0.387677947438937,0.465692997862733,0.543708048286528,0.621723098710324,0.699738149134121,0.777753199557917,0.855768249981713,0.933783300405508,1.01179835082931,1.0898134012531,1.1678284516769,1.24584350210069,1.32385855252449,1.40187360294829,1.47988865337208,1.55790370379588,1.63591875421967,1.71393380464347,1.79194885506727,1.86996390549106,1.94797895591486,2.02599400633865,2.10400905676245,2.18202410718625,2.26003915761004,2.33805420803384,2.41606925845763,2.49408430888143,2.57209935930523,2.65011440972902,2.72812946015282,2.80614451057661,2.88415956100041,2.96217461142421,3.040189661848,3.1182047122718,3.19621976269559,3.27423481311939,3.35224986354319,3.43026491396698,3.50827996439078,3.58629501481457,3.66431006523837,3.74232511566217,3.82034016608596,3.89835521650976,3.97637026693355,4.05438531735735,4.13240036778115,4.21041541820494,4.28843046862874,4.36644551905253,4.44446056947633,4.52247561990013,4.60049067032392,4.67850572074772,4.75652077117151,4.83453582159531,4.91255087201911,4.9905659224429,5.0685809728667,5.14659602329049,5.22461107371429,5.30262612413809,5.38064117456188,5.45865622498568,5.53667127540947,5.61468632583327,5.69270137625707],[-0.0116674725549677,0.0663475778688278,0.144362628292624,0.222377678716421,0.300392729140217,0.378407779564013,0.456422829987808,0.534437880411604,0.612452930835401,0.690467981259197,0.768483031682993,0.846498082106788,0.924513132530586,1.00252818295438,1.08054323337818,1.15855828380197,1.23657333422577,1.31458838464957,1.39260343507336,1.47061848549716,1.54863353592095,1.62664858634475,1.70466363676855,1.78267868719234,1.86069373761614,1.93870878803993,2.01672383846373,2.09473888888753,2.17275393931132,2.25076898973512,2.32878404015891,2.40679909058271,2.48481414100651,2.5628291914303,2.6408442418541,2.71885929227789,2.79687434270169,2.87488939312549,2.95290444354928,3.03091949397308,3.10893454439687,3.18694959482067,3.26496464524447,3.34297969566826,3.42099474609206,3.49900979651585,3.57702484693965,3.65503989736345,3.73305494778724,3.81106999821104,3.88908504863483,3.96710009905863,4.04511514948243,4.12313019990622,4.20114525033002,4.27916030075381,4.35717535117761,4.43519040160141,4.5132054520252,4.591220502449,4.66923555287279,4.74725060329659,4.82526565372039,4.90328070414418,4.98129575456798,5.05931080499177,5.13732585541557,5.21534090583937,5.29335595626316,5.37137100668696,5.44938605711075,5.52740110753455,5.60541615795835],[-0.0989526908536877,-0.0209376404298922,0.0570774099939042,0.135092460417701,0.213107510841497,0.291122561265293,0.369137611689088,0.447152662112884,0.525167712536681,0.603182762960476,0.681197813384273,0.759212863808068,0.837227914231866,0.915242964655661,0.993258015079457,1.07127306550325,1.14928811592705,1.22730316635085,1.30531821677464,1.38333326719844,1.46134831762223,1.53936336804603,1.61737841846983,1.69539346889362,1.77340851931742,1.85142356974121,1.92943862016501,2.00745367058881,2.0854687210126,2.1634837714364,2.24149882186019,2.31951387228399,2.39752892270779,2.47554397313158,2.55355902355538,2.63157407397917,2.70958912440297,2.78760417482677,2.86561922525056,2.94363427567436,3.02164932609815,3.09966437652195,3.17767942694575,3.25569447736954,3.33370952779334,3.41172457821713,3.48973962864093,3.56775467906473,3.64576972948852,3.72378477991232,3.80179983033611,3.87981488075991,3.95782993118371,4.0358449816075,4.1138600320313,4.19187508245509,4.26989013287889,4.34790518330269,4.42592023372648,4.50393528415028,4.58195033457407,4.65996538499787,4.73798043542167,4.81599548584546,4.89401053626926,4.97202558669305,5.05004063711685,5.12805568754065,5.20607073796444,5.28408578838824,5.36210083881203,5.44011588923583,5.51813093965963],[-0.186237909152408,-0.108222858728612,-0.0302078083048158,0.0478072421189806,0.125822292542777,0.203837342966573,0.281852393390368,0.359867443814164,0.437882494237961,0.515897544661756,0.593912595085553,0.671927645509348,0.749942695933146,0.827957746356941,0.905972796780737,0.983987847204533,1.06200289762833,1.14001794805213,1.21803299847592,1.29604804889972,1.37406309932351,1.45207814974731,1.53009320017111,1.6081082505949,1.6861233010187,1.76413835144249,1.84215340186629,1.92016845229009,1.99818350271388,2.07619855313768,2.15421360356147,2.23222865398527,2.31024370440907,2.38825875483286,2.46627380525666,2.54428885568045,2.62230390610425,2.70031895652805,2.77833400695184,2.85634905737564,2.93436410779943,3.01237915822323,3.09039420864703,3.16840925907082,3.24642430949462,3.32443935991841,3.40245441034221,3.48046946076601,3.5584845111898,3.6364995616136,3.71451461203739,3.79252966246119,3.87054471288499,3.94855976330878,4.02657481373258,4.10458986415637,4.18260491458017,4.26061996500397,4.33863501542776,4.41665006585156,4.49466511627535,4.57268016669915,4.65069521712295,4.72871026754674,4.80672531797054,4.88474036839433,4.96275541881813,5.04077046924193,5.11878551966572,5.19680057008952,5.27481562051331,5.35283067093711,5.43084572136091],[-0.273523127451127,-0.195508077027331,-0.117493026603535,-0.0394779761797386,0.0385370742440578,0.116552124667853,0.194567175091649,0.272582225515444,0.350597275939242,0.428612326363037,0.506627376786834,0.584642427210629,0.662657477634427,0.740672528058222,0.818687578482018,0.896702628905814,0.97471767932961,1.05273272975341,1.1307477801772,1.208762830601,1.28677788102479,1.36479293144859,1.44280798187239,1.52082303229618,1.59883808271998,1.67685313314377,1.75486818356757,1.83288323399137,1.91089828441516,1.98891333483896,2.06692838526275,2.14494343568655,2.22295848611035,2.30097353653414,2.37898858695794,2.45700363738173,2.53501868780553,2.61303373822933,2.69104878865312,2.76906383907692,2.84707888950071,2.92509393992451,3.00310899034831,3.0811240407721,3.1591390911959,3.23715414161969,3.31516919204349,3.39318424246729,3.47119929289108,3.54921434331488,3.62722939373867,3.70524444416247,3.78325949458627,3.86127454501006,3.93928959543386,4.01730464585766,4.09531969628145,4.17333474670525,4.25134979712904,4.32936484755284,4.40737989797663,4.48539494840043,4.56340999882423,4.64142504924802,4.71944009967182,4.79745515009561,4.87547020051941,4.95348525094321,5.031500301367,5.1095153517908,5.1875304022146,5.26554545263839,5.34356050306219],[-0.360808345749848,-0.282793295326052,-0.204778244902256,-0.12676319447846,-0.0487481440546631,0.0292669063691324,0.107281956792928,0.185297007216723,0.263312057640521,0.341327108064316,0.419342158488113,0.497357208911908,0.575372259335706,0.653387309759501,0.731402360183297,0.809417410607093,0.887432461030889,0.965447511454685,1.04346256187848,1.12147761230228,1.19949266272607,1.27750771314987,1.35552276357367,1.43353781399746,1.51155286442126,1.58956791484505,1.66758296526885,1.74559801569265,1.82361306611644,1.90162811654024,1.97964316696403,2.05765821738783,2.13567326781163,2.21368831823542,2.29170336865922,2.36971841908301,2.44773346950681,2.52574851993061,2.6037635703544,2.6817786207782,2.75979367120199,2.83780872162579,2.91582377204959,2.99383882247338,3.07185387289718,3.14986892332097,3.22788397374477,3.30589902416857,3.38391407459236,3.46192912501616,3.53994417543995,3.61795922586375,3.69597427628755,3.77398932671134,3.85200437713514,3.93001942755893,4.00803447798273,4.08604952840653,4.16406457883032,4.24207962925412,4.32009467967791,4.39810973010171,4.47612478052551,4.5541398309493,4.6321548813731,4.71016993179689,4.78818498222069,4.86620003264449,4.94421508306828,5.02223013349208,5.10024518391587,5.17826023433967,5.25627528476347],[-0.448093564048566,-0.370078513624771,-0.292063463200974,-0.214048412777178,-0.136033362353381,-0.0580183119295858,0.0199967384942097,0.0980117889180052,0.176026839341803,0.254041889765598,0.332056940189394,0.41007199061319,0.488087041036987,0.566102091460783,0.644117141884578,0.722132192308375,0.80014724273217,0.878162293155967,0.956177343579762,1.03419239400356,1.11220744442736,1.19022249485115,1.26823754527495,1.34625259569874,1.42426764612254,1.50228269654633,1.58029774697013,1.65831279739393,1.73632784781772,1.81434289824152,1.89235794866531,1.97037299908911,2.04838804951291,2.1264030999367,2.2044181503605,2.2824332007843,2.36044825120809,2.43846330163189,2.51647835205568,2.59449340247948,2.67250845290327,2.75052350332707,2.82853855375087,2.90655360417466,2.98456865459846,3.06258370502226,3.14059875544605,3.21861380586985,3.29662885629364,3.37464390671744,3.45265895714124,3.53067400756503,3.60868905798883,3.68670410841262,3.76471915883642,3.84273420926022,3.92074925968401,3.99876431010781,4.0767793605316,4.1547944109554,4.2328094613792,4.31082451180299,4.38883956222679,4.46685461265058,4.54486966307438,4.62288471349818,4.70089976392197,4.77891481434577,4.85692986476956,4.93494491519336,5.01295996561716,5.09097501604095,5.16899006646475],[-0.535378782347287,-0.457363731923492,-0.379348681499695,-0.301333631075899,-0.223318580652102,-0.145303530228307,-0.0672884798045112,0.0107265706192843,0.0887416210430816,0.166756671466877,0.244771721890674,0.322786772314469,0.400801822738266,0.478816873162062,0.556831923585857,0.634846974009654,0.712862024433449,0.790877074857246,0.868892125281041,0.946907175704839,1.02492222612863,1.10293727655243,1.18095232697623,1.25896737740002,1.33698242782382,1.41499747824761,1.49301252867141,1.57102757909521,1.649042629519,1.7270576799428,1.80507273036659,1.88308778079039,1.96110283121419,2.03911788163798,2.11713293206178,2.19514798248557,2.27316303290937,2.35117808333317,2.42919313375696,2.50720818418076,2.58522323460455,2.66323828502835,2.74125333545215,2.81926838587594,2.89728343629974,2.97529848672353,3.05331353714733,3.13132858757113,3.20934363799492,3.28735868841872,3.36537373884251,3.44338878926631,3.52140383969011,3.5994188901139,3.6774339405377,3.7554489909615,3.83346404138529,3.91147909180909,3.98949414223288,4.06750919265668,4.14552424308047,4.22353929350427,4.30155434392807,4.37956939435186,4.45758444477566,4.53559949519945,4.61361454562325,4.69162959604705,4.76964464647084,4.84765969689464,4.92567474731844,5.00368979774223,5.08170484816603],[-0.622664000646006,-0.544648950222211,-0.466633899798414,-0.388618849374618,-0.310603798950821,-0.232588748527026,-0.15457369810323,-0.0765586476794349,0.00145640274436243,0.079471453168158,0.157486503591954,0.23550155401575,0.313516604439547,0.391531654863343,0.469546705287138,0.547561755710935,0.62557680613473,0.703591856558527,0.781606906982322,0.859621957406119,0.937637007829915,1.01565205825371,1.09366710867751,1.1716821591013,1.2496972095251,1.32771225994889,1.40572731037269,1.48374236079649,1.56175741122028,1.63977246164408,1.71778751206787,1.79580256249167,1.87381761291547,1.95183266333926,2.02984771376306,2.10786276418686,2.18587781461065,2.26389286503445,2.34190791545824,2.41992296588204,2.49793801630583,2.57595306672963,2.65396811715343,2.73198316757722,2.80999821800102,2.88801326842482,2.96602831884861,3.04404336927241,3.1220584196962,3.20007347012,3.2780885205438,3.35610357096759,3.43411862139139,3.51213367181518,3.59014872223898,3.66816377266278,3.74617882308657,3.82419387351037,3.90220892393416,3.98022397435796,4.05823902478176,4.13625407520555,4.21426912562935,4.29228417605314,4.37029922647694,4.44831427690074,4.52632932732453,4.60434437774833,4.68235942817212,4.76037447859592,4.83838952901972,4.91640457944351,4.99441962986731],[-0.709949218944726,-0.631934168520931,-0.553919118097134,-0.475904067673338,-0.397889017249542,-0.319873966825746,-0.24185891640195,-0.163843865978155,-0.0858288155543576,-0.00781376513056209,0.0702012852932343,0.14821633571703,0.226231386140827,0.304246436564623,0.382261486988418,0.460276537412215,0.53829158783601,0.616306638259807,0.694321688683602,0.772336739107399,0.850351789531195,0.92836683995499,1.00638189037879,1.08439694080258,1.16241199122638,1.24042704165017,1.31844209207397,1.39645714249777,1.47447219292156,1.55248724334536,1.63050229376915,1.70851734419295,1.78653239461675,1.86454744504054,1.94256249546434,2.02057754588813,2.09859259631193,2.17660764673573,2.25462269715952,2.33263774758332,2.41065279800711,2.48866784843091,2.56668289885471,2.6446979492785,2.7227129997023,2.8007280501261,2.87874310054989,2.95675815097369,3.03477320139748,3.11278825182128,3.19080330224508,3.26881835266887,3.34683340309267,3.42484845351646,3.50286350394026,3.58087855436406,3.65889360478785,3.73690865521165,3.81492370563544,3.89293875605924,3.97095380648304,4.04896885690683,4.12698390733063,4.20499895775442,4.28301400817822,4.36102905860202,4.43904410902581,4.51705915944961,4.5950742098734,4.6730892602972,4.751104310721,4.82911936114479,4.90713441156859],[-0.797234437243447,-0.719219386819652,-0.641204336395855,-0.563189285972059,-0.485174235548262,-0.407159185124467,-0.329144134700671,-0.251129084276876,-0.173114033853079,-0.095098983429283,-0.0170839330054866,0.0609311174183089,0.138946167842106,0.216961218265902,0.294976268689697,0.372991319113494,0.451006369537289,0.529021419961086,0.607036470384881,0.685051520808678,0.763066571232474,0.84108162165627,0.919096672080067,0.997111722503862,1.07512677292766,1.15314182335145,1.23115687377525,1.30917192419905,1.38718697462284,1.46520202504664,1.54321707547043,1.62123212589423,1.69924717631803,1.77726222674182,1.85527727716562,1.93329232758941,2.01130737801321,2.08932242843701,2.1673374788608,2.2453525292846,2.32336757970839,2.40138263013219,2.47939768055599,2.55741273097978,2.63542778140358,2.71344283182737,2.79145788225117,2.86947293267497,2.94748798309876,3.02550303352256,3.10351808394635,3.18153313437015,3.25954818479395,3.33756323521774,3.41557828564154,3.49359333606534,3.57160838648913,3.64962343691293,3.72763848733672,3.80565353776052,3.88366858818431,3.96168363860811,4.03969868903191,4.1177137394557,4.1957287898795,4.27374384030329,4.35175889072709,4.42977394115089,4.50778899157468,4.58580404199848,4.66381909242228,4.74183414284607,4.81984919326987],[-0.884519655542165,-0.806504605118369,-0.728489554694573,-0.650474504270776,-0.57245945384698,-0.494444403423184,-0.416429352999389,-0.338414302575593,-0.260399252151796,-0.182384201728,-0.104369151304204,-0.0263541008804085,0.0516609495433888,0.129675999967184,0.20769105039098,0.285706100814776,0.363721151238572,0.441736201662368,0.519751252086164,0.597766302509961,0.675781352933757,0.753796403357552,0.831811453781349,0.909826504205145,0.987841554628941,1.06585660505274,1.14387165547653,1.22188670590033,1.29990175632412,1.37791680674792,1.45593185717172,1.53394690759551,1.61196195801931,1.68997700844311,1.7679920588669,1.8460071092907,1.92402215971449,2.00203721013829,2.08005226056209,2.15806731098588,2.23608236140968,2.31409741183347,2.39211246225727,2.47012751268106,2.54814256310486,2.62615761352866,2.70417266395245,2.78218771437625,2.86020276480005,2.93821781522384,3.01623286564764,3.09424791607143,3.17226296649523,3.25027801691903,3.32829306734282,3.40630811776662,3.48432316819041,3.56233821861421,3.64035326903801,3.7183683194618,3.7963833698856,3.87439842030939,3.95241347073319,4.03042852115699,4.10844357158078,4.18645862200458,4.26447367242837,4.34248872285217,4.42050377327597,4.49851882369976,4.57653387412356,4.65454892454735,4.73256397497115],[-0.971804873840886,-0.893789823417091,-0.815774772993294,-0.737759722569498,-0.659744672145702,-0.581729621721906,-0.503714571298111,-0.425699520874315,-0.347684470450518,-0.269669420026722,-0.191654369602926,-0.11363931917913,-0.035624268755333,0.0423907816684626,0.120405832092258,0.198420882516054,0.27643593293985,0.354450983363646,0.432466033787442,0.510481084211239,0.588496134635035,0.66651118505883,0.744526235482628,0.822541285906423,0.900556336330219,0.978571386754014,1.05658643717781,1.13460148760161,1.2126165380254,1.2906315884492,1.36864663887299,1.44666168929679,1.52467673972059,1.60269179014438,1.68070684056818,1.75872189099197,1.83673694141577,1.91475199183957,1.99276704226336,2.07078209268716,2.14879714311095,2.22681219353475,2.30482724395855,2.38284229438234,2.46085734480614,2.53887239522994,2.61688744565373,2.69490249607753,2.77291754650132,2.85093259692512,2.92894764734891,3.00696269777271,3.08497774819651,3.1629927986203,3.2410078490441,3.3190228994679,3.39703794989169,3.47505300031549,3.55306805073928,3.63108310116308,3.70909815158688,3.78711320201067,3.86512825243447,3.94314330285826,4.02115835328206,4.09917340370585,4.17718845412965,4.25520350455345,4.33321855497724,4.41123360540104,4.48924865582484,4.56726370624863,4.64527875667243]],"text":["setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica"],"mode":"markers","marker":{"color":["red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green"]},"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div id="ajuste-de-modelo" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Ajuste de modelo</h3>
<div id="estimación-de-parámetros-regresión-lineal-simple" class="section level4" number="5.2.1.1">
<h4><span class="header-section-number">5.2.1.1</span> Estimación de parámetros: Regresión lineal simple</h4>
<p>En la gran mayoría de casos, los valores <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> poblacionales son desconocidos, por lo que, a partir de una muestra, se obtienen sus estimaciones <span class="math inline">\(\hat{\beta_0}\)</span> y <span class="math inline">\(\hat{\beta_1}\)</span>. Estas estimaciones se conocen como coeficientes de regresión o <em>least square coefficient estimates</em>, ya que toman aquellos valores que minimizan la suma de cuadrados residuales, dando lugar a la recta que pasa más cerca de todos los puntos.</p>
<p><img src="img/05-sup/lineal/5-2-1-ajuste-lineal.svg" width="500pt" height="250pt" style="display: block; margin: auto;" /></p>
<p>En términos analíticos, la expresión matemática a optimizar y solución están dadas por:</p>
<p><span class="math display">\[min(\epsilon) \Rightarrow min(y-\hat{y}) = min\{y -(\hat{\beta}_0 + \hat{\beta}_1x)\}\]</span></p>
<span class="math display">\[\begin{aligned}

\hat{\beta}_0 &amp;= \overline{y} - \hat{\beta}_1\overline{x} \\

\hat{\beta}_1 &amp;= \frac{\sum^n_{i=1}(x_i - \overline{x})(y_i - \overline{y})}{\sum^n_{i=1}(x_i - \overline{x})^2} =\frac{S_{xy}}{S^2_x}

\end{aligned}\]</span>
<p><strong>Donde:</strong></p>
<blockquote>
<ul>
<li><p><span class="math inline">\(S_{xy}\)</span> es la covarianza entre <span class="math inline">\(x\)</span> y <span class="math inline">\(y\)</span>.</p></li>
<li><p><span class="math inline">\(S_{x}^{2}\)</span> es la varianza de <span class="math inline">\(x\)</span>.</p></li>
<li><p><span class="math inline">\(\hat{\beta}_0\)</span> es el valor esperado la variable <span class="math inline">\(Y\)</span> cuando <span class="math inline">\(X = 0\)</span>, es decir, la intersección de la recta con el eje y.</p></li>
</ul>
</blockquote>
</div>
<div id="estimación-de-parámetros-regresión-lineal-múltiple" class="section level4" number="5.2.1.2">
<h4><span class="header-section-number">5.2.1.2</span> Estimación de parámetros: Regresión lineal múltiple</h4>
<p>En el caso de múltiples parámetros, la notación se vuelve más sencilla al expresar el modelo mediante una combinación lineal dada por la multiplicación de matrices (álgebra lineal).</p>
<p><span class="math display">\[Y = X\beta + \epsilon\]</span></p>
<p><strong>Donde:</strong></p>
<p><span class="math display">\[Y = \begin{pmatrix}y_1\\y_2\\.\\.\\.\\y_n\end{pmatrix} \quad \beta = \begin{pmatrix}\beta_0\\\beta_1\\.\\.\\.\\\beta_m\end{pmatrix} \quad \epsilon = \begin{pmatrix}\epsilon_1\\\epsilon_2\\.\\.\\.\\\epsilon_n\end{pmatrix} \quad \quad X = \begin{pmatrix}1 &amp; x_{11} &amp; x_{12} &amp; ... &amp; x_{1m}\\1 &amp; x_{21} &amp; x_{22} &amp; ... &amp; x_{2m}\\\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\ 1 &amp; x_{n1} &amp; x_{n2} &amp; ... &amp; x_{nm}\end{pmatrix}\\\]</span></p>
<p>El estimador por mínimos cuadrados está dado por:</p>
<p><span class="math display">\[\hat{\beta} = (X^TX)^{-1}X^TY\]</span></p>
<hr />
<p><strong>IMPORTANTE:</strong> Es necesario entender que para cada uno de los coeficientes de regresión se realiza una prueba de hipótesis. Una vez calculado el valor estimado, se procede a determinar si este valor es significativamente distinto de cero, por lo que la hipótesis de cada coeficiente se plantea de la siguiente manera:</p>
<p><span class="math display">\[H_0:\beta_i=0 \quad Vs \quad H_1:\beta_i\neq0\]</span>
El software <em>R</em> nos devuelve el p-value asociado a cada coeficiente de regresión. Recordemos que valores pequeños de <em>p</em> sugieren que al rechazar <span class="math inline">\(H_0\)</span>, la probabilidad de equivocarnos es baja, por lo que procedemos a rechazar la hipótesis nula.</p>
</div>
</div>
<div id="residuos-del-modelo" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Residuos del modelo</h3>
<p>El residuo de una estimación se define como la diferencia entre el valor observado y el valor esperado acorde al modelo.</p>
<p><span class="math display">\[\epsilon_i= y_i -\hat{y}_i\]</span></p>
<p>A la hora de contemplar el conjunto de residuos hay dos posibilidades:</p>
<ul>
<li>La suma del valor absoluto de cada residuo.</li>
</ul>
<p><span class="math display">\[RAS=\sum_{i=1}^{n}{|e_i|}=\sum_{i=1}^{n}{|y_i-\hat{y}_i|}\]</span></p>
<ul>
<li>La suma del cuadrado de cada residuo (RSS). Esta es la aproximación más empleada (mínimos cuadrados) ya que magnifica las desviaciones más extremas.</li>
</ul>
<p><span class="math display">\[RSS=\sum_{i=1}^{n}{e_i^2}=\sum_{i=1}^{n}{(y_i-\hat{y}_i)^2}\]</span></p>
<p>Los residuos son muy importantes puesto que en ellos se basan las diferentes métricas de desempeño del modelo.</p>
<div id="condiciones-para-el-ajuste-de-una-regresión-lineal" class="section level4" number="5.2.2.1">
<h4><span class="header-section-number">5.2.2.1</span> Condiciones para el ajuste de una regresión lineal:</h4>
<p>Existen ciertas condiciones o supuestos que deben ser validados para el correcto ajuste de un modelo de regresión lineal, los cuales se enlistan a continuación:</p>
<ul>
<li><p><strong>Linealidad</strong>: La relación entre ambas variables debe ser lineal.</p></li>
<li><p><strong>Distribución normal de los residuos</strong>: Los residuos se tiene que distribuir de forma normal, con media igual a 0.</p></li>
<li><p><strong>Varianza de residuos constante (homocedasticidad)</strong>: La varianza de los residuos tiene que ser aproximadamente constante.</p></li>
<li><p><strong>Independencia</strong>: Las observaciones deben ser independientes unas de otras.</p></li>
</ul>
<p>Dado que las condiciones se verifican a partir de los residuos, primero se suele generar el modelo y después se valida.</p>
</div>
</div>
<div id="métricas-de-desempeño" class="section level3" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Métricas de desempeño</h3>
<p>Dado que nuestra variable a predecir es numérica, podemos medir qué tan cerca o lejos estuvimos del número esperado dada una predicción.</p>
<p>Las métricas de desempeño asociadas a los problemas de regresión ocupan esa distancia cómo cuantificación del desempeño o de los errores cometidos por el modelo.</p>
<p>Las métricas más utilizadas son:</p>
<ul>
<li>MEA: Mean Absolute Error</li>
<li>MAPE: Mean Absolute Percentual Error <span class="math inline">\(\quad \Rightarrow \quad\)</span> más usada para reportar resultados</li>
<li>RMSE: Root Mean Squared Error <span class="math inline">\(\quad \quad \quad \Rightarrow \quad\)</span> más usada para entrenar modelos</li>
<li><span class="math inline">\(R^2\)</span> : R cuadrada</li>
<li><span class="math inline">\(R^2\)</span> : <span class="math inline">\(R^2\)</span> ajustada</li>
<li>RMSLE: Root Mean Squared Logarithmic Loss Error</li>
</ul>
<hr />
<p><strong>MAE</strong>: <em>Mean Absolute Error</em></p>
<p><span class="math display">\[MAE = \frac{1}{N}\sum_{i=1}^{N}{|y_{i}-\hat{y}_{i}|}\]</span>
<strong>Donde:</strong></p>
<ul>
<li><span class="math inline">\(N:\)</span> Número de observaciones predichas.</li>
<li><span class="math inline">\(y_{i}:\)</span> Valor real.</li>
<li><span class="math inline">\(\hat{y}_{i}:\)</span> Valor de la predicción.</li>
</ul>
<p><br></p>
<p>Esta métrica suma los errores absolutos de cada predicción y los divide entre el número de observaciones, para obtener el promedio absoluto del error del modelo.</p>
<p><strong>Ventajas Vs Desventajas:</strong></p>
<p><strong>Todos los errores pesan lo mismo sin importar qué tan pequeños o qué tan grandes sean</strong>, es muy sensible a valores atípicos, y dado que obtiene el promedio puede ser que un solo error en la predicción que sea muy grande afecte al valor de todo el modelo, aún y cuando el modelo no tuvo errores tan malos para el resto de las observaciones.</p>
<p>Se recomienda utilizar esta métrica cuando los errores importan lo mismo, es decir, importa lo mismo si se equivocó muy poco o se equivocó mucho.</p>
<hr />
<p><strong>MAPE</strong>: <em>Mean Absolute Percentage Error</em></p>
<p><span class="math display">\[MAPE = \frac{1}{N}\sum_{i=1}^{N}\frac{{|y_{i}-\hat{y}_{i}|}}{|y_{i}|}\]</span>
<strong>Donde:</strong></p>
<p><span class="math inline">\(N:\)</span> Número de observaciones predichas.</p>
<p><span class="math inline">\(y_{i}:\)</span> Valor real.</p>
<p><span class="math inline">\(\hat{y}_{i}:\)</span> Valor de la predicción.</p>
<p><br></p>
<p>Esta métrica es la métrica MAE expresada en porcentaje, por lo que mide el error del modelo en términos de porcentaje, al igual que con MAE, no hay errores negativos por el valor absoluto, y mientras más pequeño el error es mejor.</p>
<p><strong>Ventajas Vs Desventajas:</strong></p>
<p>Cuando existe un valor real de 0 esta métrica no se puede calcular, por otro lado, una de las ventajas sobre MAE es que no es sensible a valores atípicos.</p>
<p>Se recomienda utilizar esta métrica cuando en tu problema no haya valores a predecir que puedan ser 0, por ejemplo, en ventas puedes llegar a tener 0 ventas, en este caso no podemos ocupar esta métrica.</p>
<p>En general a las personas de negocio les gusta esta métrica pues es fácil de comprender.</p>
<hr />
<p><strong>RMSE</strong>: <em>Root Mean Squared Error</em></p>
<p><span class="math display">\[RMSE = \sqrt{\frac{1}{N}\sum_{i=1}^{N}{(y_{i}-\hat{y}_{i})^2}}\]</span>
<strong>Donde:</strong></p>
<ul>
<li><span class="math inline">\(N:\)</span> Número de observaciones predichas.</li>
<li><span class="math inline">\(y_{i}:\)</span> Valor real.</li>
<li><span class="math inline">\(\hat{y}_{i}:\)</span> Valor de la predicción.</li>
</ul>
<p><br></p>
<p>Esta métrica es muy parecida a MAE, solo que en lugar de sacar el valor absoluto de la diferencia entre el valor real y el valor predicho, para evitar valores negativos eleva esta diferencia al cuadrado, y saca el promedio de esa diferencia, al final, para dejar el valor en la escala inicial saca la raíz cuadrada.</p>
<p>Esta es la métrica más utilizada en problemas de regresión, debido a que es más fácil de optimizar que el MAE.</p>
<p><strong>Ventajas Vs Desventaja:</strong></p>
<p>Todos los errores pesan lo mismo sin importar qué tan pequeños o qué tan grandes sean, es más sensible a valores atípicos que MAE pues eleva al cuadrado diferencias, y dado que obtiene el promedio puede ser que un solo error en la predicción que sea muy grande afecte al valor de todo el modelo, aún y cuando el modelo no tuvo errores tan malos para el resto de las observaciones.</p>
<p>Se recomienda utilizar esta métrica cuando en el problema que queremos resolver es muy costoso tener equivocaciones grandes, podemos tener varios errores pequeños, pero no grandes.</p>
<hr />
<p><strong><span class="math inline">\(R^2\)</span></strong>: <em>R cuadrada</em></p>
<p><span class="math display">\[R^{2} = \frac{\sum_{i=1}^{N}{(\hat{y}_{i}-\bar{y}_{i})^2}}{\sum_{i=1}^{N}{(y_{i}-\bar{y}_{i})^2}}\]</span>
<strong>Donde:</strong></p>
<ul>
<li><span class="math inline">\(N:\)</span> Número de observaciones predichas.</li>
<li><span class="math inline">\(y_{i}:\)</span> Valor real.</li>
<li><span class="math inline">\(\hat{y}_{i}:\)</span> Valor de la predicción.</li>
<li><span class="math inline">\(\bar{y}_{i}:\)</span> Valor promedio de la variable <em>y</em>.</li>
</ul>
<p><br></p>
<p>El coeficiente de determinación es la proporción de la varianza total de la variable explicada por la regresión. El coeficiente de determinación, también llamado R cuadrado, <strong>refleja la bondad del ajuste</strong> de un modelo a la variable que pretender explicar.</p>
<p>Es importante saber que el resultado del coeficiente de determinación oscila entre 0 y 1. Cuanto más cerca de 1 se sitúe su valor, mayor será el ajuste del modelo a la variable que estamos intentando explicar. De forma inversa, cuanto más cerca de cero, menos ajustado estará el modelo y, por tanto, menos fiable será.</p>
<p><strong>Ventajas Vs Desventaja:</strong></p>
<p>El problema del coeficiente de determinación, y razón por el cual surge el coeficiente de determinación ajustado, radica en que no penaliza la inclusión de variables explicativas no significativas, es decir, el valor de <span class="math inline">\(R^2\)</span> siempre será más grande cuantas más variables sean incluidas en el modelo, aún cuando estas no sean significativas en la predicción.</p>
<hr />
<p><strong><span class="math inline">\(\bar{R}^2\)</span></strong>: <em><span class="math inline">\(R^2\)</span> ajustada</em></p>
<p><span class="math display">\[\bar{R}^2=1-\frac{N-1}{N-k-1}[1-R^2]\]</span>
<strong>Donde:</strong></p>
<ul>
<li><span class="math inline">\(\bar{R}²:\)</span> Es el valor de R² ajustado</li>
<li><span class="math inline">\(R²:\)</span> Es el valor de R² original</li>
<li><span class="math inline">\(N:\)</span> Es el total de observaciones en el ajuste</li>
<li><span class="math inline">\(k:\)</span> Es el número de variables usadas en el modelo</li>
</ul>
<p><br></p>
<p>El coeficiente de determinación ajustado (R cuadrado ajustado) es la medida que define el porcentaje explicado por la varianza de la regresión en relación con la varianza de la variable explicada. Es decir, lo mismo que el R cuadrado, pero con una diferencia: El coeficiente de determinación ajustado penaliza la inclusión de variables.</p>
<p>En la fórmula, N es el tamaño de la muestra y k el número de variables explicativas.</p>
<hr />
<p><strong>RMSLE</strong>: <em>Root Mean Squared Logarithmic Loss Error</em></p>
<p><span class="math display">\[e = \sqrt{\frac{1}{n}\sum_{i=1}^{n} (log(1+p_i)-log(1+o_i))^2}\]</span></p>
<p><strong>Donde:</strong> <span class="math inline">\(p_i\)</span> son las predicciones y <span class="math inline">\(o_i\)</span> son las observaciones, esto implica que nos interesa más evaluar error relativo que absoluto, pues:</p>
<p><span class="math display">\[log(1+p)-log(1+o)=log(\frac{1+p}{1+o})\approx log(\frac{p}{o})=log(1+\frac{p-o}{o})\approx\frac{p-o}{p}\]</span></p>
<p><strong>Ventajas Vs Desventaja:</strong></p>
<p>Suele ser más complicada el entendimiento de esta métrica, a diferencia de las métricas anteriores, sin embargo, esta métrica realiza la penalización de los errores grandes al mismo tiempo que apromixa a al error relativo (<span class="math inline">\(\approx\)</span> raiz de error relativo cuadrático medio).</p>
</div>
<div id="implementación-en-r" class="section level3" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Implementación en R</h3>
<p>Ajustaremos un modelo de regresión usando la receta antes vista.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="aprendizaje-supervisado-1.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb98-2"><a href="aprendizaje-supervisado-1.html#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="aprendizaje-supervisado-1.html#cb98-3" aria-hidden="true" tabindex="-1"></a>modelo1 <span class="ot">&lt;-</span>  <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb98-4"><a href="aprendizaje-supervisado-1.html#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb98-5"><a href="aprendizaje-supervisado-1.html#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;lm&quot;</span>)</span>
<span id="cb98-6"><a href="aprendizaje-supervisado-1.html#cb98-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-7"><a href="aprendizaje-supervisado-1.html#cb98-7" aria-hidden="true" tabindex="-1"></a>lm_fit1 <span class="ot">&lt;-</span> <span class="fu">fit</span>(modelo1, Sale_Price <span class="sc">~</span> ., casa_juiced)</span>
<span id="cb98-8"><a href="aprendizaje-supervisado-1.html#cb98-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-9"><a href="aprendizaje-supervisado-1.html#cb98-9" aria-hidden="true" tabindex="-1"></a>p_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_fit1, casa_test_bake) <span class="sc">%&gt;%</span></span>
<span id="cb98-10"><a href="aprendizaje-supervisado-1.html#cb98-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.pred =</span> <span class="fu">exp</span>(.pred)) <span class="sc">%&gt;%</span> </span>
<span id="cb98-11"><a href="aprendizaje-supervisado-1.html#cb98-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(ames_test) <span class="sc">%&gt;%</span></span>
<span id="cb98-12"><a href="aprendizaje-supervisado-1.html#cb98-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.pred, Sale_Price) <span class="sc">%&gt;%</span> </span>
<span id="cb98-13"><a href="aprendizaje-supervisado-1.html#cb98-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error =</span> Sale_Price <span class="sc">-</span> .pred)</span>
<span id="cb98-14"><a href="aprendizaje-supervisado-1.html#cb98-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-15"><a href="aprendizaje-supervisado-1.html#cb98-15" aria-hidden="true" tabindex="-1"></a>p_test</span></code></pre></div>
<pre><code>## # A tibble: 733 × 3
##      .pred Sale_Price   error
##      &lt;dbl&gt;      &lt;int&gt;   &lt;dbl&gt;
##  1 116703.     105000 -11703.
##  2 177029.     185000   7971.
##  3 166772.     180400  13628.
##  4 109872.     141000  31128.
##  5 219261.     210000  -9261.
##  6 212340.     216000   3660.
##  7 164850.     149900 -14950.
##  8  99545.     105500   5955.
##  9 102023.      88000 -14023.
## 10 137758.     146000   8242.
## # … with 723 more rows</code></pre>
</div>
<div id="coeficientes-del-modelo" class="section level3" number="5.2.5">
<h3><span class="header-section-number">5.2.5</span> Coeficientes del modelo</h3>
<p>Podemos recuperar los coeficientes de nuestro modelo con la función <em>tidy()</em> y observar cuales variables explicativas son las más significativas de acuerdo con el <em>p-value</em>.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="aprendizaje-supervisado-1.html#cb100-1" aria-hidden="true" tabindex="-1"></a>lm_fit1 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(p.value))</span></code></pre></div>
<pre><code>## # A tibble: 275 × 5
##    term                                     estimate std.error statistic p.value
##    &lt;chr&gt;                                       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
##  1 Roof_Style_Gambrel                       -3.73e-4    0.0778  -0.00479   0.996
##  2 Exterior_1st_Stone                       -7.39e-4    0.141   -0.00524   0.996
##  3 House_Style_Two_Story                     3.78e-4    0.0281   0.0135    0.989
##  4 Neighborhood_South_and_West_of_Iowa_Sta… -5.82e-4    0.0369  -0.0158    0.987
##  5 Exterior_2nd_HdBoard                     -1.17e-3    0.0520  -0.0224    0.982
##  6 Bsmt_Cond_Typical                        -2.76e-3    0.0799  -0.0346    0.972
##  7 Electrical_Unknown                        4.00e-3    0.111    0.0362    0.971
##  8 Latitude                                 -5.38e-4    0.0142  -0.0380    0.970
##  9 Neighborhood_Mitchell                     1.66e-3    0.0421   0.0395    0.968
## 10 Neighborhood_Sawyer                       1.64e-3    0.0331   0.0494    0.961
## # … with 265 more rows</code></pre>
</div>
<div id="métricas-de-desempeño-1" class="section level3" number="5.2.6">
<h3><span class="header-section-number">5.2.6</span> Métricas de desempeño</h3>
<p>Ahora para calcular las métricas de desempeño usaremos la paqueteria <em>MLmetrics</em> y las funciones de <em>dplyr</em> para resumir y estructurar los resultados.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="aprendizaje-supervisado-1.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MLmetrics)</span>
<span id="cb102-2"><a href="aprendizaje-supervisado-1.html#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="aprendizaje-supervisado-1.html#cb102-3" aria-hidden="true" tabindex="-1"></a>p_test <span class="sc">%&gt;%</span> </span>
<span id="cb102-4"><a href="aprendizaje-supervisado-1.html#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb102-5"><a href="aprendizaje-supervisado-1.html#cb102-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">MAE =</span> MLmetrics<span class="sc">::</span><span class="fu">MAE</span>(.pred, Sale_Price),</span>
<span id="cb102-6"><a href="aprendizaje-supervisado-1.html#cb102-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">MAPE =</span> MLmetrics<span class="sc">::</span><span class="fu">MAPE</span>(.pred, Sale_Price),</span>
<span id="cb102-7"><a href="aprendizaje-supervisado-1.html#cb102-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMSE =</span> MLmetrics<span class="sc">::</span><span class="fu">RMSE</span>(.pred, Sale_Price),</span>
<span id="cb102-8"><a href="aprendizaje-supervisado-1.html#cb102-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">R2 =</span> MLmetrics<span class="sc">::</span><span class="fu">R2_Score</span>(.pred, Sale_Price),</span>
<span id="cb102-9"><a href="aprendizaje-supervisado-1.html#cb102-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMSLE =</span> MLmetrics<span class="sc">::</span><span class="fu">RMSLE</span>(.pred, Sale_Price)</span>
<span id="cb102-10"><a href="aprendizaje-supervisado-1.html#cb102-10" aria-hidden="true" tabindex="-1"></a>  ) </span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##      MAE   MAPE   RMSE    R2 RMSLE
##    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 16515. 0.0951 26794. 0.889 0.207</code></pre>
<div id="gráfica-de-ajuste" class="section level4" number="5.2.6.1">
<h4><span class="header-section-number">5.2.6.1</span> Gráfica de ajuste</h4>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="aprendizaje-supervisado-1.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb104-2"><a href="aprendizaje-supervisado-1.html#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="aprendizaje-supervisado-1.html#cb104-3" aria-hidden="true" tabindex="-1"></a>pred_obs_plot <span class="ot">&lt;-</span> p_test <span class="sc">%&gt;%</span> </span>
<span id="cb104-4"><a href="aprendizaje-supervisado-1.html#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .pred, <span class="at">y =</span> Sale_Price)) <span class="sc">+</span></span>
<span id="cb104-5"><a href="aprendizaje-supervisado-1.html#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb104-6"><a href="aprendizaje-supervisado-1.html#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicciones&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Observaciones&quot;</span>) <span class="sc">+</span></span>
<span id="cb104-7"><a href="aprendizaje-supervisado-1.html#cb104-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Predicción vs Observación&quot;</span>)</span>
<span id="cb104-8"><a href="aprendizaje-supervisado-1.html#cb104-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-9"><a href="aprendizaje-supervisado-1.html#cb104-9" aria-hidden="true" tabindex="-1"></a>error_line <span class="ot">&lt;-</span> p_test <span class="sc">%&gt;%</span> </span>
<span id="cb104-10"><a href="aprendizaje-supervisado-1.html#cb104-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Sale_Price, <span class="at">y =</span> error)) <span class="sc">+</span></span>
<span id="cb104-11"><a href="aprendizaje-supervisado-1.html#cb104-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb104-12"><a href="aprendizaje-supervisado-1.html#cb104-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Observaciones&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Errores&quot;</span>) <span class="sc">+</span></span>
<span id="cb104-13"><a href="aprendizaje-supervisado-1.html#cb104-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Varianza de errores&quot;</span>)</span>
<span id="cb104-14"><a href="aprendizaje-supervisado-1.html#cb104-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-15"><a href="aprendizaje-supervisado-1.html#cb104-15" aria-hidden="true" tabindex="-1"></a>pred_obs_plot <span class="sc">+</span> error_line</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-150-1.png" width="672" /></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="aprendizaje-supervisado-1.html#cb105-1" aria-hidden="true" tabindex="-1"></a>error_dist <span class="ot">&lt;-</span> p_test <span class="sc">%&gt;%</span> </span>
<span id="cb105-2"><a href="aprendizaje-supervisado-1.html#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> error)) <span class="sc">+</span></span>
<span id="cb105-3"><a href="aprendizaje-supervisado-1.html#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb105-4"><a href="aprendizaje-supervisado-1.html#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb105-5"><a href="aprendizaje-supervisado-1.html#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Conteos de clase&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Errores&quot;</span>) <span class="sc">+</span></span>
<span id="cb105-6"><a href="aprendizaje-supervisado-1.html#cb105-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Distribución de error&quot;</span>)</span>
<span id="cb105-7"><a href="aprendizaje-supervisado-1.html#cb105-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-8"><a href="aprendizaje-supervisado-1.html#cb105-8" aria-hidden="true" tabindex="-1"></a>error_qqplot <span class="ot">&lt;-</span> p_test <span class="sc">%&gt;%</span> </span>
<span id="cb105-9"><a href="aprendizaje-supervisado-1.html#cb105-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> error)) <span class="sc">+</span></span>
<span id="cb105-10"><a href="aprendizaje-supervisado-1.html#cb105-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> <span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb105-11"><a href="aprendizaje-supervisado-1.html#cb105-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Distribución normal&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Distribución de errores&quot;</span>) <span class="sc">+</span></span>
<span id="cb105-12"><a href="aprendizaje-supervisado-1.html#cb105-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;QQ-Plot&quot;</span>)</span>
<span id="cb105-13"><a href="aprendizaje-supervisado-1.html#cb105-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-14"><a href="aprendizaje-supervisado-1.html#cb105-14" aria-hidden="true" tabindex="-1"></a>error_dist <span class="sc">+</span> error_qqplot</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-151-1.png" width="672" /></p>
</div>
</div>
<div id="métodos-se-selección-de-variables" class="section level3" number="5.2.7">
<h3><span class="header-section-number">5.2.7</span> Métodos se selección de variables</h3>
<div id="forward-selection-selección-hacia-adelante" class="section level4" number="5.2.7.1">
<h4><span class="header-section-number">5.2.7.1</span> Forward selection (selección hacia adelante)</h4>
<p>Comienza sin predictores en el modelo, agrega iterativamente los predictores más contribuyentes y se detiene cuando la mejora del modelo ya no es estadísticamente significativa.</p>
<p><img src="img/05-sup/lineal/5-2-7-1-forward-selection.png" width="350pt" height="400pt" style="display: block; margin: auto;" /></p>
</div>
<div id="backward-selection-selección-hacia-atrás" class="section level4" number="5.2.7.2">
<h4><span class="header-section-number">5.2.7.2</span> Backward selection (selección hacia atrás)</h4>
<p>Comienza con todos los predictores en el modelo (modelo completo), y elimina iterativamente los
predictores menos contribuyentes y se detiene cuando tiene un modelo en el que
todos los predictores son estadísticamente significativos.</p>
<p><img src="img/05-sup/lineal/5-2-7-2-backward-selection.png" width="350pt" height="400pt" style="display: block; margin: auto;" /></p>
</div>
<div id="stepwise-selection-selección-paso-a-paso" class="section level4" number="5.2.7.3">
<h4><span class="header-section-number">5.2.7.3</span> Stepwise selection (selección paso a paso)</h4>
<p>Combinación de selecciones hacia adelante y hacia atrás. Comienza sin predictores, luego agrega secuencialmente los predictores más contribuyentes (como la selección hacia adelante). Después de agregar cada nueva variable, elimina cualquier variable que ya no proporcione una mejora en el ajuste del modelo (como la selección hacia atrás).</p>
<p><img src="img/05-sup/lineal/5-2-7-3-stepwise-selection.png" width="700pt" height="600pt" style="display: block; margin: auto;" /></p>
</div>
<div id="desventajas-de-la-selección-forward-backward-y-stepwise" class="section level4" number="5.2.7.4">
<h4><span class="header-section-number">5.2.7.4</span> Desventajas de la selección forward, backward y stepwise</h4>
<ul>
<li><p><strong>Inflación de resultados falsos positivos:</strong> la selección hacia adelante, hacia atrás y paso a paso utiliza muchas pruebas de hipótesis repetidas para tomar decisiones sobre la inclusión o exclusión de predictores individuales. Los valores <span class="math inline">\(p\)</span> correspondientes no están ajustados, lo que lleva a una selección excesiva de características (es decir, resultados falsos positivos). Además, este problema se agrava cuando están presentes predictores altamente correlacionados.</p></li>
<li><p><strong>Sobreajuste del modelo:</strong> Las estadísticas del modelo resultante, incluidas las estimaciones de los parámetros y la incertidumbre asociada, son muy optimistas ya que no tienen en cuenta el proceso de selección.</p></li>
</ul>
</div>
</div>
</div>
<div id="regresión-logística" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Regresión Logística</h2>
<blockquote>
<p>El nombre de este modelo es: <strong>Regresión Bernoulli con liga logit</strong>, pero todo mundo la conoce solo por regresión logística. Es importante saber que la liga puede ser elegida dentro de un conjunto de ligas comunes, por lo que puede dejar de ser logit y seguir siendo regresión Bernoulli, pero ya no podría ser llamada “logística.”</p>
</blockquote>
<p>Al igual que en regresión lineal, existe la regresión simple y regresión múltiple. La regresión logística simple se utiliza una variable independiente, mientras que cuando se utiliza más de una variable independiente, el proceso se denomina regresión logística múltiple.</p>
<p><strong>Objetivo:</strong> Estimar la <strong>probabilidad de pertenecer a la categoría <em>positiva</em> de una variable de respuesta categórica</strong>. Posteriormente, se determina el umbral de probabilidad a partir del cual se clasifica a una observación como positiva o negativa.</p>
<div id="función-sigmoide" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Función sigmoide</h3>
<p>Si una variable cualitativa con dos categorías se codifica como 1 y 0, matemáticamente es posible ajustar un modelo de regresión lineal por mínimos cuadrados. El problema de esta aproximación es que, al tratarse de una recta, para valores extremos del predictor, se obtienen valores de <span class="math inline">\(Y\)</span> menores que 0 o mayores que 1, lo que entra en contradicción con el hecho de que las probabilidades siempre están dentro del rango [0,1].</p>
<p>Para evitar estos problemas, la regresión logística transforma el valor devuelto por la regresión lineal empleando una función cuyo resultado está siempre comprendido entre 0 y 1. Existen varias funciones que cumplen esta descripción, una de las más utilizadas es la función logística (también conocida como función <strong>sigmoide</strong>):</p>
<p><span class="math display">\[\sigma(Z)=\frac{e^{Z}}{1+e^{Z}}\]</span>
Función sigmoide:</p>
<p><iframe src="rlogit.html" width="800px" height="400px" scrolling="no" seamless="seamless" frameBorder="0"></iframe></p>
<p>Para valores de <span class="math inline">\(Z\)</span> muy grandes, el valor de <span class="math inline">\(e^{Z}\)</span> tiende a <em>infinito</em> por lo que el valor de la función sigmoide es 1. Para valores de <span class="math inline">\(Z\)</span> muy negativos, el valor <span class="math inline">\(e^{Z}\)</span> tiende a <em>cero</em>, por lo que el valor de la función sigmoide es 0.</p>
<p>Sustituyendo la <span class="math inline">\(Z\)</span> de la función sigmoide por la función lineal <span class="math inline">\(\beta_0+\beta_1X\)</span> se obtiene que:</p>
<p><span class="math display">\[\pi=P(Y=k|X=x)=\frac{e^{\beta_0+\beta_1X}}{1+e^{\beta_0+\beta_1X}}\]</span></p>
<p>donde <span class="math inline">\(P(Y=k|X=x)\)</span> puede interpretarse como: la probabilidad de que la variable cualitativa <span class="math inline">\(Y\)</span> adquiera el valor <span class="math inline">\(k\)</span>, dado que el predictor <span class="math inline">\(X\)</span> tiene el valor <span class="math inline">\(x\)</span>.</p>
</div>
<div id="ajuste-del-modelo" class="section level3" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Ajuste del modelo</h3>
<p>Esta función, puede ajustarse de forma sencilla con métodos de regresión lineal si se emplea su versión logarítmica:</p>
<p><span class="math display">\[logit(\pi)= ln(\frac{\pi}{1-\pi}) = ln(\frac{p(Y=k|X=x)}{1−p(Y=k|X=x)})=\beta_0+\beta_1X\]</span></p>
<p><span class="math display">\[P(Y=k|X=x)=\frac{e^{\beta_0+\beta_1x_1+\beta_2x_2+...+\beta_ix_i}}{1+e^{\beta_0+\beta_1x_1+\beta_2x_2+...+\beta_ix_i}}\]</span></p>
<p>La combinación óptima de coeficientes <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> será aquella que tenga la máxima verosimilitud (maximum likelihood), es decir el valor de los parámetros <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> con los que se maximiza la probabilidad de obtener los datos observados.</p>
<p>El método de maximum likelihood está ampliamente extendido en la estadística aunque su implementación no siempre es trivial.</p>
<p>Otra forma para ajustar un modelo de regresión logística es empleando descenso de gradiente. Si bien este no es el método de optimización más adecuado para resolver la regresión logística, está muy extendido en el ámbito de machine learning para ajustar otros modelos.</p>
</div>
<div id="clasificación-1" class="section level3" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> Clasificación</h3>
<p>Una de las principales aplicaciones de un modelo de regresión logística es clasificar la variable cualitativa en función de valor que tome el predictor. Para conseguir esta clasificación, es necesario establecer un <strong>threshold</strong> de probabilidad a partir de la cual se considera que la variable pertenece a uno de los niveles. Por ejemplo, se puede asignar una observación al grupo 1 si <span class="math inline">\(p̂ (Y=1|X)&gt;0.3\)</span> y al grupo 0 si ocurre lo contrario.</p>
<p>Es importante mencionar que el punto de corte <strong>no necesariamente tiene que ser 0.5</strong>, este puede ser seleccionado a convenecía de la métrica a optimizar.</p>
</div>
<div id="métricas-de-desempeño-2" class="section level3" number="5.3.4">
<h3><span class="header-section-number">5.3.4</span> Métricas de desempeño</h3>
<p>Existen distintas métricas de desempeño para problemas de clasificación, debido a que contamos con la respuesta correcta podemos contar cuántos aciertos tuvimos y cuántos fallos tuvimos.</p>
<p>Primero, por simplicidad ocuparemos un ejemplo de clasificación binaria, Cancelación (1) o No Cancelación (0).</p>
<p>En este tipo de algoritmos definimos cuál de las categorías será nuestra etiqueta positiva y cuál será la negativa. La positiva será la categoría que queremos predecir -en nuestro ejemplo, Cancelación- y la negativa lo opuesto -en el caso binario- en nuestro ejemplo, no cancelación.</p>
<p>Dadas estas definiciones tenemos 4 posibilidades:</p>
<ul>
<li><p><strong>True positives</strong>: Nuestra predicción dijo que la transacción es fraude y la etiqueta real dice que es fradue.</p></li>
<li><p><strong>False positives</strong>: Nuestra predicción dijo que la transacción es fraude y la etiqueta real dice que no es fraude.</p></li>
<li><p><strong>True negatives</strong>: Nuestra predicción dijo que la transacción es no fraude y la etiqueta real dice que no es fraude.</p></li>
<li><p><strong>False negatives</strong>: Nuestra predicción dijo que la transacción es no fraude y la etiqueta real dice que es fraude.</p></li>
<li><p><strong>Matriz de confusión</strong></p></li>
</ul>
<p><img src="img/05-sup/logit/5-3-4-1_confusion_matrix.png" width="700pt" height="350pt" style="display: block; margin: auto;" /></p>
<p>Esta métrica corresponde a una matriz en donde se plasma el conteo de los aciertos y los errores que haya hecho el modelo, esto es: los verdaderos positivos (TP), los verdaderos negativos (TN), los falsos positivos (FP) y los falsos negativos (FN).</p>
<p>Normalmente los renglones representan las etiquetas predichas, ya sean positivas o negativas, y las columnas a las etiquetas reales, aunque esto puede cambiar en cualquier software.</p>
<hr />
<ul>
<li><strong>Accuracy</strong></li>
</ul>
<p>Número de aciertos totales entre todas las predicciones.</p>
<p><span class="math display">\[accuracy = \frac{TP + TN}{ TP+FP+TN+FN}\]</span></p>
<p>La métrica más utilizada, en datasets no balanceados esta métrica no nos sirve, al contrario, nos engaña. Adicionalmente, cuando la identificación de una categoría es más importante que otra es mejor recurrir a otras métricas.</p>
<hr />
<ul>
<li><strong>Precision</strong>: Eficiencia</li>
</ul>
<p>De los que identificamos como clase positiva, cuántos identificamos correctamente. ¿Qué tan eficientes somos en la predicción?</p>
<p><span class="math display">\[precision = \frac{TP}{TP + FP}\]</span></p>
<p>¿Cuándo utilizar precision?</p>
<p>Esta es la métrica que ocuparás más, pues en un contexto de negocio, donde los recursos son finitos y tiene un costo asociado, ya sea monetario o de tiempo o de recursos, necesitarás que las predicciones de tu etiqueta positiva sean muy eficientes.</p>
<p>Al utilizar esta métrica estaremos optimizando el modelo para minimizar el número de falsos positivos.</p>
<hr />
<ul>
<li><strong>Recall o Sensibilidad</strong>: Cobertura</li>
</ul>
<p>Del universo posible de nuestra clase positiva, cuántos identificamos correctamente.</p>
<p><span class="math display">\[recall = \frac{TP}{TP + FN }\]</span></p>
<p>Esta métrica la ocuparás cuando en el contexto de negocio de tu problema sea más conveniente aumentar la cantidad de positivos o disminuir los falsos negativos. Esto se realiza debido al impacto que estos pueden tener en las personas en quienes se implementará la predicción.</p>
<hr />
<ul>
<li><strong>Especificidad</strong></li>
</ul>
<p>Es el número de observaciones correctamente identificados como negativos fuera del total de negativos.</p>
<p><span class="math display">\[Specificity = \frac{TN}{TN+FP}\]</span></p>
<hr />
<ul>
<li><strong>F1-score</strong></li>
</ul>
<p>Combina precision y recall para optimizar ambos.</p>
<p><span class="math display">\[F = 2 *\frac{precision * recall}{precision + recall} \]</span></p>
<p>Se recomienda utilizar esta métrica de desempeño cuando quieres balancear tanto los falsos positivos como los falsos negativos. Aunque es una buena solución para tomar en cuenta ambos errores, pocas veces hay problemas reales que permiten ocuparla, esto es porque en más del 90% de los casos tenemos una restricción en recursos.</p>
<p>Ahora con esto en mente podemos definir las siguientes métricas:</p>
<hr />
<ul>
<li><strong>AUC y ROC</strong>: <em>Area Under the Curve y Receiver operator characteristic</em></li>
</ul>
<p><img src="img/05-sup/logit/5-3-4-2_roc.png" width="700pt" height="400pt" style="display: block; margin: auto;" /></p>
<p>Una curva <strong>ROC</strong> es un gráfico que muestra el desempeño de un modelo de clasificación en todos los puntos de corte.</p>
<p><strong>AUC</strong> significa “Área bajo la curva ROC.” Es decir, <strong>AUC</strong> mide el área debajo de la curva ROC.</p>
</div>
<div id="implementación-en-r-1" class="section level3" number="5.3.5">
<h3><span class="header-section-number">5.3.5</span> Implementación en R</h3>
<p>Ajustaremos un modelo de regresión logística usando la receta antes vista.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="aprendizaje-supervisado-1.html#cb106-1" aria-hidden="true" tabindex="-1"></a>logistic_model <span class="ot">&lt;-</span>  <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb106-2"><a href="aprendizaje-supervisado-1.html#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>)</span>
<span id="cb106-3"><a href="aprendizaje-supervisado-1.html#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="aprendizaje-supervisado-1.html#cb106-4" aria-hidden="true" tabindex="-1"></a>logistic_fit1 <span class="ot">&lt;-</span> parsnip<span class="sc">::</span><span class="fu">fit</span>(logistic_model, Churn <span class="sc">~</span> ., telco_juiced)</span>
<span id="cb106-5"><a href="aprendizaje-supervisado-1.html#cb106-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-6"><a href="aprendizaje-supervisado-1.html#cb106-6" aria-hidden="true" tabindex="-1"></a>logistic_p_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(logistic_fit1, telco_test_bake) <span class="sc">%&gt;%</span></span>
<span id="cb106-7"><a href="aprendizaje-supervisado-1.html#cb106-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(telco_test_bake) <span class="sc">%&gt;%</span> </span>
<span id="cb106-8"><a href="aprendizaje-supervisado-1.html#cb106-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.pred_class, Churn)</span>
<span id="cb106-9"><a href="aprendizaje-supervisado-1.html#cb106-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-10"><a href="aprendizaje-supervisado-1.html#cb106-10" aria-hidden="true" tabindex="-1"></a>logistic_p_test</span></code></pre></div>
<pre><code>## # A tibble: 2,113 × 2
##    .pred_class Churn
##    &lt;fct&gt;       &lt;fct&gt;
##  1 No          No   
##  2 Yes         Yes  
##  3 No          No   
##  4 No          No   
##  5 No          No   
##  6 Yes         No   
##  7 No          No   
##  8 No          No   
##  9 No          Yes  
## 10 No          No   
## # … with 2,103 more rows</code></pre>
</div>
<div id="métricas-de-desempeño-3" class="section level3" number="5.3.6">
<h3><span class="header-section-number">5.3.6</span> Métricas de desempeño</h3>
<p><strong>Matriz de Confusión</strong></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="aprendizaje-supervisado-1.html#cb108-1" aria-hidden="true" tabindex="-1"></a>logistic_p_test <span class="sc">%&gt;%</span> </span>
<span id="cb108-2"><a href="aprendizaje-supervisado-1.html#cb108-2" aria-hidden="true" tabindex="-1"></a>  yardstick<span class="sc">::</span><span class="fu">conf_mat</span>(<span class="at">truth =</span> Churn, <span class="at">estimate =</span> .pred_class) <span class="sc">%&gt;%</span> </span>
<span id="cb108-3"><a href="aprendizaje-supervisado-1.html#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="at">type =</span> <span class="st">&quot;heatmap&quot;</span>)</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-159-1.png" width="672" /></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="aprendizaje-supervisado-1.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb109-2"><a href="aprendizaje-supervisado-1.html#cb109-2" aria-hidden="true" tabindex="-1"></a>    yardstick<span class="sc">::</span><span class="fu">accuracy</span>(logistic_p_test, Churn, .pred_class, <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>),</span>
<span id="cb109-3"><a href="aprendizaje-supervisado-1.html#cb109-3" aria-hidden="true" tabindex="-1"></a>    yardstick<span class="sc">::</span><span class="fu">precision</span>(logistic_p_test, Churn, .pred_class, <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>),</span>
<span id="cb109-4"><a href="aprendizaje-supervisado-1.html#cb109-4" aria-hidden="true" tabindex="-1"></a>    yardstick<span class="sc">::</span><span class="fu">recall</span>(logistic_p_test, Churn, .pred_class, <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>),</span>
<span id="cb109-5"><a href="aprendizaje-supervisado-1.html#cb109-5" aria-hidden="true" tabindex="-1"></a>    yardstick<span class="sc">::</span><span class="fu">specificity</span>(logistic_p_test, Churn, .pred_class, <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>),</span>
<span id="cb109-6"><a href="aprendizaje-supervisado-1.html#cb109-6" aria-hidden="true" tabindex="-1"></a>    yardstick<span class="sc">::</span><span class="fu">f_meas</span>(logistic_p_test, Churn, .pred_class, <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>)</span>
<span id="cb109-7"><a href="aprendizaje-supervisado-1.html#cb109-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   .metric   .estimator .estimate
##   &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy  binary         0.803
## 2 precision binary         0.684
## 3 recall    binary         0.493
## 4 spec      binary         0.917
## 5 f_meas    binary         0.573</code></pre>
<p><strong>¿Y si se quiere un corte diferente? ¿el negocio qué necesita?</strong></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="aprendizaje-supervisado-1.html#cb111-1" aria-hidden="true" tabindex="-1"></a>logistic_p_test_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(logistic_fit1, telco_test_bake, <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb111-2"><a href="aprendizaje-supervisado-1.html#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(telco_test_bake) <span class="sc">%&gt;%</span> </span>
<span id="cb111-3"><a href="aprendizaje-supervisado-1.html#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.pred_Yes, .pred_No, Churn)</span>
<span id="cb111-4"><a href="aprendizaje-supervisado-1.html#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="aprendizaje-supervisado-1.html#cb111-5" aria-hidden="true" tabindex="-1"></a>logistic_p_test_prob</span></code></pre></div>
<pre><code>## # A tibble: 2,113 × 3
##    .pred_Yes .pred_No Churn
##        &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;
##  1    0.0367    0.963 No   
##  2    0.837     0.163 Yes  
##  3    0.335     0.665 No   
##  4    0.0130    0.987 No   
##  5    0.0348    0.965 No   
##  6    0.509     0.491 No   
##  7    0.0753    0.925 No   
##  8    0.0449    0.955 No   
##  9    0.424     0.576 Yes  
## 10    0.0187    0.981 No   
## # … with 2,103 more rows</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="aprendizaje-supervisado-1.html#cb113-1" aria-hidden="true" tabindex="-1"></a>logistic_p_test_prob <span class="ot">&lt;-</span> logistic_p_test_prob <span class="sc">%&gt;%</span> </span>
<span id="cb113-2"><a href="aprendizaje-supervisado-1.html#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.pred_class  =</span> <span class="fu">as_factor</span>(<span class="fu">if_else</span> ( .pred_Yes <span class="sc">&gt;=</span> <span class="fl">0.30</span>, <span class="st">&#39;Yes&#39;</span>, <span class="st">&#39;No&#39;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb113-3"><a href="aprendizaje-supervisado-1.html#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(.pred_class , <span class="at">.after =</span> .pred_No)</span>
<span id="cb113-4"><a href="aprendizaje-supervisado-1.html#cb113-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-5"><a href="aprendizaje-supervisado-1.html#cb113-5" aria-hidden="true" tabindex="-1"></a>logistic_p_test_prob</span></code></pre></div>
<pre><code>## # A tibble: 2,113 × 4
##    .pred_Yes .pred_No .pred_class Churn
##        &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;       &lt;fct&gt;
##  1    0.0367    0.963 No          No   
##  2    0.837     0.163 Yes         Yes  
##  3    0.335     0.665 Yes         No   
##  4    0.0130    0.987 No          No   
##  5    0.0348    0.965 No          No   
##  6    0.509     0.491 Yes         No   
##  7    0.0753    0.925 No          No   
##  8    0.0449    0.955 No          No   
##  9    0.424     0.576 Yes         Yes  
## 10    0.0187    0.981 No          No   
## # … with 2,103 more rows</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="aprendizaje-supervisado-1.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb115-2"><a href="aprendizaje-supervisado-1.html#cb115-2" aria-hidden="true" tabindex="-1"></a>    yardstick<span class="sc">::</span><span class="fu">accuracy</span>(logistic_p_test_prob, Churn, .pred_class, <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>),</span>
<span id="cb115-3"><a href="aprendizaje-supervisado-1.html#cb115-3" aria-hidden="true" tabindex="-1"></a>    yardstick<span class="sc">::</span><span class="fu">precision</span>(logistic_p_test_prob, Churn, .pred_class, <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>),</span>
<span id="cb115-4"><a href="aprendizaje-supervisado-1.html#cb115-4" aria-hidden="true" tabindex="-1"></a>    yardstick<span class="sc">::</span><span class="fu">recall</span>(logistic_p_test_prob, Churn, .pred_class, <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>),</span>
<span id="cb115-5"><a href="aprendizaje-supervisado-1.html#cb115-5" aria-hidden="true" tabindex="-1"></a>    yardstick<span class="sc">::</span><span class="fu">specificity</span>(logistic_p_test_prob, Churn, .pred_class, <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>),</span>
<span id="cb115-6"><a href="aprendizaje-supervisado-1.html#cb115-6" aria-hidden="true" tabindex="-1"></a>    yardstick<span class="sc">::</span><span class="fu">f_meas</span>(logistic_p_test_prob, Churn, .pred_class, <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>)</span>
<span id="cb115-7"><a href="aprendizaje-supervisado-1.html#cb115-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   .metric   .estimator .estimate
##   &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy  binary         0.769
## 2 precision binary         0.548
## 3 recall    binary         0.783
## 4 spec      binary         0.764
## 5 f_meas    binary         0.645</code></pre>
<p>Para poder determinar cual es el mejor punto de corte, es indispensable conocer el comportamiento y efecto de los diferentes puntos de corte.</p>
<p>Veamos un ejemplo visual en nuestra aplicación de Shiny: <a href="https://acturio.shinyapps.io/confusion_matrix/">ConfusionMatrixShiny</a></p>
</div>
</div>
<div id="regularización" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Regularización</h2>
<p>En muchas técnicas de aprendizaje automático, <strong>el aprendizaje consiste en encontrar los coeficientes que minimizan una función de costo</strong>. Un modelo estándar de mínimos cuadrados tiende a tener alguna variación, es decir, este modelo no se generalizará bien para un conjunto de datos diferente a sus datos de entrenamiento.</p>
<p>La regularización consiste en <strong>añadir una penalización a la función de costo. Esta penalización produce modelos más simples que generalizan mejor y evita el riesgo de sobreajuste</strong>.</p>
<p>El procedimiento de ajuste implica una función de pérdida, conocida como suma de cuadrados residual o <em>RSS</em>. Los coeficientes <span class="math inline">\(\beta\)</span> se eligen de manera que minimicen esta función de pérdida.</p>
<p><span class="math display">\[RSS = \sum_{i=1}^n\left(y_i - \beta_0- \sum_{i=1}^p \beta_jx_{ij}\right)^2\]</span></p>
<p>Esto ajustará los coeficientes en función de sus datos de entrenamiento. Si hay ruido en los datos de entrenamiento, los coeficientes estimados no se generalizarán bien a los datos futuros. Aquí es donde entra la regularización y reduce o regulariza estas estimaciones aprendidas hacia cero.</p>
<p>En esta sección se verán las regularizaciones más usadas en machine learning:</p>
<ul>
<li>Ridge (conocida también como L2)</li>
<li>Lasso (también conocida como L1)</li>
<li>ElasticNet que combina tanto Lasso como Ridge.</li>
</ul>
<p>Para cada una de estas regularizaciones ajustaremos un modelo de regresión lineal al conjunto de datos de viviendas de <em>Ames</em> con ayuda del paquete de <em>tidymodels</em> llamado <em>parsnip</em>.</p>
<p><img src="img/05-sup/elasticnet/overfitting.png" width="500pt" height="250pt" style="display: block; margin: auto;" /></p>
<div id="regularización-ridge" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Regularización Ridge</h3>
<p>En este tipo de regularización <em>RSS</em> se modifica agregando una cantidad de <strong>contracción a los coeficientes</strong>, los cuales se estiman minimizando esta función. <span class="math inline">\(\lambda\)</span> es el parámetro de ajuste que decide cuánto queremos penalizar la flexibilidad de el modelo.</p>
<p><span class="math display">\[\sum_{i=1}^n\left(y_i - \beta_0- \sum_{i=1}^p \beta_jx_{ij}\right)^2 + \lambda \sum_{j=1}^p \beta_j^2 = RSS + \lambda \sum_{j=1}^p \beta_j^2\]</span></p>
<p>El aumento de la flexibilidad de un modelo está representado por el aumento de sus coeficientes, si se desea minimizar la función anterior, los coeficientes deben ser pequeños.</p>
<p>Así es como la técnica de regresión de <em>Ridge</em> evita que los coeficientes aumenten demasiado. Además, reduce la asociación estimada de cada variable con la respuesta excepto la intersección <span class="math inline">\(\beta_0\)</span>. Esta intersección es una medida del valor medio de la respuesta cuando <span class="math inline">\(x_{i1} = x_{i2} =\dots= x_{ip} = 0\)</span>.</p>
<blockquote>
<p>Cuando <span class="math inline">\(\lambda = 0\)</span>, el término de penalización no tiene efecto y las estimaciones serán iguales a mínimos cuadrados.</p>
</blockquote>
<blockquote>
<p>A medida que <span class="math inline">\(\lambda \rightarrow \infty\)</span>, el impacto de la penalización por contracción aumenta, y las estimaciones se acercarán a cero.</p>
</blockquote>
<p>La selección de un buen valor de <span class="math inline">\(\lambda\)</span> es fundamental. Las estimaciones de coeficientes producidas por este método también se conocen como la <strong>norma L2</strong>.</p>
<p><strong>Nota:</strong> Es necesario estandarizar los predictores o llevarlos a la misma escala antes de aplicar esta regularización.</p>
</div>
<div id="regularización-lasso" class="section level3" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Regularización Lasso</h3>
<p>Lasso es otra variación, en la que se minimiza la función <em>RSS</em>. Utiliza <span class="math inline">\(|\beta_j|\)</span> en lugar de los cuadrados de <span class="math inline">\(\beta\)</span> como penalización. Las estimaciones de coeficientes producidas por este método también se conocen como la <strong>norma L1</strong>.</p>
<p><span class="math display">\[\sum_{i=1}^n\left(y_i - \beta_0- \sum_{i=1}^p \beta_jx_{ij}\right)^2 + \lambda \sum_{j=1}^p |\beta_j| = RSS + \lambda \sum_{j=1}^p |\beta_j|\]</span></p>
<blockquote>
<p>Cuando <span class="math inline">\(\lambda = 0\)</span>, el término de penalización no tiene efecto y las estimaciones serán iguales a mínimos cuadrados.</p>
</blockquote>
<blockquote>
<p>A medida que <span class="math inline">\(\lambda \rightarrow \infty\)</span>, el impacto de la penalización por contracción aumenta, y las estimaciones se convierten en cero (eliminando variables).</p>
</blockquote>
<p>Este método de regularizacion permite eliminar coeficientes con alta variación, lo cual <strong>ayuda a la selección de variables</strong>.</p>
</div>
<div id="comparación-entre-ridge-y-lasso" class="section level3" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Comparación entre Ridge y Lasso</h3>
<p>La regresión <em>Ridge</em> se puede considerar como la solución de una ecuación, donde la suma de los cuadrados de los coeficientes es menor o igual que <span class="math inline">\(s\)</span>, donde <span class="math inline">\(s\)</span> es una constante que existe para cada valor del factor de contracción <span class="math inline">\(\lambda\)</span></p>
<p><span class="math display">\[\beta_1^2 + \beta_2^2 \leq s\]</span></p>
<p>Esto implica que los coeficientes de la regresión <em>Ridge</em> tienen el <em>RSS</em> (función de pérdida) más pequeño para todos los puntos que se encuentran dentro del círculo dado por la función de restricción <span class="math inline">\(\beta_1^2 + \beta_2^2 \leq s\)</span>.</p>
<p>Y en la regresión <em>Lasso</em> se puede considerar como una ecuación en la que la suma del módulo de coeficientes es menor o igual que <span class="math inline">\(s\)</span>.</p>
<p><span class="math display">\[|\beta_1| + |\beta_2| \leq s\]</span></p>
<p>Esto implica que los coeficientes de lasso tienen la <em>RSS</em> (función de pérdida) más pequeña para todos los puntos que se encuentran dentro del diamante dado por la función de restricción <span class="math inline">\(|\beta_1| + |\beta_2| \leq s\)</span></p>
<p><img src="img/05-sup/elasticnet/ridge-lasso.png" width="600pt" height="300pt" style="display: block; margin: auto;" /></p>
<p>La imagen de arriba muestra las funciones de restricción (áreas verdes) para <em>Lasso</em> (izquierda) y <em>Ridge</em> (derecha), junto con contornos para <em>RSS</em> (elipse roja).</p>
<p>Para un valor muy grande de <span class="math inline">\(s\)</span>, las regiones verdes contendrán el centro de la elipse, lo que hará que las estimaciones de los coeficientes de ambas técnicas de regresión sean iguales a las estimaciones de mínimos cuadrados. Pero este no es el caso en la imagen de arriba.</p>
<p>En este caso, las estimaciones del coeficiente de regresión de <em>Lasso</em> y <em>Ridge</em> vienen dadas por el primer punto en el que una elipse contacta con la región de restricción. Dado que la regresión <em>Ridge</em> tiene una restricción circular sin puntos agudos, <strong>esta intersección generalmente no ocurrirá en un eje, por lo que las estimaciones del coeficiente de regresión de <em>Ridge</em> serán exclusivamente distintas de cero</strong>.</p>
<p>Sin embargo, la restricción de <em>Lasso</em> <strong>tiene esquinas en cada uno de los ejes</strong>, por lo que la elipse a menudo intersectará la región de restricción en un eje. <strong>Cuando esto ocurre, uno de los coeficientes será igual a cero</strong>. En dimensiones más altas, muchas de las estimaciones de coeficientes pueden ser guales a cero simultáneamente.</p>
<p><strong>Desventajas</strong></p>
<ul>
<li><p>Regresión <em>Ridge</em>: Reducirá los coeficientes de los predictores menos importantes, muy cerca de cero. Pero nunca los hará exactamente cero. En otras palabras, el modelo final incluirá todos los predictores.</p></li>
<li><p>Regresión <em>Lasso</em>: La penalización <em>L1</em> tiene el efecto de forzar algunas de las estimaciones de coeficientes a ser exactamente iguales a cero cuando el parámetro de ajuste <span class="math inline">\(\lambda\)</span> es suficientemente grande. Por lo tanto, este método realiza una selección de variables.</p></li>
</ul>
</div>
<div id="elasticnet" class="section level3" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> ElasticNet</h3>
<p><em>ElasticNet</em> surgió por primera vez como resultado de la crítica a <em>Lasso</em>, cuya selección de variables puede ser demasiado dependiente de los datos y, por lo tanto, inestable. La solución es <strong>combinar las penalizaciones</strong> de la regresión de <em>Ridge</em> y <em>Lasso</em> para obtener lo mejor de ambas regularizaciones.</p>
<p><em>ElasticNet</em> tiene como objetivo minimizar la siguiente función de pérdida:</p>
<p><span class="math display">\[\frac{\sum_{i=1}^n\left(y_i - \beta_0- \sum_{i=1}^p \beta_jx_{ij}\right)^2}{2n} + 
\lambda\left( ({1-\alpha}) \sum_{j=1}^p|\beta_j| + \alpha \sum_{j=1}^p \beta_j ^2\right)\]</span></p>
<p><span class="math display">\[= \frac{RSS}{2n}+ \lambda\left( ({1-\alpha}) \sum_{j=1}^p|\beta_j| + \alpha \sum_{j=1}^p \beta_j ^2\right)\]</span></p>
<p>donde <span class="math inline">\(\alpha \in [0,1]\)</span> es el parámetro de mezcla entre la regularización <em>Ridge</em> <span class="math inline">\((\alpha = 0)\)</span> y la regularización <em>Lasso</em> <span class="math inline">\((\alpha = 1)\)</span>.</p>
<p>La combinación de ambas penalizaciones suele dar lugar a buenos resultados. Una estrategia frecuentemente utilizada es asignarle casi todo el peso a la penalización <em>L1</em> ( <span class="math inline">\(\alpha \approx 1\)</span>) para conseguir seleccionar predictores y menos peso a la regularización <span class="math inline">\(L2\)</span> para dar cierta estabilidad en el caso de que algunos predictores estén correlacionados.</p>
<p><img src="img/05-sup/elasticnet/elastic-net.png" width="550pt" height="400pt" style="display: block; margin: auto;" /></p>
</div>
<div id="elasticnet-para-regresión-lineal" class="section level3" number="5.4.5">
<h3><span class="header-section-number">5.4.5</span> ElasticNet para regresión lineal</h3>
<p>Utilizando el modelo <code>linear_reg()</code> del paquete <em>parsnip</em>. Hay varios mecanismos que pueden realizar la regularización/penalización, los paquetes <em>glmnet</em>, <em>sparklyr</em>, <em>keras</em> o <em>stan</em>.</p>
<p>Usemos el primero aquí. El paquete <em>glmnet</em> solo implementa un método que no es de fórmula, pero <em>parsnip</em> permitirá que se use cualquiera de ellos.</p>
<p>Cuando se utiliza la regularización, los predictores deben de centrarse y escalarse primero antes de pasar al modelo. El método de la fórmula no lo hará automáticamente, por lo que tendremos que hacerlo nosotros mismos como se hizo en la sección <strong>4.6 Preparación de conjunto de datos</strong> con la receta <code>receta_casas</code>.</p>
<p>En <em>R</em> existen dos parámetros que nos permiten hacer la regularización:</p>
<ul>
<li><p><code>penalty</code>: Es un número no negativo que representa la cantidad total de regularización (solo <em>glmnet</em>, <em>keras</em> y <em>spark</em>).</p></li>
<li><p><code>mixture</code>: Es un número entre cero y uno (inclusivo) que es la proporción de regularización <em>L1</em> en el modelo. Cuando <code>mixture = 1</code>, es un modelo de <em>Lasso</em> puro, mientras que <code>mixture = 0</code> indica que se está utilizando un modelo <em>Ridge</em>.</p></li>
</ul>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="aprendizaje-supervisado-1.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb117-2"><a href="aprendizaje-supervisado-1.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb117-3"><a href="aprendizaje-supervisado-1.html#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="aprendizaje-supervisado-1.html#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Partición</span></span>
<span id="cb117-5"><a href="aprendizaje-supervisado-1.html#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4595</span>)</span>
<span id="cb117-6"><a href="aprendizaje-supervisado-1.html#cb117-6" aria-hidden="true" tabindex="-1"></a>ames_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(ames, <span class="at">prop =</span> <span class="fl">0.75</span>)</span>
<span id="cb117-7"><a href="aprendizaje-supervisado-1.html#cb117-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-8"><a href="aprendizaje-supervisado-1.html#cb117-8" aria-hidden="true" tabindex="-1"></a>ames_train <span class="ot">&lt;-</span> <span class="fu">training</span>(ames_split)</span>
<span id="cb117-9"><a href="aprendizaje-supervisado-1.html#cb117-9" aria-hidden="true" tabindex="-1"></a>ames_test  <span class="ot">&lt;-</span> <span class="fu">testing</span>(ames_split)</span>
<span id="cb117-10"><a href="aprendizaje-supervisado-1.html#cb117-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-11"><a href="aprendizaje-supervisado-1.html#cb117-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2453</span>)</span>
<span id="cb117-12"><a href="aprendizaje-supervisado-1.html#cb117-12" aria-hidden="true" tabindex="-1"></a>ames_folds<span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(ames_train)</span>
<span id="cb117-13"><a href="aprendizaje-supervisado-1.html#cb117-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-14"><a href="aprendizaje-supervisado-1.html#cb117-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Receta</span></span>
<span id="cb117-15"><a href="aprendizaje-supervisado-1.html#cb117-15" aria-hidden="true" tabindex="-1"></a>receta_casas <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Sale_Price <span class="sc">~</span> . , <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb117-16"><a href="aprendizaje-supervisado-1.html#cb117-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_log</span>(Sale_Price, <span class="at">skip =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb117-17"><a href="aprendizaje-supervisado-1.html#cb117-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Alley) <span class="sc">%&gt;%</span></span>
<span id="cb117-18"><a href="aprendizaje-supervisado-1.html#cb117-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rename</span>(<span class="at">Year_Remod =</span> Year_Remod_Add) <span class="sc">%&gt;%</span> </span>
<span id="cb117-19"><a href="aprendizaje-supervisado-1.html#cb117-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rename</span>(<span class="at">ThirdSsn_Porch =</span> Three_season_porch) <span class="sc">%&gt;%</span> </span>
<span id="cb117-20"><a href="aprendizaje-supervisado-1.html#cb117-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_ratio</span>(Bedroom_AbvGr, <span class="at">denom =</span> <span class="fu">denom_vars</span>(Gr_Liv_Area)) <span class="sc">%&gt;%</span> </span>
<span id="cb117-21"><a href="aprendizaje-supervisado-1.html#cb117-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(</span>
<span id="cb117-22"><a href="aprendizaje-supervisado-1.html#cb117-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_House =</span> Year_Sold <span class="sc">-</span> Year_Remod,</span>
<span id="cb117-23"><a href="aprendizaje-supervisado-1.html#cb117-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">TotalSF   =</span> Gr_Liv_Area <span class="sc">+</span> Total_Bsmt_SF,</span>
<span id="cb117-24"><a href="aprendizaje-supervisado-1.html#cb117-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">AvgRoomSF   =</span> Gr_Liv_Area <span class="sc">/</span> TotRms_AbvGrd,</span>
<span id="cb117-25"><a href="aprendizaje-supervisado-1.html#cb117-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Pool =</span> <span class="fu">if_else</span>(Pool_Area <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb117-26"><a href="aprendizaje-supervisado-1.html#cb117-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">Exter_Cond =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Exter_Cond, <span class="at">Good =</span> <span class="fu">c</span>(<span class="st">&quot;Typical&quot;</span>, <span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Excellent&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb117-27"><a href="aprendizaje-supervisado-1.html#cb117-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_relevel</span>(Exter_Cond, <span class="at">ref_level =</span> <span class="st">&quot;Good&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb117-28"><a href="aprendizaje-supervisado-1.html#cb117-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_predictors</span>(), <span class="sc">-</span><span class="fu">all_nominal</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb117-29"><a href="aprendizaje-supervisado-1.html#cb117-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb117-30"><a href="aprendizaje-supervisado-1.html#cb117-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> Second_Flr_SF<span class="sc">:</span>First_Flr_SF) <span class="sc">%&gt;%</span> </span>
<span id="cb117-31"><a href="aprendizaje-supervisado-1.html#cb117-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;Bsmt_Cond&quot;</span>)<span class="sc">:</span>TotRms_AbvGrd) <span class="sc">%&gt;%</span> </span>
<span id="cb117-32"><a href="aprendizaje-supervisado-1.html#cb117-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(</span>
<span id="cb117-33"><a href="aprendizaje-supervisado-1.html#cb117-33" aria-hidden="true" tabindex="-1"></a>    First_Flr_SF, Second_Flr_SF, Year_Remod,</span>
<span id="cb117-34"><a href="aprendizaje-supervisado-1.html#cb117-34" aria-hidden="true" tabindex="-1"></a>    Bsmt_Full_Bath, Bsmt_Half_Bath, </span>
<span id="cb117-35"><a href="aprendizaje-supervisado-1.html#cb117-35" aria-hidden="true" tabindex="-1"></a>    Kitchen_AbvGr, BsmtFin_Type_1_Unf, </span>
<span id="cb117-36"><a href="aprendizaje-supervisado-1.html#cb117-36" aria-hidden="true" tabindex="-1"></a>    Total_Bsmt_SF, Kitchen_AbvGr, Pool_Area, </span>
<span id="cb117-37"><a href="aprendizaje-supervisado-1.html#cb117-37" aria-hidden="true" tabindex="-1"></a>    Gr_Liv_Area, Sale_Type_Oth, Sale_Type_VWD</span>
<span id="cb117-38"><a href="aprendizaje-supervisado-1.html#cb117-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb117-39"><a href="aprendizaje-supervisado-1.html#cb117-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb117-40"><a href="aprendizaje-supervisado-1.html#cb117-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-41"><a href="aprendizaje-supervisado-1.html#cb117-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Declaración del modelo </span></span>
<span id="cb117-42"><a href="aprendizaje-supervisado-1.html#cb117-42" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_model <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(</span>
<span id="cb117-43"><a href="aprendizaje-supervisado-1.html#cb117-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">mixture =</span> <span class="fu">tune</span>(), </span>
<span id="cb117-44"><a href="aprendizaje-supervisado-1.html#cb117-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">penalty =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb117-45"><a href="aprendizaje-supervisado-1.html#cb117-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb117-46"><a href="aprendizaje-supervisado-1.html#cb117-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>)</span>
<span id="cb117-47"><a href="aprendizaje-supervisado-1.html#cb117-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-48"><a href="aprendizaje-supervisado-1.html#cb117-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Declaración del flujo de trabajo </span></span>
<span id="cb117-49"><a href="aprendizaje-supervisado-1.html#cb117-49" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb117-50"><a href="aprendizaje-supervisado-1.html#cb117-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(lasso_ridge_regression_model) <span class="sc">%&gt;%</span> </span>
<span id="cb117-51"><a href="aprendizaje-supervisado-1.html#cb117-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(receta_casas)</span>
<span id="cb117-52"><a href="aprendizaje-supervisado-1.html#cb117-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-53"><a href="aprendizaje-supervisado-1.html#cb117-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros a probar</span></span>
<span id="cb117-54"><a href="aprendizaje-supervisado-1.html#cb117-54" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_parameters_set <span class="ot">&lt;-</span> <span class="fu">parameters</span>(</span>
<span id="cb117-55"><a href="aprendizaje-supervisado-1.html#cb117-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">penalty</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">1</span>), <span class="at">trans =</span> <span class="fu">log10_trans</span>()),</span>
<span id="cb117-56"><a href="aprendizaje-supervisado-1.html#cb117-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mixture</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb117-57"><a href="aprendizaje-supervisado-1.html#cb117-57" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb117-58"><a href="aprendizaje-supervisado-1.html#cb117-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-59"><a href="aprendizaje-supervisado-1.html#cb117-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Grid</span></span>
<span id="cb117-60"><a href="aprendizaje-supervisado-1.html#cb117-60" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_parameters_grid <span class="ot">&lt;-</span> <span class="fu">grid_regular</span>(</span>
<span id="cb117-61"><a href="aprendizaje-supervisado-1.html#cb117-61" aria-hidden="true" tabindex="-1"></a>  lasso_ridge_regression_parameters_set, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">20</span>)</span>
<span id="cb117-62"><a href="aprendizaje-supervisado-1.html#cb117-62" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb117-63"><a href="aprendizaje-supervisado-1.html#cb117-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-64"><a href="aprendizaje-supervisado-1.html#cb117-64" aria-hidden="true" tabindex="-1"></a>ctrl_grid <span class="ot">&lt;-</span> <span class="fu">control_grid</span>(<span class="at">save_pred =</span> T, <span class="at">verbose =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="aprendizaje-supervisado-1.html#cb118-1" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb118-2"><a href="aprendizaje-supervisado-1.html#cb118-2" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb118-3"><a href="aprendizaje-supervisado-1.html#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb118-4"><a href="aprendizaje-supervisado-1.html#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="aprendizaje-supervisado-1.html#cb118-5" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_tunning <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb118-6"><a href="aprendizaje-supervisado-1.html#cb118-6" aria-hidden="true" tabindex="-1"></a>  lasso_ridge_regression_workflow,</span>
<span id="cb118-7"><a href="aprendizaje-supervisado-1.html#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> ames_folds,</span>
<span id="cb118-8"><a href="aprendizaje-supervisado-1.html#cb118-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> lasso_ridge_regression_parameters_grid,</span>
<span id="cb118-9"><a href="aprendizaje-supervisado-1.html#cb118-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, rsq, mae, mape),</span>
<span id="cb118-10"><a href="aprendizaje-supervisado-1.html#cb118-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> ctrl_grid</span>
<span id="cb118-11"><a href="aprendizaje-supervisado-1.html#cb118-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb118-12"><a href="aprendizaje-supervisado-1.html#cb118-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-13"><a href="aprendizaje-supervisado-1.html#cb118-13" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb118-14"><a href="aprendizaje-supervisado-1.html#cb118-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-15"><a href="aprendizaje-supervisado-1.html#cb118-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Se guarda tune_grid en RDS </span></span>
<span id="cb118-16"><a href="aprendizaje-supervisado-1.html#cb118-16" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_tunning <span class="sc">%&gt;%</span> </span>
<span id="cb118-17"><a href="aprendizaje-supervisado-1.html#cb118-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">&quot;models/lasso_ridge_regression_tunning.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="aprendizaje-supervisado-1.html#cb119-1" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_tunning <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;models/lasso_ridge_regression_tunning.rds&quot;</span>)</span>
<span id="cb119-2"><a href="aprendizaje-supervisado-1.html#cb119-2" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_tunning</span></code></pre></div>
<pre><code>## # Tuning results
## # 10-fold cross-validation 
## # A tibble: 10 × 5
##    splits             id     .metrics             .notes           .predictions
##    &lt;list&gt;             &lt;chr&gt;  &lt;list&gt;               &lt;list&gt;           &lt;list&gt;      
##  1 &lt;split [1977/220]&gt; Fold01 &lt;tibble [3,200 × 6]&gt; &lt;tibble [1 × 1]&gt; &lt;tibble&gt;    
##  2 &lt;split [1977/220]&gt; Fold02 &lt;tibble [3,200 × 6]&gt; &lt;tibble [1 × 1]&gt; &lt;tibble&gt;    
##  3 &lt;split [1977/220]&gt; Fold03 &lt;tibble [3,200 × 6]&gt; &lt;tibble [1 × 1]&gt; &lt;tibble&gt;    
##  4 &lt;split [1977/220]&gt; Fold04 &lt;tibble [3,200 × 6]&gt; &lt;tibble [1 × 1]&gt; &lt;tibble&gt;    
##  5 &lt;split [1977/220]&gt; Fold05 &lt;tibble [3,200 × 6]&gt; &lt;tibble [1 × 1]&gt; &lt;tibble&gt;    
##  6 &lt;split [1977/220]&gt; Fold06 &lt;tibble [3,200 × 6]&gt; &lt;tibble [1 × 1]&gt; &lt;tibble&gt;    
##  7 &lt;split [1977/220]&gt; Fold07 &lt;tibble [3,200 × 6]&gt; &lt;tibble [1 × 1]&gt; &lt;tibble&gt;    
##  8 &lt;split [1978/219]&gt; Fold08 &lt;tibble [3,200 × 6]&gt; &lt;tibble [1 × 1]&gt; &lt;tibble&gt;    
##  9 &lt;split [1978/219]&gt; Fold09 &lt;tibble [3,200 × 6]&gt; &lt;tibble [1 × 1]&gt; &lt;tibble&gt;    
## 10 &lt;split [1978/219]&gt; Fold10 &lt;tibble [3,200 × 6]&gt; &lt;tibble [1 × 1]&gt; &lt;tibble&gt;</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="aprendizaje-supervisado-1.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Métrica R cuadrada</span></span>
<span id="cb121-2"><a href="aprendizaje-supervisado-1.html#cb121-2" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_tunning <span class="sc">%&gt;%</span> </span>
<span id="cb121-3"><a href="aprendizaje-supervisado-1.html#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(.metrics) <span class="sc">%&gt;%</span> </span>
<span id="cb121-4"><a href="aprendizaje-supervisado-1.html#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">&quot;rsq&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb121-5"><a href="aprendizaje-supervisado-1.html#cb121-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(.estimate)) <span class="sc">%&gt;%</span> </span>
<span id="cb121-6"><a href="aprendizaje-supervisado-1.html#cb121-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 10
##    splits             id    penalty mixture .metric .estimator .estimate .config
##    &lt;list&gt;             &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;  
##  1 &lt;split [1977/220]&gt; Fold… 1   e-4  0.0526 rsq     standard       0.734 Prepro…
##  2 &lt;split [1977/220]&gt; Fold… 1.34e-4  0.0526 rsq     standard       0.734 Prepro…
##  3 &lt;split [1977/220]&gt; Fold… 1.80e-4  0.0526 rsq     standard       0.734 Prepro…
##  4 &lt;split [1977/220]&gt; Fold… 2.42e-4  0.0526 rsq     standard       0.734 Prepro…
##  5 &lt;split [1977/220]&gt; Fold… 3.26e-4  0.0526 rsq     standard       0.734 Prepro…
##  6 &lt;split [1977/220]&gt; Fold… 4.38e-4  0.0526 rsq     standard       0.734 Prepro…
##  7 &lt;split [1977/220]&gt; Fold… 5.88e-4  0.0526 rsq     standard       0.734 Prepro…
##  8 &lt;split [1977/220]&gt; Fold… 7.90e-4  0.0526 rsq     standard       0.734 Prepro…
##  9 &lt;split [1977/220]&gt; Fold… 1.06e-3  0.0526 rsq     standard       0.734 Prepro…
## 10 &lt;split [1977/220]&gt; Fold… 1.43e-3  0.0526 rsq     standard       0.734 Prepro…
## # … with 2 more variables: .notes &lt;list&gt;, .predictions &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="aprendizaje-supervisado-1.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analizando las métricas de manera visual </span></span>
<span id="cb123-2"><a href="aprendizaje-supervisado-1.html#cb123-2" aria-hidden="true" tabindex="-1"></a>graf_rsq <span class="ot">&lt;-</span> lasso_ridge_regression_tunning <span class="sc">%&gt;%</span> </span>
<span id="cb123-3"><a href="aprendizaje-supervisado-1.html#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(.metrics) <span class="sc">%&gt;%</span> </span>
<span id="cb123-4"><a href="aprendizaje-supervisado-1.html#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">&quot;rsq&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb123-5"><a href="aprendizaje-supervisado-1.html#cb123-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> penalty, <span class="at">y =</span> .estimate)) <span class="sc">+</span></span>
<span id="cb123-6"><a href="aprendizaje-supervisado-1.html#cb123-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb123-7"><a href="aprendizaje-supervisado-1.html#cb123-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> id))<span class="sc">+</span></span>
<span id="cb123-8"><a href="aprendizaje-supervisado-1.html#cb123-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb123-9"><a href="aprendizaje-supervisado-1.html#cb123-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;R cuadrada vs Penalización&#39;</span>)</span>
<span id="cb123-10"><a href="aprendizaje-supervisado-1.html#cb123-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-11"><a href="aprendizaje-supervisado-1.html#cb123-11" aria-hidden="true" tabindex="-1"></a>graf_rsq</span></code></pre></div>
<pre><code>## Warning: Removed 190 row(s) containing missing values (geom_path).</code></pre>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="aprendizaje-supervisado-1.html#cb125-1" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_tunning <span class="sc">%&gt;%</span> <span class="fu">collect_metrics</span>()</span></code></pre></div>
<pre><code>## # A tibble: 3,200 × 8
##     penalty mixture .metric .estimator       mean     n      std_err .config    
##       &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt; &lt;int&gt;        &lt;dbl&gt; &lt;chr&gt;      
##  1 0.0001         0 mae     standard   180544.       10 1014.        Preprocess…
##  2 0.0001         0 mape    standard      100.       10    0.0000689 Preprocess…
##  3 0.0001         0 rmse    standard   197259.       10 1734.        Preprocess…
##  4 0.0001         0 rsq     standard        0.687    10    0.0110    Preprocess…
##  5 0.000134       0 mae     standard   180544.       10 1014.        Preprocess…
##  6 0.000134       0 mape    standard      100.       10    0.0000689 Preprocess…
##  7 0.000134       0 rmse    standard   197259.       10 1734.        Preprocess…
##  8 0.000134       0 rsq     standard        0.687    10    0.0110    Preprocess…
##  9 0.000180       0 mae     standard   180544.       10 1014.        Preprocess…
## 10 0.000180       0 mape    standard      100.       10    0.0000689 Preprocess…
## # … with 3,190 more rows</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="aprendizaje-supervisado-1.html#cb127-1" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_tunning <span class="sc">%&gt;%</span></span>
<span id="cb127-2"><a href="aprendizaje-supervisado-1.html#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb127-3"><a href="aprendizaje-supervisado-1.html#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mixture <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-4"><a href="aprendizaje-supervisado-1.html#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(penalty, mean, <span class="at">color =</span> .metric)) <span class="sc">+</span></span>
<span id="cb127-5"><a href="aprendizaje-supervisado-1.html#cb127-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb127-6"><a href="aprendizaje-supervisado-1.html#cb127-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> mean <span class="sc">-</span> std_err,</span>
<span id="cb127-7"><a href="aprendizaje-supervisado-1.html#cb127-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> mean <span class="sc">+</span> std_err), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb127-8"><a href="aprendizaje-supervisado-1.html#cb127-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb127-9"><a href="aprendizaje-supervisado-1.html#cb127-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>.metric, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb127-10"><a href="aprendizaje-supervisado-1.html#cb127-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb127-11"><a href="aprendizaje-supervisado-1.html#cb127-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-173-1.png" width="672" /></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="aprendizaje-supervisado-1.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(lasso_ridge_regression_tunning)</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-174-1.png" width="672" /></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="aprendizaje-supervisado-1.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección de los mejores 10 modelos según la métrica R cuadrada</span></span>
<span id="cb129-2"><a href="aprendizaje-supervisado-1.html#cb129-2" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_tunning <span class="sc">%&gt;%</span> </span>
<span id="cb129-3"><a href="aprendizaje-supervisado-1.html#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">show_best</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 8
##     penalty mixture .metric .estimator  mean     n std_err .config              
##       &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                
##  1 0.0367         0 rsq     standard   0.687    10  0.0110 Preprocessor1_Model0…
##  2 0.0492         0 rsq     standard   0.687    10  0.0110 Preprocessor1_Model0…
##  3 0.0273         0 rsq     standard   0.687    10  0.0110 Preprocessor1_Model0…
##  4 0.0001         0 rsq     standard   0.687    10  0.0110 Preprocessor1_Model0…
##  5 0.000134       0 rsq     standard   0.687    10  0.0110 Preprocessor1_Model0…
##  6 0.000180       0 rsq     standard   0.687    10  0.0110 Preprocessor1_Model0…
##  7 0.000242       0 rsq     standard   0.687    10  0.0110 Preprocessor1_Model0…
##  8 0.000326       0 rsq     standard   0.687    10  0.0110 Preprocessor1_Model0…
##  9 0.000438       0 rsq     standard   0.687    10  0.0110 Preprocessor1_Model0…
## 10 0.000588       0 rsq     standard   0.687    10  0.0110 Preprocessor1_Model0…</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="aprendizaje-supervisado-1.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección del mejor modelo según la métrica R cuadrada</span></span>
<span id="cb131-2"><a href="aprendizaje-supervisado-1.html#cb131-2" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_best_model <span class="ot">&lt;-</span> <span class="fu">select_best</span>(</span>
<span id="cb131-3"><a href="aprendizaje-supervisado-1.html#cb131-3" aria-hidden="true" tabindex="-1"></a>  lasso_ridge_regression_tunning, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>)</span>
<span id="cb131-4"><a href="aprendizaje-supervisado-1.html#cb131-4" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_best_model</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   penalty mixture .config               
##     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                 
## 1  0.0367       0 Preprocessor1_Model021</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="aprendizaje-supervisado-1.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección del mejor modelo por un error estándar</span></span>
<span id="cb133-2"><a href="aprendizaje-supervisado-1.html#cb133-2" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_best_1se_model <span class="ot">&lt;-</span> <span class="fu">select_by_one_std_err</span>(</span>
<span id="cb133-3"><a href="aprendizaje-supervisado-1.html#cb133-3" aria-hidden="true" tabindex="-1"></a>  lasso_ridge_regression_tunning, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>, <span class="st">&quot;rsq&quot;</span>)</span>
<span id="cb133-4"><a href="aprendizaje-supervisado-1.html#cb133-4" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_best_1se_model</span></code></pre></div>
<pre><code>## # A tibble: 1 × 10
##   penalty mixture .metric .estimator  mean     n std_err .config    .best .bound
##     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;
## 1  0.0001       0 rsq     standard   0.687    10  0.0110 Preproces… 0.687  0.676</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="aprendizaje-supervisado-1.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección del mejor modelo por porcentaje de pérdida</span></span>
<span id="cb135-2"><a href="aprendizaje-supervisado-1.html#cb135-2" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_best_pct_loss_model <span class="ot">&lt;-</span> <span class="fu">select_by_pct_loss</span>(</span>
<span id="cb135-3"><a href="aprendizaje-supervisado-1.html#cb135-3" aria-hidden="true" tabindex="-1"></a>  lasso_ridge_regression_tunning, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>, <span class="st">&quot;rsq&quot;</span>, <span class="at">limit =</span> <span class="dv">5</span>)</span>
<span id="cb135-4"><a href="aprendizaje-supervisado-1.html#cb135-4" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_best_pct_loss_model</span></code></pre></div>
<pre><code>## # A tibble: 1 × 10
##   penalty mixture .metric .estimator  mean     n std_err .config   .best   .loss
##     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1  0.0001       0 rsq     standard   0.687    10  0.0110 Preproce… 0.687 0.00578</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="aprendizaje-supervisado-1.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo final </span></span>
<span id="cb137-2"><a href="aprendizaje-supervisado-1.html#cb137-2" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_final_model <span class="ot">&lt;-</span> lasso_ridge_regression_workflow <span class="sc">%&gt;%</span></span>
<span id="cb137-3"><a href="aprendizaje-supervisado-1.html#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(lasso_ridge_regression_best_1se_model) <span class="sc">%&gt;%</span></span>
<span id="cb137-4"><a href="aprendizaje-supervisado-1.html#cb137-4" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">data =</span> ames_train)</span>
<span id="cb137-5"><a href="aprendizaje-supervisado-1.html#cb137-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb137-6"><a href="aprendizaje-supervisado-1.html#cb137-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-7"><a href="aprendizaje-supervisado-1.html#cb137-7" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_final_model <span class="sc">%&gt;%</span> </span>
<span id="cb137-8"><a href="aprendizaje-supervisado-1.html#cb137-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb137-9"><a href="aprendizaje-supervisado-1.html#cb137-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(estimate))) <span class="sc">%&gt;%</span> </span>
<span id="cb137-10"><a href="aprendizaje-supervisado-1.html#cb137-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>)</span></code></pre></div>
<pre><code>##              term    estimate penalty
## 1     (Intercept) 12.02013159   1e-04
## 2      Year_Built  0.10133358   1e-04
## 3   TotRms_AbvGrd  0.07467521   1e-04
## 4      Fireplaces  0.06871314   1e-04
## 5     Garage_Area  0.05345236   1e-04
## 6       Full_Bath  0.05180514   1e-04
## 7     Garage_Cars  0.04578311   1e-04
## 8    BsmtFin_SF_1 -0.04297080   1e-04
## 9    Mas_Vnr_Area  0.03498704   1e-04
## 10    Bsmt_Unf_SF  0.03260094   1e-04
## 11   Wood_Deck_SF  0.02892588   1e-04
## 12   Screen_Porch  0.02266798   1e-04
## 13  Open_Porch_SF  0.02162425   1e-04
## 14       Lot_Area  0.02144120   1e-04
## 15 Enclosed_Porch  0.02071560   1e-04
## 16       Latitude  0.01936046   1e-04
## 17      Longitude -0.01905589   1e-04
## 18      Half_Bath  0.01890797   1e-04
## 19       Misc_Val -0.01608877   1e-04
## 20  Bedroom_AbvGr -0.01417964   1e-04</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="aprendizaje-supervisado-1.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicciones</span></span>
<span id="cb139-2"><a href="aprendizaje-supervisado-1.html#cb139-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">predict</span>(lasso_ridge_regression_final_model, ames_test) <span class="sc">%&gt;%</span> </span>
<span id="cb139-3"><a href="aprendizaje-supervisado-1.html#cb139-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(<span class="at">truth =</span> ames_test<span class="sc">$</span>Sale_Price) <span class="sc">%&gt;%</span> </span>
<span id="cb139-4"><a href="aprendizaje-supervisado-1.html#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.pred =</span> <span class="fu">exp</span>(.pred)) <span class="sc">%&gt;%</span> </span>
<span id="cb139-5"><a href="aprendizaje-supervisado-1.html#cb139-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">pred_laso_ridge_reg =</span> .pred, <span class="at">Sale_Price =</span> truth)</span>
<span id="cb139-6"><a href="aprendizaje-supervisado-1.html#cb139-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-7"><a href="aprendizaje-supervisado-1.html#cb139-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   pred_laso_ridge_reg Sale_Price
##                 &lt;dbl&gt;      &lt;int&gt;
## 1             131177.     105000
## 2             177281.     185000
## 3             191728.     180400
## 4             122011.     141000
## 5             242145.     210000
## 6             188283.     216000</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="aprendizaje-supervisado-1.html#cb141-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> yardstick<span class="sc">::</span><span class="fu">metrics</span>(Sale_Price, pred_laso_ridge_reg)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 rmse    standard   40274.   
## 2 rsq     standard       0.759
## 3 mae     standard   27272.</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="aprendizaje-supervisado-1.html#cb143-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb143-2"><a href="aprendizaje-supervisado-1.html#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pred_laso_ridge_reg, <span class="at">y =</span> Sale_Price)) <span class="sc">+</span></span>
<span id="cb143-3"><a href="aprendizaje-supervisado-1.html#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb143-4"><a href="aprendizaje-supervisado-1.html#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-5"><a href="aprendizaje-supervisado-1.html#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Prediction&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-6"><a href="aprendizaje-supervisado-1.html#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Observation&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-7"><a href="aprendizaje-supervisado-1.html#cb143-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Comparisson&quot;</span>)</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
</div>
<div id="elasticnet-para-regresión-logística" class="section level3" number="5.4.6">
<h3><span class="header-section-number">5.4.6</span> ElasticNet para regresión logística</h3>
<p>tilizando el modelo <code>logistic_reg()</code> del paquete <em>parsnip</em>. Hay varios mecanismos que pueden realizar la regularización/penalización, los paquetes <em>glmnet</em>, <em>sparklyr</em>, <em>keras</em> o <em>stan</em>.</p>
<p>Usemos el primero aquí. El paquete <em>glmnet</em> solo implementa un método que no es de fórmula, pero <em>parsnip</em> permitirá que se use cualquiera de ellos.</p>
<p>Cuando se utiliza la regularización, los predictores deben de centrarse y escalarse primero antes de pasar al modelo. El método de la fórmula no lo hará automáticamente, por lo que tendremos que hacerlo nosotros mismos como se hizo en la sección <strong>4.6 Preparación de conjunto de datos</strong> con la receta <code>receta_casas</code>.</p>
<p>En <em>R</em> existen dos parámetros que nos permiten hacer la regularización:</p>
<ul>
<li><p><code>penalty</code>: Es un número no negativo que representa la cantidad total de regularización (solo <em>glmnet</em>, <em>keras</em> y <em>spark</em>).</p></li>
<li><p><code>mixture</code>: Es un número entre cero y uno (inclusivo) que es la proporción de regularización <em>L1</em> en el modelo. Cuando <code>mixture = 1</code>, es un modelo de <em>Lasso</em> puro, mientras que <code>mixture = 0</code> indica que se está utilizando un modelo <em>Ridge</em>.</p></li>
</ul>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="aprendizaje-supervisado-1.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de datos</span></span>
<span id="cb144-2"><a href="aprendizaje-supervisado-1.html#cb144-2" aria-hidden="true" tabindex="-1"></a>telco <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/Churn.csv&quot;</span>)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   .default = col_character(),
##   SeniorCitizen = col_double(),
##   tenure = col_double(),
##   MonthlyCharges = col_double(),
##   TotalCharges = col_double()
## )
## ℹ Use `spec()` for the full column specifications.</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="aprendizaje-supervisado-1.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Partición de muestras</span></span>
<span id="cb146-2"><a href="aprendizaje-supervisado-1.html#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb146-3"><a href="aprendizaje-supervisado-1.html#cb146-3" aria-hidden="true" tabindex="-1"></a>telco_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(telco, <span class="at">prop =</span> .<span class="dv">7</span>)</span>
<span id="cb146-4"><a href="aprendizaje-supervisado-1.html#cb146-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-5"><a href="aprendizaje-supervisado-1.html#cb146-5" aria-hidden="true" tabindex="-1"></a>telco_train <span class="ot">&lt;-</span> <span class="fu">training</span>(telco_split)</span>
<span id="cb146-6"><a href="aprendizaje-supervisado-1.html#cb146-6" aria-hidden="true" tabindex="-1"></a>telco_test  <span class="ot">&lt;-</span> <span class="fu">testing</span>(telco_split)</span>
<span id="cb146-7"><a href="aprendizaje-supervisado-1.html#cb146-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-8"><a href="aprendizaje-supervisado-1.html#cb146-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb146-9"><a href="aprendizaje-supervisado-1.html#cb146-9" aria-hidden="true" tabindex="-1"></a>telco_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(telco_train)</span>
<span id="cb146-10"><a href="aprendizaje-supervisado-1.html#cb146-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-11"><a href="aprendizaje-supervisado-1.html#cb146-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-12"><a href="aprendizaje-supervisado-1.html#cb146-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Receta</span></span>
<span id="cb146-13"><a href="aprendizaje-supervisado-1.html#cb146-13" aria-hidden="true" tabindex="-1"></a>binner <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb146-14"><a href="aprendizaje-supervisado-1.html#cb146-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cut</span>(x, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">24</span>, <span class="dv">36</span>,<span class="dv">48</span>,<span class="dv">60</span>,<span class="dv">72</span>), <span class="at">include.lowest =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb146-15"><a href="aprendizaje-supervisado-1.html#cb146-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb146-16"><a href="aprendizaje-supervisado-1.html#cb146-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb146-17"><a href="aprendizaje-supervisado-1.html#cb146-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-18"><a href="aprendizaje-supervisado-1.html#cb146-18" aria-hidden="true" tabindex="-1"></a>telco_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Churn <span class="sc">~</span> ., <span class="at">data =</span> telco_train) <span class="sc">%&gt;%</span> </span>
<span id="cb146-19"><a href="aprendizaje-supervisado-1.html#cb146-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(customerID, <span class="at">new_role =</span> <span class="st">&quot;id variable&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb146-20"><a href="aprendizaje-supervisado-1.html#cb146-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_num2factor</span>(tenure, <span class="at">transform =</span> binner, </span>
<span id="cb146-21"><a href="aprendizaje-supervisado-1.html#cb146-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;0-1 year&quot;</span>, <span class="st">&quot;1-2 years&quot;</span>, <span class="st">&quot;2-3 years&quot;</span>, <span class="st">&quot;3-4 years&quot;</span>, <span class="st">&quot;4-5 years&quot;</span>, <span class="st">&quot;5-6 years&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb146-22"><a href="aprendizaje-supervisado-1.html#cb146-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb146-23"><a href="aprendizaje-supervisado-1.html#cb146-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb146-24"><a href="aprendizaje-supervisado-1.html#cb146-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_median</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb146-25"><a href="aprendizaje-supervisado-1.html#cb146-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(customerID, <span class="at">skip=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb146-26"><a href="aprendizaje-supervisado-1.html#cb146-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb146-27"><a href="aprendizaje-supervisado-1.html#cb146-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-28"><a href="aprendizaje-supervisado-1.html#cb146-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-29"><a href="aprendizaje-supervisado-1.html#cb146-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Declaración del modelo de regresión logística</span></span>
<span id="cb146-30"><a href="aprendizaje-supervisado-1.html#cb146-30" aria-hidden="true" tabindex="-1"></a>regularized_logistic_model <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>(</span>
<span id="cb146-31"><a href="aprendizaje-supervisado-1.html#cb146-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">mixture =</span> <span class="fu">tune</span>(), <span class="at">penalty =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb146-32"><a href="aprendizaje-supervisado-1.html#cb146-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;classification&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb146-33"><a href="aprendizaje-supervisado-1.html#cb146-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>) </span>
<span id="cb146-34"><a href="aprendizaje-supervisado-1.html#cb146-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-35"><a href="aprendizaje-supervisado-1.html#cb146-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Declaración del workflow</span></span>
<span id="cb146-36"><a href="aprendizaje-supervisado-1.html#cb146-36" aria-hidden="true" tabindex="-1"></a>regularized_logistic_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb146-37"><a href="aprendizaje-supervisado-1.html#cb146-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(telco_rec) <span class="sc">%&gt;%</span> </span>
<span id="cb146-38"><a href="aprendizaje-supervisado-1.html#cb146-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(regularized_logistic_model)</span>
<span id="cb146-39"><a href="aprendizaje-supervisado-1.html#cb146-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-40"><a href="aprendizaje-supervisado-1.html#cb146-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Fijación de parámetros</span></span>
<span id="cb146-41"><a href="aprendizaje-supervisado-1.html#cb146-41" aria-hidden="true" tabindex="-1"></a>regularized_parameters_set <span class="ot">&lt;-</span> <span class="fu">parameters</span>(</span>
<span id="cb146-42"><a href="aprendizaje-supervisado-1.html#cb146-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">penalty</span>(</span>
<span id="cb146-43"><a href="aprendizaje-supervisado-1.html#cb146-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">2</span>),</span>
<span id="cb146-44"><a href="aprendizaje-supervisado-1.html#cb146-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">trans =</span> <span class="fu">log10_trans</span>()</span>
<span id="cb146-45"><a href="aprendizaje-supervisado-1.html#cb146-45" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb146-46"><a href="aprendizaje-supervisado-1.html#cb146-46" aria-hidden="true" tabindex="-1"></a>  dials<span class="sc">::</span><span class="fu">mixture</span>()</span>
<span id="cb146-47"><a href="aprendizaje-supervisado-1.html#cb146-47" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb146-48"><a href="aprendizaje-supervisado-1.html#cb146-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-49"><a href="aprendizaje-supervisado-1.html#cb146-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Declaración del grid </span></span>
<span id="cb146-50"><a href="aprendizaje-supervisado-1.html#cb146-50" aria-hidden="true" tabindex="-1"></a>regularized_parameters_grid <span class="ot">&lt;-</span> <span class="fu">grid_regular</span>(</span>
<span id="cb146-51"><a href="aprendizaje-supervisado-1.html#cb146-51" aria-hidden="true" tabindex="-1"></a>  regularized_parameters_set, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">15</span>)</span>
<span id="cb146-52"><a href="aprendizaje-supervisado-1.html#cb146-52" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb146-53"><a href="aprendizaje-supervisado-1.html#cb146-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-54"><a href="aprendizaje-supervisado-1.html#cb146-54" aria-hidden="true" tabindex="-1"></a>ctrl_grid <span class="ot">&lt;-</span> <span class="fu">control_grid</span>(<span class="at">save_pred =</span> T, <span class="at">verbose =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="aprendizaje-supervisado-1.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se crea el cluster de trabajo </span></span>
<span id="cb147-2"><a href="aprendizaje-supervisado-1.html#cb147-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-3"><a href="aprendizaje-supervisado-1.html#cb147-3" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb147-4"><a href="aprendizaje-supervisado-1.html#cb147-4" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb147-5"><a href="aprendizaje-supervisado-1.html#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb147-6"><a href="aprendizaje-supervisado-1.html#cb147-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-7"><a href="aprendizaje-supervisado-1.html#cb147-7" aria-hidden="true" tabindex="-1"></a>regularized_tune_result <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb147-8"><a href="aprendizaje-supervisado-1.html#cb147-8" aria-hidden="true" tabindex="-1"></a>  regularized_logistic_workflow,</span>
<span id="cb147-9"><a href="aprendizaje-supervisado-1.html#cb147-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> telco_folds,</span>
<span id="cb147-10"><a href="aprendizaje-supervisado-1.html#cb147-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> regularized_parameters_grid,</span>
<span id="cb147-11"><a href="aprendizaje-supervisado-1.html#cb147-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(roc_auc, pr_auc),</span>
<span id="cb147-12"><a href="aprendizaje-supervisado-1.html#cb147-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> ctrl_grid</span>
<span id="cb147-13"><a href="aprendizaje-supervisado-1.html#cb147-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb147-14"><a href="aprendizaje-supervisado-1.html#cb147-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-15"><a href="aprendizaje-supervisado-1.html#cb147-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Se detiene el cluster de trabajo</span></span>
<span id="cb147-16"><a href="aprendizaje-supervisado-1.html#cb147-16" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster) </span>
<span id="cb147-17"><a href="aprendizaje-supervisado-1.html#cb147-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-18"><a href="aprendizaje-supervisado-1.html#cb147-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Se guarda tune_grid en formato RDS</span></span>
<span id="cb147-19"><a href="aprendizaje-supervisado-1.html#cb147-19" aria-hidden="true" tabindex="-1"></a>regularized_tune_result <span class="sc">%&gt;%</span> </span>
<span id="cb147-20"><a href="aprendizaje-supervisado-1.html#cb147-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">&quot;models/regularized_logistic_regression.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="aprendizaje-supervisado-1.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se carga el modelo</span></span>
<span id="cb148-2"><a href="aprendizaje-supervisado-1.html#cb148-2" aria-hidden="true" tabindex="-1"></a>regularized_tune_result <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;models/regularized_logistic_regression.rds&quot;</span>)</span>
<span id="cb148-3"><a href="aprendizaje-supervisado-1.html#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="aprendizaje-supervisado-1.html#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Métricas</span></span>
<span id="cb148-5"><a href="aprendizaje-supervisado-1.html#cb148-5" aria-hidden="true" tabindex="-1"></a>regularized_tune_result <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(.metrics)</span></code></pre></div>
<pre><code>## # A tibble: 4,500 × 10
##    splits             id      penalty mixture .metric .estimator .estimate
##    &lt;list&gt;             &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
##  1 &lt;split [4437/493]&gt; Fold01 1   e-10       0 roc_auc binary         0.777
##  2 &lt;split [4437/493]&gt; Fold01 7.20e-10       0 roc_auc binary         0.777
##  3 &lt;split [4437/493]&gt; Fold01 5.18e- 9       0 roc_auc binary         0.777
##  4 &lt;split [4437/493]&gt; Fold01 3.73e- 8       0 roc_auc binary         0.777
##  5 &lt;split [4437/493]&gt; Fold01 2.68e- 7       0 roc_auc binary         0.777
##  6 &lt;split [4437/493]&gt; Fold01 1.93e- 6       0 roc_auc binary         0.777
##  7 &lt;split [4437/493]&gt; Fold01 1.39e- 5       0 roc_auc binary         0.777
##  8 &lt;split [4437/493]&gt; Fold01 1   e- 4       0 roc_auc binary         0.777
##  9 &lt;split [4437/493]&gt; Fold01 7.20e- 4       0 roc_auc binary         0.777
## 10 &lt;split [4437/493]&gt; Fold01 5.18e- 3       0 roc_auc binary         0.777
## # … with 4,490 more rows, and 3 more variables: .config &lt;chr&gt;, .notes &lt;list&gt;,
## #   .predictions &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="aprendizaje-supervisado-1.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analizando las métricas de manera visual </span></span>
<span id="cb150-2"><a href="aprendizaje-supervisado-1.html#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="aprendizaje-supervisado-1.html#cb150-3" aria-hidden="true" tabindex="-1"></a>graf_prec <span class="ot">&lt;-</span> regularized_tune_result <span class="sc">%&gt;%</span> </span>
<span id="cb150-4"><a href="aprendizaje-supervisado-1.html#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(.metrics) <span class="sc">%&gt;%</span> </span>
<span id="cb150-5"><a href="aprendizaje-supervisado-1.html#cb150-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">&quot;pr_auc&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb150-6"><a href="aprendizaje-supervisado-1.html#cb150-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> penalty, <span class="at">y =</span> .estimate)) <span class="sc">+</span></span>
<span id="cb150-7"><a href="aprendizaje-supervisado-1.html#cb150-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb150-8"><a href="aprendizaje-supervisado-1.html#cb150-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> id))<span class="sc">+</span></span>
<span id="cb150-9"><a href="aprendizaje-supervisado-1.html#cb150-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb150-10"><a href="aprendizaje-supervisado-1.html#cb150-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Precisión: Penalización vs. PR AUC&#39;</span>)</span>
<span id="cb150-11"><a href="aprendizaje-supervisado-1.html#cb150-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-12"><a href="aprendizaje-supervisado-1.html#cb150-12" aria-hidden="true" tabindex="-1"></a>graf_prec</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-184-1.png" width="672" /></p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="aprendizaje-supervisado-1.html#cb151-1" aria-hidden="true" tabindex="-1"></a>graf_roc <span class="ot">&lt;-</span> regularized_tune_result <span class="sc">%&gt;%</span> </span>
<span id="cb151-2"><a href="aprendizaje-supervisado-1.html#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(.metrics) <span class="sc">%&gt;%</span> </span>
<span id="cb151-3"><a href="aprendizaje-supervisado-1.html#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">&quot;roc_auc&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb151-4"><a href="aprendizaje-supervisado-1.html#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> penalty, <span class="at">y =</span> .estimate)) <span class="sc">+</span></span>
<span id="cb151-5"><a href="aprendizaje-supervisado-1.html#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb151-6"><a href="aprendizaje-supervisado-1.html#cb151-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> id))<span class="sc">+</span></span>
<span id="cb151-7"><a href="aprendizaje-supervisado-1.html#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb151-8"><a href="aprendizaje-supervisado-1.html#cb151-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;AUC: Penalización vs. ROC AUC&#39;</span>)</span>
<span id="cb151-9"><a href="aprendizaje-supervisado-1.html#cb151-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-10"><a href="aprendizaje-supervisado-1.html#cb151-10" aria-hidden="true" tabindex="-1"></a>graf_roc</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-184-2.png" width="672" /></p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="aprendizaje-supervisado-1.html#cb152-1" aria-hidden="true" tabindex="-1"></a>regularized_tune_result <span class="sc">%&gt;%</span></span>
<span id="cb152-2"><a href="aprendizaje-supervisado-1.html#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb152-3"><a href="aprendizaje-supervisado-1.html#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mixture <span class="sc">==</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb152-4"><a href="aprendizaje-supervisado-1.html#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(penalty, mean, <span class="at">color =</span> .metric)) <span class="sc">+</span></span>
<span id="cb152-5"><a href="aprendizaje-supervisado-1.html#cb152-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(</span>
<span id="cb152-6"><a href="aprendizaje-supervisado-1.html#cb152-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> std_err, <span class="at">ymax =</span> mean <span class="sc">+</span> std_err),</span>
<span id="cb152-7"><a href="aprendizaje-supervisado-1.html#cb152-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb152-8"><a href="aprendizaje-supervisado-1.html#cb152-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb152-9"><a href="aprendizaje-supervisado-1.html#cb152-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb152-10"><a href="aprendizaje-supervisado-1.html#cb152-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>.metric, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb152-11"><a href="aprendizaje-supervisado-1.html#cb152-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb152-12"><a href="aprendizaje-supervisado-1.html#cb152-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-185-1.png" width="672" /></p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="aprendizaje-supervisado-1.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(regularized_tune_result)</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-185-2.png" width="672" /></p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="aprendizaje-supervisado-1.html#cb154-1" aria-hidden="true" tabindex="-1"></a>regularized_tune_result <span class="sc">%&gt;%</span> <span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb154-2"><a href="aprendizaje-supervisado-1.html#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.metric) <span class="sc">%&gt;%</span> </span>
<span id="cb154-3"><a href="aprendizaje-supervisado-1.html#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb154-4"><a href="aprendizaje-supervisado-1.html#cb154-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(mean),</span>
<span id="cb154-5"><a href="aprendizaje-supervisado-1.html#cb154-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(mean),</span>
<span id="cb154-6"><a href="aprendizaje-supervisado-1.html#cb154-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(mean),</span>
<span id="cb154-7"><a href="aprendizaje-supervisado-1.html#cb154-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(mean),</span>
<span id="cb154-8"><a href="aprendizaje-supervisado-1.html#cb154-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb154-9"><a href="aprendizaje-supervisado-1.html#cb154-9" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##   .metric   max   min  mean median
##   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1 pr_auc  0.912 0.868 0.900  0.900
## 2 roc_auc 0.800 0.5   0.728  0.728</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="aprendizaje-supervisado-1.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mejores 10 resultados para la métrica de precisión</span></span>
<span id="cb156-2"><a href="aprendizaje-supervisado-1.html#cb156-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-3"><a href="aprendizaje-supervisado-1.html#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(regularized_tune_result, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 8
##    penalty mixture .metric .estimator  mean     n std_err .config               
##      &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                 
##  1 0.0373    0.929 pr_auc  binary     0.912    10 0.00492 Preprocessor1_Model206
##  2 0.0373    0.857 pr_auc  binary     0.912    10 0.00494 Preprocessor1_Model191
##  3 0.0373    1     pr_auc  binary     0.912    10 0.00493 Preprocessor1_Model221
##  4 0.0373    0.786 pr_auc  binary     0.912    10 0.00496 Preprocessor1_Model176
##  5 0.0373    0.714 pr_auc  binary     0.911    10 0.00497 Preprocessor1_Model161
##  6 0.0373    0.643 pr_auc  binary     0.911    10 0.00497 Preprocessor1_Model146
##  7 0.0373    0.571 pr_auc  binary     0.911    10 0.00498 Preprocessor1_Model131
##  8 0.00518   1     pr_auc  binary     0.911    10 0.00501 Preprocessor1_Model220
##  9 0.00518   0.857 pr_auc  binary     0.911    10 0.00502 Preprocessor1_Model190
## 10 0.00518   0.929 pr_auc  binary     0.911    10 0.00501 Preprocessor1_Model205</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="aprendizaje-supervisado-1.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección del mejor modelo según la métrica de precisión</span></span>
<span id="cb158-2"><a href="aprendizaje-supervisado-1.html#cb158-2" aria-hidden="true" tabindex="-1"></a>best_regularized_logistic_model <span class="ot">&lt;-</span> <span class="fu">select_best</span>(regularized_tune_result, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>)</span>
<span id="cb158-3"><a href="aprendizaje-supervisado-1.html#cb158-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-4"><a href="aprendizaje-supervisado-1.html#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección del mejor modelo por un error estándar</span></span>
<span id="cb158-5"><a href="aprendizaje-supervisado-1.html#cb158-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-6"><a href="aprendizaje-supervisado-1.html#cb158-6" aria-hidden="true" tabindex="-1"></a>best_regularized_logistic_model_1se <span class="ot">&lt;-</span> <span class="fu">select_by_one_std_err</span>(</span>
<span id="cb158-7"><a href="aprendizaje-supervisado-1.html#cb158-7" aria-hidden="true" tabindex="-1"></a>  regularized_tune_result, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>, <span class="st">&quot;pr_auc&quot;</span>)</span>
<span id="cb158-8"><a href="aprendizaje-supervisado-1.html#cb158-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-9"><a href="aprendizaje-supervisado-1.html#cb158-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo final</span></span>
<span id="cb158-10"><a href="aprendizaje-supervisado-1.html#cb158-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-11"><a href="aprendizaje-supervisado-1.html#cb158-11" aria-hidden="true" tabindex="-1"></a>final_regularized_logistic_model <span class="ot">&lt;-</span> regularized_logistic_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb158-12"><a href="aprendizaje-supervisado-1.html#cb158-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(best_regularized_logistic_model_1se) <span class="sc">%&gt;%</span> </span>
<span id="cb158-13"><a href="aprendizaje-supervisado-1.html#cb158-13" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">data =</span> telco_train)</span>
<span id="cb158-14"><a href="aprendizaje-supervisado-1.html#cb158-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-15"><a href="aprendizaje-supervisado-1.html#cb158-15" aria-hidden="true" tabindex="-1"></a>final_regularized_logistic_model <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() </span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##   term           estimate      penalty
##   &lt;chr&gt;             &lt;dbl&gt;        &lt;dbl&gt;
## 1 (Intercept)      -1.23  0.0000000001
## 2 SeniorCitizen     0.234 0.0000000001
## 3 MonthlyCharges    1.12  0.0000000001
## 4 TotalCharges     -1.17  0.0000000001</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="aprendizaje-supervisado-1.html#cb160-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_regularized_logistic_model, telco_test, <span class="at">type =</span> <span class="st">&#39;prob&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb160-2"><a href="aprendizaje-supervisado-1.html#cb160-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(<span class="at">truth =</span>telco_test<span class="sc">$</span>Churn) <span class="sc">%&gt;%</span> </span>
<span id="cb160-3"><a href="aprendizaje-supervisado-1.html#cb160-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">truth =</span> <span class="fu">factor</span>(truth, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;No&#39;</span>, <span class="st">&#39;Yes&#39;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;No&#39;</span>, <span class="st">&#39;Yes&#39;</span>)))</span>
<span id="cb160-4"><a href="aprendizaje-supervisado-1.html#cb160-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-5"><a href="aprendizaje-supervisado-1.html#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    .pred_No .pred_Yes truth
##       &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;
##  1    0.808    0.192  No   
##  2    0.331    0.669  Yes  
##  3    0.835    0.165  No   
##  4    0.885    0.115  No   
##  5    0.919    0.0812 No   
##  6    0.548    0.452  No   
##  7    0.875    0.125  No   
##  8    0.869    0.131  No   
##  9    0.813    0.187  Yes  
## 10    0.925    0.0749 No</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="aprendizaje-supervisado-1.html#cb162-1" aria-hidden="true" tabindex="-1"></a>pr_curve_data <span class="ot">&lt;-</span> <span class="fu">pr_curve</span>(</span>
<span id="cb162-2"><a href="aprendizaje-supervisado-1.html#cb162-2" aria-hidden="true" tabindex="-1"></a>  results, </span>
<span id="cb162-3"><a href="aprendizaje-supervisado-1.html#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">truth =</span> truth, </span>
<span id="cb162-4"><a href="aprendizaje-supervisado-1.html#cb162-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> .pred_Yes, </span>
<span id="cb162-5"><a href="aprendizaje-supervisado-1.html#cb162-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">event_level =</span> <span class="st">&#39;second&#39;</span></span>
<span id="cb162-6"><a href="aprendizaje-supervisado-1.html#cb162-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb162-7"><a href="aprendizaje-supervisado-1.html#cb162-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-8"><a href="aprendizaje-supervisado-1.html#cb162-8" aria-hidden="true" tabindex="-1"></a>roc_curve_data <span class="ot">&lt;-</span> <span class="fu">roc_curve</span>(</span>
<span id="cb162-9"><a href="aprendizaje-supervisado-1.html#cb162-9" aria-hidden="true" tabindex="-1"></a>  results, </span>
<span id="cb162-10"><a href="aprendizaje-supervisado-1.html#cb162-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">truth =</span> truth, </span>
<span id="cb162-11"><a href="aprendizaje-supervisado-1.html#cb162-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> .pred_Yes, </span>
<span id="cb162-12"><a href="aprendizaje-supervisado-1.html#cb162-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">event_level =</span> <span class="st">&#39;second&#39;</span></span>
<span id="cb162-13"><a href="aprendizaje-supervisado-1.html#cb162-13" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="aprendizaje-supervisado-1.html#cb163-1" aria-hidden="true" tabindex="-1"></a>pr_curve_plot <span class="ot">&lt;-</span> pr_curve_data <span class="sc">%&gt;%</span> </span>
<span id="cb163-2"><a href="aprendizaje-supervisado-1.html#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> recall, <span class="at">y =</span> precision)) <span class="sc">+</span></span>
<span id="cb163-3"><a href="aprendizaje-supervisado-1.html#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&#39;lightblue&#39;</span>) <span class="sc">+</span></span>
<span id="cb163-4"><a href="aprendizaje-supervisado-1.html#cb163-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb163-5"><a href="aprendizaje-supervisado-1.html#cb163-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Precision vs Recall&quot;</span>)<span class="sc">+</span></span>
<span id="cb163-6"><a href="aprendizaje-supervisado-1.html#cb163-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb163-7"><a href="aprendizaje-supervisado-1.html#cb163-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-8"><a href="aprendizaje-supervisado-1.html#cb163-8" aria-hidden="true" tabindex="-1"></a>pr_curve_plot</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-192-1.png" width="672" /></p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="aprendizaje-supervisado-1.html#cb164-1" aria-hidden="true" tabindex="-1"></a>roc_curve_plot <span class="ot">&lt;-</span> roc_curve_data <span class="sc">%&gt;%</span> </span>
<span id="cb164-2"><a href="aprendizaje-supervisado-1.html#cb164-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span> <span class="sc">-</span> specificity, <span class="at">y =</span> sensitivity)) <span class="sc">+</span></span>
<span id="cb164-3"><a href="aprendizaje-supervisado-1.html#cb164-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&#39;lightblue&#39;</span>) <span class="sc">+</span></span>
<span id="cb164-4"><a href="aprendizaje-supervisado-1.html#cb164-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb164-5"><a href="aprendizaje-supervisado-1.html#cb164-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb164-6"><a href="aprendizaje-supervisado-1.html#cb164-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;ROC Curve&quot;</span>)<span class="sc">+</span></span>
<span id="cb164-7"><a href="aprendizaje-supervisado-1.html#cb164-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb164-8"><a href="aprendizaje-supervisado-1.html#cb164-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-9"><a href="aprendizaje-supervisado-1.html#cb164-9" aria-hidden="true" tabindex="-1"></a>roc_curve_plot</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-192-2.png" width="672" /></p>
<p>La curva Recall vs. Precision muestra la compensación entre precisión y recall para diferentes umbrales. Un área alta debajo de la curva representa tanto un alto recall como una alta precisión, donde la alta precisión se relaciona con una tasa baja de falsos positivos y recall alto se relaciona con una tasa baja de falsos negativos.</p>
<p>Por ejemplo, en caso de que queramos tener una sensibilidad al rededor de 0.75, inevitablemente se obtendrá una tasa de falsos positivos de 0.45.</p>
<p>Una curva ROC es un gráfico que muestra el rendimiento de un modelo de clasificación en todos los umbrales de clasificación. Esta curva traza dos parámetros:</p>
<ul>
<li><p>Tasa de verdaderos positivos:</p>
<p><span class="math display">\[TPR=\frac{TP}{TP + FN}\]</span></p></li>
<li><p>Tasa de falsos positivos:</p>
<p><span class="math display">\[FPR = \frac{FP}{FP + TN}\]</span></p></li>
</ul>
<p>Una curva <em>ROC</em> traza <em>TPR</em> frente a <em>FPR</em> en diferentes umbrales de clasificación. Si se reduce el umbral de clasificación, se clasifican más elementos como positivos, lo que aumenta tanto los falsos positivos como los verdaderos positivos.</p>
<p>Por ejemplo, si queremos tener una precisión de 0.80, la cobertura será apenas de 0.125 del total de positivos.</p>
</div>
</div>
<div id="k-nearest-neighbor" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> K-Nearest-Neighbor</h2>
<p>KNN es un algoritmo de aprendizaje supervisado que podemos usar tanto para regresión como clasificación. Es un algoritmo fácil de interpretar y que permite ser flexible en el balance entre sesgo y varianza (dependiendo de los hiper-parámetros seleccionados).</p>
<p>El algoritmo de K vecinos más cercanos realiza comparaciones entre un nuevo elemento y las observaciones anteriores que ya cuentan con etiqueta. La esencia de este algoritmo está en <strong>etiquetar a un nuevo elemento de manera similar a como están etiquetados aquellos <em>K</em> elementos que más se le parecen</strong>. Veremos este proceso para cada uno de los posibles casos:</p>
<div id="clasificación-2" class="section level3" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Clasificación</h3>
<p>La idea detrás del algoritmo es sencilla, eletiqueta una nueva observación en la categoria que tenga mas elementos de las <em>k</em> observaciones más cercanas, es decir:</p>
<ol style="list-style-type: decimal">
<li><p>Seleccionamos el hiper-parámetro <em>K</em> como el número elegido de vecinos.</p></li>
<li><p>Se calculará la similitud (distancia) de esta nueva observación a cada observación existente.</p></li>
<li><p>Ordenaremos estas distancias de menor a mayor.</p></li>
<li><p>Tomamos las <em>K</em> primeras entradas de la lista ordenada.</p></li>
<li><p>La nueva observación será asignada al grupo que tenga mayor número de observaciones en estas <em>k</em> primeras distancias (asignación por moda)</p></li>
</ol>
<p>A continuación se ejemplifica este proceso:</p>
<p><img src="img/05-sup/knn/3-10-1-knn-clasificacion.png" width="500pt" height="400pt" style="display: block; margin: auto;" /></p>
<p><img src="img/05-sup/knn/20_1_classification_knn.png" width="250pt" height="300pt" /><img src="img/05-sup/knn/20_2_classification_knn.png" width="250pt" height="300pt" /><img src="img/05-sup/knn/20_3_classification_knn.png" width="250pt" height="300pt" /></p>
<p><strong>Ejemplo:</strong></p>
<p><img src="img/05-sup/knn/3-10-1-knn-clasificacion2.png" width="700pt" height="500pt" style="display: block; margin: auto;" /></p>
<blockquote>
<p>Otro método que permite tener mayor control sobre las clasificaciones es asignar la probabilidad de pertenencia a cada clase de acuerdo con la proporción existente de cada una de las mismas. A partir de dichas probabilidades, el usuario puede determinar el punto de corte que sea más conveniente para el problema a resolver.</p>
</blockquote>
</div>
<div id="regresión-1" class="section level3" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Regresión</h3>
<p>En el caso de regresión, la eletiqueta de una nueva observación se realiza a través del promedio del valor en las <em>k</em> observaciones más cercanas, es decir:</p>
<ol style="list-style-type: decimal">
<li><p>Seleccionamos el hiper-parámetro <em>K</em> como el número elegido de vecinos.</p></li>
<li><p>Se calculará la similitud (distancia) de esta nueva observación a cada observación existente</p></li>
<li><p>Ordenaremos estas distancias de menor a mayor</p></li>
<li><p>Tomamos las <em>K</em> primeras entradas de la lista ordenada.</p></li>
<li><p>La nueva observación será etiquetada mediante el promedio del valor de las observaciones en estas <em>k</em> primeras distancias.</p></li>
</ol>
<p>Considerando un modelo de 3 vecinos más cercanos, las siguientes imágenes muestran el proceso de ajuste y predicción de nuevas observaciones.</p>
<p><img src="img/05-sup/knn/3-10-1-regression1.png" width="250pt" height="280pt" /><img src="img/05-sup/knn/3-10-1-regression2.png" width="250pt" height="280pt" /><img src="img/05-sup/knn/3-10-1-regression3.png" width="250pt" height="280pt" /></p>
<p><strong>Ejemplo de balance de sesgo y varianza</strong></p>
<p><img src="img/05-sup/knn/3-10-1-knn-regresion2.png" width="700pt" height="500pt" style="display: block; margin: auto;" /></p>
</div>
<div id="ajuste-del-modelo-1" class="section level3" number="5.5.3">
<h3><span class="header-section-number">5.5.3</span> Ajuste del modelo</h3>
<p>En contraste con otros algoritmos de aprendizaje supervisado, K-NN no genera un modelo del aprendizaje con datos de entrenamiento, sino que el aprendizaje sucede en el mismo momento en el que se prueban los datos de prueba. A este tipo de algoritmos se les llama <em>lazy learning methods</em> porque no aprende del conjunto de entrenamiento inmediatamente, sino que almacena el conjunto de datos y, en el momento de la clasificación, realiza una acción en el conjunto de datos.</p>
<p>El algoritmo KNN en la fase de entrenamiento simplemente almacena el conjunto de datos y cuando obtiene nuevos datos, clasifica esos datos en una categoría que es muy similar a los nuevos datos.</p>
<div id="selección-de-hiper-parámetro-k" class="section level4" number="5.5.3.1">
<h4><span class="header-section-number">5.5.3.1</span> Selección de Hiper-parámetro K</h4>
<p>Al configurar un modelo KNN, sólo hay algunos parámetros que deben elegirse/ajustarse para mejorar el rendimiento, uno de estos parámetros es el valor de la K.</p>
<p>No existe una forma particular de determinar el mejor valor para “K,” por lo que debemos probar algunos valores para encontrar “el mejor” de ellos.</p>
<p>Para los modelos de clasificación, especialmente si solo hay dos clases, generalmente se elige un número impar para k. Esto es para que el algoritmo nunca llegue a un “empate”</p>
<p>Una opción para seleccionar la K adecuada es ejecutar el algoritmo KNN varias veces con diferentes valores de K y elegimos la K que reduce la cantidad de errores mientras se mantiene la capacidad del algoritmo para hacer predicciones con precisión.</p>
<p>Observemos lo siguiente:</p>
<p><img src="img/05-sup/knn/3-10-1-kerror2.png" width="500pt" height="300pt" style="display: block; margin: auto;" /></p>
<p>Estas gráficas se conoce como “gráfica de codo” y generalmente se usan para determinar el valor K.</p>
<ul>
<li><p>A medida que disminuimos el valor de K a 1, nuestras predicciones se vuelven menos estables. Imaginemos que tomamos K = 1 y tenemos un punto de consulta rodeado por varios rojos y uno verde, pero el verde es el vecino más cercano. Razonablemente, pensaríamos que el punto de consulta es probablemente rojo, pero como K = 1, KNN predice incorrectamente que el punto de consulta es verde.</p></li>
<li><p>Inversamente, a medida que aumentamos el valor de K, nuestras predicciones se vuelven más estables debido a que tenemos más observaciones con quienes comparar, por lo tanto, es más probable que hagan predicciones más precisas. Eventualmente, comenzamos a presenciar un número creciente de errores, es en este punto que sabemos que hemos llevado el valor de K demasiado lejos.</p></li>
</ul>
</div>
<div id="métodos-de-cálculo-de-la-distancia-entre-observaciones" class="section level4" number="5.5.3.2">
<h4><span class="header-section-number">5.5.3.2</span> Métodos de cálculo de la distancia entre observaciones</h4>
<p>Otro parámetro que podemos ajustar para el modelo es la distancia usada, existen diferentes formas de medir qué tan “cerca” están dos puntos entre sí, y las diferencias entre estos métodos pueden volverse significativas en dimensiones superiores.</p>
<ul>
<li>La más utilizada es la distancia euclidiana, el tipo estándar de distancia.</li>
</ul>
<p><span class="math display">\[d(X,Y) = \sqrt{\sum_{i=1}^{n} (x_i-y_i)^2}\]</span></p>
<ul>
<li>Otra métrica es la llamada distancia de Manhattan, que mide la distancia tomada en cada dirección cardinal, en lugar de a lo largo de la diagonal.</li>
</ul>
<p><span class="math display">\[d(X,Y) = \sum_{i=1}^{n} |x_i - y_i|\]</span></p>
<ul>
<li>De manera más general, las anteriores son casos particulares de la distancia de Minkowski, cuya fórmula es:</li>
</ul>
<p><span class="math display">\[d(X,Y) = (\sum_{i=1}^{n} |x_i-y_i|^p)^{\frac{1}{p}}\]</span></p>
<ul>
<li>La distancia de coseno es ampliamente en análisis de texto, sistemas de recomendación</li>
</ul>
<p><span class="math display">\[d(X,Y)= 1 - \frac{\sum_{i=1}^{n}{X_iY_i}}{\sqrt{\sum_{i=1}^{n}{X_i^2}}\sqrt{\sum_{i=1}^{n}{Y_i^2}}}\]</span></p>
<p><img src="img/05-sup/knn/similitudes.png" width="700pt" height="700pt" style="display: block; margin: auto;" /></p>
<ul>
<li><p><a href="https://towardsdatascience.com/17-types-of-similarity-and-dissimilarity-measures-used-in-data-science-3eb914d2681">Un link interesante</a></p></li>
<li><p><a href="https://www.maartengrootendorst.com/blog/distances/">Otro link interesante</a></p></li>
</ul>
</div>
</div>
<div id="implementación-en-r-2" class="section level3" number="5.5.4">
<h3><span class="header-section-number">5.5.4</span> Implementación en R</h3>
<p>Usaremos las recetas antes implementadas para ajustar tanto el modelo de regresión como el de clasificación. Exploraremos un conjunto de hiperparámetros para elegir el mejor modelo.</p>
<div id="regresión-2" class="section level4" number="5.5.4.1">
<h4><span class="header-section-number">5.5.4.1</span> Regresión</h4>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="aprendizaje-supervisado-1.html#cb165-1" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">nearest_neighbor</span>(</span>
<span id="cb165-2"><a href="aprendizaje-supervisado-1.html#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">&quot;regression&quot;</span>,</span>
<span id="cb165-3"><a href="aprendizaje-supervisado-1.html#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">neighbors =</span> <span class="fu">tune</span>(<span class="st">&quot;K&quot;</span>),</span>
<span id="cb165-4"><a href="aprendizaje-supervisado-1.html#cb165-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight_func =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb165-5"><a href="aprendizaje-supervisado-1.html#cb165-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;kknn&quot;</span>)</span>
<span id="cb165-6"><a href="aprendizaje-supervisado-1.html#cb165-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-7"><a href="aprendizaje-supervisado-1.html#cb165-7" aria-hidden="true" tabindex="-1"></a>knn_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb165-8"><a href="aprendizaje-supervisado-1.html#cb165-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(receta_casas) <span class="sc">%&gt;%</span> </span>
<span id="cb165-9"><a href="aprendizaje-supervisado-1.html#cb165-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(knn_model)</span>
<span id="cb165-10"><a href="aprendizaje-supervisado-1.html#cb165-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-11"><a href="aprendizaje-supervisado-1.html#cb165-11" aria-hidden="true" tabindex="-1"></a>knn_parameters_set <span class="ot">&lt;-</span> <span class="fu">parameters</span>(knn_workflow) <span class="sc">%&gt;%</span> </span>
<span id="cb165-12"><a href="aprendizaje-supervisado-1.html#cb165-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(<span class="at">K =</span> dials<span class="sc">::</span><span class="fu">neighbors</span>(<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">80</span>)),</span>
<span id="cb165-13"><a href="aprendizaje-supervisado-1.html#cb165-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">weight_func =</span> <span class="fu">weight_func</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;rectangular&quot;</span>, <span class="st">&quot;inv&quot;</span>, <span class="st">&quot;gaussian&quot;</span>, <span class="st">&quot;cos&quot;</span>))</span>
<span id="cb165-14"><a href="aprendizaje-supervisado-1.html#cb165-14" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb165-15"><a href="aprendizaje-supervisado-1.html#cb165-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-16"><a href="aprendizaje-supervisado-1.html#cb165-16" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb165-17"><a href="aprendizaje-supervisado-1.html#cb165-17" aria-hidden="true" tabindex="-1"></a>knn_grid <span class="ot">&lt;-</span> knn_parameters_set <span class="sc">%&gt;%</span> </span>
<span id="cb165-18"><a href="aprendizaje-supervisado-1.html#cb165-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid_max_entropy</span>(<span class="at">size =</span> <span class="dv">150</span>)</span>
<span id="cb165-19"><a href="aprendizaje-supervisado-1.html#cb165-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-20"><a href="aprendizaje-supervisado-1.html#cb165-20" aria-hidden="true" tabindex="-1"></a>ctrl_grid <span class="ot">&lt;-</span> <span class="fu">control_grid</span>(<span class="at">save_pred =</span> T, <span class="at">verbose =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="aprendizaje-supervisado-1.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb166-2"><a href="aprendizaje-supervisado-1.html#cb166-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-3"><a href="aprendizaje-supervisado-1.html#cb166-3" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb166-4"><a href="aprendizaje-supervisado-1.html#cb166-4" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb166-5"><a href="aprendizaje-supervisado-1.html#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb166-6"><a href="aprendizaje-supervisado-1.html#cb166-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-7"><a href="aprendizaje-supervisado-1.html#cb166-7" aria-hidden="true" tabindex="-1"></a>casas_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(ames_train)</span>
<span id="cb166-8"><a href="aprendizaje-supervisado-1.html#cb166-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-9"><a href="aprendizaje-supervisado-1.html#cb166-9" aria-hidden="true" tabindex="-1"></a>knnt1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb166-10"><a href="aprendizaje-supervisado-1.html#cb166-10" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb166-11"><a href="aprendizaje-supervisado-1.html#cb166-11" aria-hidden="true" tabindex="-1"></a>  knn_workflow,</span>
<span id="cb166-12"><a href="aprendizaje-supervisado-1.html#cb166-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> casas_folds,</span>
<span id="cb166-13"><a href="aprendizaje-supervisado-1.html#cb166-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> knn_grid,</span>
<span id="cb166-14"><a href="aprendizaje-supervisado-1.html#cb166-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae, mape),</span>
<span id="cb166-15"><a href="aprendizaje-supervisado-1.html#cb166-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> ctrl_grid</span>
<span id="cb166-16"><a href="aprendizaje-supervisado-1.html#cb166-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb166-17"><a href="aprendizaje-supervisado-1.html#cb166-17" aria-hidden="true" tabindex="-1"></a>knnt2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>(); knnt2 <span class="sc">-</span> knnt1</span>
<span id="cb166-18"><a href="aprendizaje-supervisado-1.html#cb166-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-19"><a href="aprendizaje-supervisado-1.html#cb166-19" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb166-20"><a href="aprendizaje-supervisado-1.html#cb166-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-21"><a href="aprendizaje-supervisado-1.html#cb166-21" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="sc">%&gt;%</span> <span class="fu">saveRDS</span>(<span class="st">&quot;models/knn_model_reg.rds&quot;</span>)</span></code></pre></div>
<p>Podemos obtener las métricas de cada <em>fold</em> con el siguiente código:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="aprendizaje-supervisado-1.html#cb167-1" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;models/knn_model_reg.rds&quot;</span>)</span>
<span id="cb167-2"><a href="aprendizaje-supervisado-1.html#cb167-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-3"><a href="aprendizaje-supervisado-1.html#cb167-3" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(.metrics)</span></code></pre></div>
<pre><code>## # A tibble: 3,660 × 10
##    splits             id         K weight_func .metric .estimator .estimate
##    &lt;list&gt;             &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
##  1 &lt;split [1845/206]&gt; Fold01    11 cos         rmse    standard       0.246
##  2 &lt;split [1845/206]&gt; Fold01    12 cos         rmse    standard       0.245
##  3 &lt;split [1845/206]&gt; Fold01    22 cos         rmse    standard       0.247
##  4 &lt;split [1845/206]&gt; Fold01    27 cos         rmse    standard       0.248
##  5 &lt;split [1845/206]&gt; Fold01    28 cos         rmse    standard       0.248
##  6 &lt;split [1845/206]&gt; Fold01    30 cos         rmse    standard       0.248
##  7 &lt;split [1845/206]&gt; Fold01    33 cos         rmse    standard       0.249
##  8 &lt;split [1845/206]&gt; Fold01    35 cos         rmse    standard       0.249
##  9 &lt;split [1845/206]&gt; Fold01    37 cos         rmse    standard       0.249
## 10 &lt;split [1845/206]&gt; Fold01    39 cos         rmse    standard       0.249
## # … with 3,650 more rows, and 3 more variables: .config &lt;chr&gt;, .notes &lt;list&gt;,
## #   .predictions &lt;list&gt;</code></pre>
<p>En la siguiente gráfica observamos el error cuadrático medio de las distintas métricas con distintos números de vecinos.</p>
<p>En los argumentos de la funcion, se puede seleccionar el kernel, esto es las opciones posibles para ponderar el promedio respecto a la distancia seleccinada. “Rectangular” (que es knn estándar no ponderado), “triangular,” “cos,” “inv,” “gaussiano,” “rango” y “óptimo.”</p>
<p>Para conocer más a cerca de las distintas métricas de distancia pueden consultar:
<a href="https://towardsdatascience.com/9-distance-measures-in-data-science-918109d069fa">Measures</a> y <a href="https://rdrr.io/cran/kknn/man/kknn.html">KNN function</a></p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="aprendizaje-supervisado-1.html#cb169-1" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="sc">%&gt;%</span> </span>
<span id="cb169-2"><a href="aprendizaje-supervisado-1.html#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-203-1.png" width="672" /></p>
<p>En la siguiente gráfica observamos el error absoluto promedio de las distintas métricas con distintos números de vecinos.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="aprendizaje-supervisado-1.html#cb170-1" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="sc">%&gt;%</span> </span>
<span id="cb170-2"><a href="aprendizaje-supervisado-1.html#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(<span class="at">metric =</span> <span class="st">&quot;mae&quot;</span>)</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-204-1.png" width="672" /></p>
<p>Con el siguiente código obtenemos los mejores 10 modelos respecto al <em>rmse</em>.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="aprendizaje-supervisado-1.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(knn_tune_result, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 8
##        K weight_func .metric .estimator  mean     n std_err .config             
##    &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
##  1    12 cos         rmse    standard   0.203    10 0.00892 Preprocessor1_Model…
##  2    22 cos         rmse    standard   0.203    10 0.00887 Preprocessor1_Model…
##  3    11 cos         rmse    standard   0.203    10 0.00885 Preprocessor1_Model…
##  4    27 cos         rmse    standard   0.204    10 0.00887 Preprocessor1_Model…
##  5    28 cos         rmse    standard   0.204    10 0.00890 Preprocessor1_Model…
##  6    30 cos         rmse    standard   0.204    10 0.00888 Preprocessor1_Model…
##  7    13 gaussian    rmse    standard   0.204    10 0.00873 Preprocessor1_Model…
##  8    15 gaussian    rmse    standard   0.205    10 0.00868 Preprocessor1_Model…
##  9    11 gaussian    rmse    standard   0.205    10 0.00855 Preprocessor1_Model…
## 10    33 cos         rmse    standard   0.205    10 0.00890 Preprocessor1_Model…</code></pre>
<p>Ahora obtendremos el modelo que mejor desempeño tiene tomando en cuenta el <em>rmse</em> y haremos las predicciones del conjunto de prueba con este modelo.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="aprendizaje-supervisado-1.html#cb173-1" aria-hidden="true" tabindex="-1"></a>best_knn_model_reg <span class="ot">&lt;-</span> <span class="fu">select_best</span>(knn_tune_result, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span>
<span id="cb173-2"><a href="aprendizaje-supervisado-1.html#cb173-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-3"><a href="aprendizaje-supervisado-1.html#cb173-3" aria-hidden="true" tabindex="-1"></a>final_knn_model_reg <span class="ot">&lt;-</span> knn_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb173-4"><a href="aprendizaje-supervisado-1.html#cb173-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(best_knn_model_reg) <span class="sc">%&gt;%</span> </span>
<span id="cb173-5"><a href="aprendizaje-supervisado-1.html#cb173-5" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">data =</span> ames_train)</span>
<span id="cb173-6"><a href="aprendizaje-supervisado-1.html#cb173-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-7"><a href="aprendizaje-supervisado-1.html#cb173-7" aria-hidden="true" tabindex="-1"></a>results_reg <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_knn_model_reg, ames_test) <span class="sc">%&gt;%</span> </span>
<span id="cb173-8"><a href="aprendizaje-supervisado-1.html#cb173-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(<span class="at">truth =</span> ames_test<span class="sc">$</span>Sale_Price) <span class="sc">%&gt;%</span> </span>
<span id="cb173-9"><a href="aprendizaje-supervisado-1.html#cb173-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.pred =</span> <span class="fu">exp</span>(.pred) )</span></code></pre></div>
<p><strong>Métricas de desempeño</strong></p>
<p>Ahora para calcular las métricas de desempeño usaremos la paqueteria <em>MLmetrics</em></p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="aprendizaje-supervisado-1.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MLmetrics)</span>
<span id="cb174-2"><a href="aprendizaje-supervisado-1.html#cb174-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-3"><a href="aprendizaje-supervisado-1.html#cb174-3" aria-hidden="true" tabindex="-1"></a>results_reg <span class="sc">%&gt;%</span> </span>
<span id="cb174-4"><a href="aprendizaje-supervisado-1.html#cb174-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb174-5"><a href="aprendizaje-supervisado-1.html#cb174-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mae =</span> MLmetrics<span class="sc">::</span><span class="fu">MAE</span>(.pred, truth),</span>
<span id="cb174-6"><a href="aprendizaje-supervisado-1.html#cb174-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mape =</span> MLmetrics<span class="sc">::</span><span class="fu">MAPE</span>(.pred, truth),</span>
<span id="cb174-7"><a href="aprendizaje-supervisado-1.html#cb174-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse =</span> MLmetrics<span class="sc">::</span><span class="fu">RMSE</span>(.pred, truth),</span>
<span id="cb174-8"><a href="aprendizaje-supervisado-1.html#cb174-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">r2 =</span> MLmetrics<span class="sc">::</span><span class="fu">R2_Score</span>(.pred, truth),</span>
<span id="cb174-9"><a href="aprendizaje-supervisado-1.html#cb174-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmsle =</span> MLmetrics<span class="sc">::</span><span class="fu">RMSLE</span>(.pred, truth)</span>
<span id="cb174-10"><a href="aprendizaje-supervisado-1.html#cb174-10" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##      mae  mape   rmse    r2 rmsle
##    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 25772. 0.146 40840. 0.743 0.209</code></pre>
</div>
<div id="clasificación-3" class="section level4" number="5.5.4.2">
<h4><span class="header-section-number">5.5.4.2</span> Clasificación</h4>
<p>Repetiremos el proceso para el problema de clasificación.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="aprendizaje-supervisado-1.html#cb176-1" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">nearest_neighbor</span>(</span>
<span id="cb176-2"><a href="aprendizaje-supervisado-1.html#cb176-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">&quot;classification&quot;</span>,</span>
<span id="cb176-3"><a href="aprendizaje-supervisado-1.html#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">neighbors =</span> <span class="fu">tune</span>(<span class="st">&quot;K&quot;</span>),</span>
<span id="cb176-4"><a href="aprendizaje-supervisado-1.html#cb176-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight_func =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb176-5"><a href="aprendizaje-supervisado-1.html#cb176-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;kknn&quot;</span>)</span>
<span id="cb176-6"><a href="aprendizaje-supervisado-1.html#cb176-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-7"><a href="aprendizaje-supervisado-1.html#cb176-7" aria-hidden="true" tabindex="-1"></a>knn_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb176-8"><a href="aprendizaje-supervisado-1.html#cb176-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(telco_rec) <span class="sc">%&gt;%</span> </span>
<span id="cb176-9"><a href="aprendizaje-supervisado-1.html#cb176-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(knn_model)</span>
<span id="cb176-10"><a href="aprendizaje-supervisado-1.html#cb176-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-11"><a href="aprendizaje-supervisado-1.html#cb176-11" aria-hidden="true" tabindex="-1"></a>knn_parameters_set <span class="ot">&lt;-</span> <span class="fu">parameters</span>(knn_workflow) <span class="sc">%&gt;%</span> </span>
<span id="cb176-12"><a href="aprendizaje-supervisado-1.html#cb176-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(<span class="at">K =</span> dials<span class="sc">::</span><span class="fu">neighbors</span>(<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">80</span>)),</span>
<span id="cb176-13"><a href="aprendizaje-supervisado-1.html#cb176-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">weight_func =</span> <span class="fu">weight_func</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;rectangular&quot;</span>, <span class="st">&quot;inv&quot;</span>, <span class="st">&quot;gaussian&quot;</span>, <span class="st">&quot;cos&quot;</span>))</span>
<span id="cb176-14"><a href="aprendizaje-supervisado-1.html#cb176-14" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb176-15"><a href="aprendizaje-supervisado-1.html#cb176-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-16"><a href="aprendizaje-supervisado-1.html#cb176-16" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb176-17"><a href="aprendizaje-supervisado-1.html#cb176-17" aria-hidden="true" tabindex="-1"></a>knn_grid <span class="ot">&lt;-</span> knn_parameters_set <span class="sc">%&gt;%</span> </span>
<span id="cb176-18"><a href="aprendizaje-supervisado-1.html#cb176-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid_max_entropy</span>(<span class="at">size =</span> <span class="dv">150</span>)</span>
<span id="cb176-19"><a href="aprendizaje-supervisado-1.html#cb176-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-20"><a href="aprendizaje-supervisado-1.html#cb176-20" aria-hidden="true" tabindex="-1"></a>ctrl_grid <span class="ot">&lt;-</span> <span class="fu">control_grid</span>(<span class="at">save_pred =</span> T, <span class="at">verbose =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="aprendizaje-supervisado-1.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb177-2"><a href="aprendizaje-supervisado-1.html#cb177-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-3"><a href="aprendizaje-supervisado-1.html#cb177-3" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb177-4"><a href="aprendizaje-supervisado-1.html#cb177-4" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb177-5"><a href="aprendizaje-supervisado-1.html#cb177-5" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb177-6"><a href="aprendizaje-supervisado-1.html#cb177-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-7"><a href="aprendizaje-supervisado-1.html#cb177-7" aria-hidden="true" tabindex="-1"></a>telco_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(telco_train)</span>
<span id="cb177-8"><a href="aprendizaje-supervisado-1.html#cb177-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-9"><a href="aprendizaje-supervisado-1.html#cb177-9" aria-hidden="true" tabindex="-1"></a>knnt1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb177-10"><a href="aprendizaje-supervisado-1.html#cb177-10" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb177-11"><a href="aprendizaje-supervisado-1.html#cb177-11" aria-hidden="true" tabindex="-1"></a>  knn_workflow,</span>
<span id="cb177-12"><a href="aprendizaje-supervisado-1.html#cb177-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> telco_folds,</span>
<span id="cb177-13"><a href="aprendizaje-supervisado-1.html#cb177-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> knn_grid,</span>
<span id="cb177-14"><a href="aprendizaje-supervisado-1.html#cb177-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(roc_auc, pr_auc, sens),</span>
<span id="cb177-15"><a href="aprendizaje-supervisado-1.html#cb177-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> ctrl_grid</span>
<span id="cb177-16"><a href="aprendizaje-supervisado-1.html#cb177-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb177-17"><a href="aprendizaje-supervisado-1.html#cb177-17" aria-hidden="true" tabindex="-1"></a>knnt2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>(); knnt2 <span class="sc">-</span> knnt1</span>
<span id="cb177-18"><a href="aprendizaje-supervisado-1.html#cb177-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-19"><a href="aprendizaje-supervisado-1.html#cb177-19" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb177-20"><a href="aprendizaje-supervisado-1.html#cb177-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-21"><a href="aprendizaje-supervisado-1.html#cb177-21" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="sc">%&gt;%</span> <span class="fu">saveRDS</span>(<span class="st">&quot;models/knn_model_cla.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="aprendizaje-supervisado-1.html#cb178-1" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;models/knn_model_cla.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="aprendizaje-supervisado-1.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(knn_tune_result, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>)</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-211-1.png" width="672" /></p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="aprendizaje-supervisado-1.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(knn_tune_result, <span class="at">metric =</span> <span class="st">&quot;roc_auc&quot;</span>)</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-212-1.png" width="672" /></p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="aprendizaje-supervisado-1.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(knn_tune_result, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 8
##        K weight_func .metric .estimator  mean     n std_err .config             
##    &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
##  1    79 gaussian    pr_auc  binary     0.925    10 0.00268 Preprocessor1_Model…
##  2    78 gaussian    pr_auc  binary     0.925    10 0.00270 Preprocessor1_Model…
##  3    71 gaussian    pr_auc  binary     0.924    10 0.00276 Preprocessor1_Model…
##  4    74 gaussian    pr_auc  binary     0.924    10 0.00275 Preprocessor1_Model…
##  5    79 cos         pr_auc  binary     0.924    10 0.00272 Preprocessor1_Model…
##  6    77 cos         pr_auc  binary     0.924    10 0.00274 Preprocessor1_Model…
##  7    73 gaussian    pr_auc  binary     0.924    10 0.00276 Preprocessor1_Model…
##  8    67 gaussian    pr_auc  binary     0.924    10 0.00280 Preprocessor1_Model…
##  9    66 gaussian    pr_auc  binary     0.924    10 0.00281 Preprocessor1_Model…
## 10    68 cos         pr_auc  binary     0.924    10 0.00278 Preprocessor1_Model…</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="aprendizaje-supervisado-1.html#cb183-1" aria-hidden="true" tabindex="-1"></a>best_knn_model_cla <span class="ot">&lt;-</span> <span class="fu">select_best</span>(knn_tune_result, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>)</span>
<span id="cb183-2"><a href="aprendizaje-supervisado-1.html#cb183-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-3"><a href="aprendizaje-supervisado-1.html#cb183-3" aria-hidden="true" tabindex="-1"></a>final_knn_model_cla <span class="ot">&lt;-</span> knn_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb183-4"><a href="aprendizaje-supervisado-1.html#cb183-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(best_knn_model_cla) <span class="sc">%&gt;%</span> </span>
<span id="cb183-5"><a href="aprendizaje-supervisado-1.html#cb183-5" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">data =</span> telco_train)</span>
<span id="cb183-6"><a href="aprendizaje-supervisado-1.html#cb183-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-7"><a href="aprendizaje-supervisado-1.html#cb183-7" aria-hidden="true" tabindex="-1"></a>results_cla <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_knn_model_cla, telco_test, <span class="at">type =</span> <span class="st">&#39;prob&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb183-8"><a href="aprendizaje-supervisado-1.html#cb183-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(<span class="at">truth =</span>telco_test<span class="sc">$</span>Churn) <span class="sc">%&gt;%</span> </span>
<span id="cb183-9"><a href="aprendizaje-supervisado-1.html#cb183-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">truth =</span> <span class="fu">factor</span>(truth, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;No&#39;</span>, <span class="st">&#39;Yes&#39;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;No&#39;</span>, <span class="st">&#39;Yes&#39;</span>)))</span>
<span id="cb183-10"><a href="aprendizaje-supervisado-1.html#cb183-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-11"><a href="aprendizaje-supervisado-1.html#cb183-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results_cla, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    .pred_No .pred_Yes truth
##       &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;
##  1    0.887    0.113  No   
##  2    0.290    0.710  Yes  
##  3    0.750    0.250  No   
##  4    0.933    0.0669 No   
##  5    0.857    0.143  No   
##  6    0.554    0.446  No   
##  7    0.950    0.0498 No   
##  8    0.846    0.154  No   
##  9    0.665    0.335  Yes  
## 10    0.982    0.0182 No</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="aprendizaje-supervisado-1.html#cb185-1" aria-hidden="true" tabindex="-1"></a>pr_curve_data <span class="ot">&lt;-</span> <span class="fu">pr_curve</span>(</span>
<span id="cb185-2"><a href="aprendizaje-supervisado-1.html#cb185-2" aria-hidden="true" tabindex="-1"></a>  results_cla, </span>
<span id="cb185-3"><a href="aprendizaje-supervisado-1.html#cb185-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">truth =</span> truth, </span>
<span id="cb185-4"><a href="aprendizaje-supervisado-1.html#cb185-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> .pred_Yes, </span>
<span id="cb185-5"><a href="aprendizaje-supervisado-1.html#cb185-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">event_level =</span> <span class="st">&#39;second&#39;</span></span>
<span id="cb185-6"><a href="aprendizaje-supervisado-1.html#cb185-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb185-7"><a href="aprendizaje-supervisado-1.html#cb185-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-8"><a href="aprendizaje-supervisado-1.html#cb185-8" aria-hidden="true" tabindex="-1"></a>roc_curve_data <span class="ot">&lt;-</span> <span class="fu">roc_curve</span>(</span>
<span id="cb185-9"><a href="aprendizaje-supervisado-1.html#cb185-9" aria-hidden="true" tabindex="-1"></a>  results_cla, </span>
<span id="cb185-10"><a href="aprendizaje-supervisado-1.html#cb185-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">truth =</span> truth, </span>
<span id="cb185-11"><a href="aprendizaje-supervisado-1.html#cb185-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> .pred_Yes, </span>
<span id="cb185-12"><a href="aprendizaje-supervisado-1.html#cb185-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">event_level =</span> <span class="st">&#39;second&#39;</span></span>
<span id="cb185-13"><a href="aprendizaje-supervisado-1.html#cb185-13" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="aprendizaje-supervisado-1.html#cb186-1" aria-hidden="true" tabindex="-1"></a>pr_curve_plot <span class="ot">&lt;-</span> pr_curve_data <span class="sc">%&gt;%</span> </span>
<span id="cb186-2"><a href="aprendizaje-supervisado-1.html#cb186-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> recall, <span class="at">y =</span> precision)) <span class="sc">+</span></span>
<span id="cb186-3"><a href="aprendizaje-supervisado-1.html#cb186-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&#39;lightblue&#39;</span>) <span class="sc">+</span></span>
<span id="cb186-4"><a href="aprendizaje-supervisado-1.html#cb186-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb186-5"><a href="aprendizaje-supervisado-1.html#cb186-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Precision vs Recall&quot;</span>)<span class="sc">+</span></span>
<span id="cb186-6"><a href="aprendizaje-supervisado-1.html#cb186-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb186-7"><a href="aprendizaje-supervisado-1.html#cb186-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-8"><a href="aprendizaje-supervisado-1.html#cb186-8" aria-hidden="true" tabindex="-1"></a>pr_curve_plot</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-217-1.png" width="672" /></p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="aprendizaje-supervisado-1.html#cb187-1" aria-hidden="true" tabindex="-1"></a>roc_curve_plot <span class="ot">&lt;-</span> roc_curve_data <span class="sc">%&gt;%</span> </span>
<span id="cb187-2"><a href="aprendizaje-supervisado-1.html#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span> <span class="sc">-</span> specificity, <span class="at">y =</span> sensitivity)) <span class="sc">+</span></span>
<span id="cb187-3"><a href="aprendizaje-supervisado-1.html#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&#39;lightblue&#39;</span>) <span class="sc">+</span></span>
<span id="cb187-4"><a href="aprendizaje-supervisado-1.html#cb187-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb187-5"><a href="aprendizaje-supervisado-1.html#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb187-6"><a href="aprendizaje-supervisado-1.html#cb187-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;ROC Curve&quot;</span>)<span class="sc">+</span></span>
<span id="cb187-7"><a href="aprendizaje-supervisado-1.html#cb187-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb187-8"><a href="aprendizaje-supervisado-1.html#cb187-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-9"><a href="aprendizaje-supervisado-1.html#cb187-9" aria-hidden="true" tabindex="-1"></a>roc_curve_plot</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-217-2.png" width="672" /></p>
</div>
</div>
</div>
<div id="árboles-de-decisión" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Árboles de decisión</h2>
<p><img src="img/05-sup/tree/0-arboles.png" width="500pt" height="300pt" style="display: block; margin: auto;" /></p>
<p>Un árbol de decisiones es un algoritmo del aprendizaje supervisado que se puede utilizar tanto para problemas de <strong>clasificación</strong> como de <strong>regresión</strong>. Es un clasificador estructurado en árbol, donde los nodos internos representan las características de un conjunto de datos, las ramas representan las reglas de decisión y cada nodo hoja representa el resultado. La idea básica de los árboles es buscar puntos de cortes en las variables de entrada para hacer predicciones, ir dividiendo la muestra, y encontrar cortes sucesivos para refinar las predicciones.</p>
<p>En un árbol de decisión, hay dos tipos nodos, el nodo de decisión o nodos internos (Decision Node) y el nodo hoja o nodo terminal (Leaf node). Los nodos de decisión se utilizan para tomar cualquier decisión y tienen múltiples ramas, mientras que los nodos hoja son el resultado de esas decisiones y no contienen más ramas.</p>
<p><img src="img/05-sup/tree/1-arboles.png" width="500pt" height="300pt" style="display: block; margin: auto;" /></p>
<ul>
<li><strong>Regresión:</strong></li>
</ul>
<p><img src="img/05-sup/tree/2-arbol-reg-graph.png" width="500pt" height="300pt" style="display: block; margin: auto;" /></p>
<p><img src="img/05-sup/tree/3-arbol-reg-diagram.png" width="500pt" height="300pt" style="display: block; margin: auto;" /></p>
<ul>
<li><strong>Clasificación:</strong></li>
</ul>
<p><img src="img/05-sup/tree/4-arbol-cla-graph.png" width="500pt" height="300pt" style="display: block; margin: auto;" /></p>
<p><img src="img/05-sup/tree/5-arbol-cla-diagram.png" width="500pt" height="300pt" style="display: block; margin: auto;" /></p>
<p><img src="img/05-sup/tree/ejemploreg.png" width="500pt" height="300pt" style="display: block; margin: auto;" /></p>
<div id="ajuste-del-modelo-2" class="section level3" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> Ajuste del modelo</h3>
<p>En un árbol de decisión, para predecir la clase del conjunto de datos, el algoritmo comienza desde el nodo raíz del árbol. Este algoritmo compara los valores de la variable raíz con la variable de registro y, según la comparación, sigue una rama y salta al siguiente nodo.</p>
<p>Para el siguiente nodo, el algoritmo vuelve a comparar el valor de la siguiente variable con los otros subnodos y avanza. Continúa el proceso hasta que se llega a un nodo hoja. El proceso completo se puede comprender mejor con los siguientes pasos:</p>
<ol style="list-style-type: decimal">
<li><p>Comenzamos el árbol con el nodo raíz, llamémoslo S, que contiene el conjunto de entrenamiento completo.</p></li>
<li><p>Encuentre la mejor variable en el conjunto de datos usando <em>Attribute Selective Measure</em> (ASM).</p></li>
<li><p>Divida la S en subconjuntos que contengan valores posibles para la mejor variable.</p></li>
<li><p>Genere el nodo del árbol de decisión, que contiene la mejor variable.</p></li>
<li><p>Cree de forma recursiva nuevos árboles de decisión utilizando los subconjuntos del conjunto de datos creado en el paso 3. Continúe este proceso hasta que se alcance una etapa en la que no pueda particionar más los nodos y este nodo final sera un nodo hoja.</p></li>
<li><p>Para clasificación nos quedaremos la moda de la variable respuesta del nodo hoja y para regresión usaremos la media de la variable respuesta.</p></li>
</ol>
<div id="attribute-selective-measure-asm" class="section level4" number="5.6.1.1">
<h4><span class="header-section-number">5.6.1.1</span> Attribute Selective Measure (ASM)</h4>
<p>Al implementar un árbol de decisión, surge el problema principal de cómo seleccionar la mejor variable para el nodo raíz y para los subnodos. Para resolver este problemas existe una técnica que se llama medida de selección de atributos o <em>ASM</em>. Mediante esta medición, podemos seleccionar fácilmente la mejor variable para los nodos del árbol. Hay dos técnicas populares para <em>ASM</em>, que son:</p>
<ul>
<li>Índice de Gini</li>
</ul>
<p>La medida del grado de probabilidad de que una variable en particular se clasifique incorrectamente cuando se elige al azar se llama índice de Gini o impureza de Gini. Los datos se distribuyen por igual según el índice de Gini.</p>
<p><span class="math display">\[Gini = \sum_{i=1}^{n}\hat{p_i}(1-\hat{p}_i)\]</span></p>
<p>Con <span class="math inline">\(p_i\)</span> como la probabilidad de que un objeto se clasifique en una clase particular.</p>
<p>Esta métrica puede analizarse como una métrica de impureza. Cuando todos o la mayoría de elementos dentro de un nodo pertenecen a una misma clase, el índice de Gini toma valores cercanos a cero.</p>
<p>Cuando se utiliza el índice de Gini como criterio seleccionar la variable para el nodo raíz, seleccionaremos la variable con el índice de Gini menor.</p>
</div>
<div id="cuándo-dejar-de-dividir-un-nodo" class="section level4" number="5.6.1.2">
<h4><span class="header-section-number">5.6.1.2</span> ¿Cuándo dejar de dividir un nodo?</h4>
<p>Podríamos preguntarnos cuándo dejar de crecer un árbol. Pueden existir problemas que tengan un gran conjunto de variables y esto da como resultado una gran cantidad de divisiones, lo que a su vez genera un árbol de decisión muy grande. Estos árboles son complejos y pueden provocar un sobreajuste. Entonces, necesitamos saber cuándo parar.</p>
<ol style="list-style-type: decimal">
<li><p>Una forma de hacer esto es establecer un número mínimo de entradas de entrenamiento para dividir un nodo.</p></li>
<li><p>Otra forma es establecer la profundidad máxima de su modelo. La profundidad máxima se refiere a la longitud del camino más largo desde el nodo raíz hasta un nodo hoja.</p></li>
</ol>
</div>
<div id="cuándo-podar-un-árbol" class="section level4" number="5.6.1.3">
<h4><span class="header-section-number">5.6.1.3</span> ¿Cuándo podar un árbol?</h4>
<p>El rendimiento de un árbol se puede aumentar aún más mediante la poda del árbol. Esto se refiere a eliminar las ramas que hacen uso de variables de poca importancia. De esta manera, reducimos la complejidad del árbol y, por lo tanto, <strong>aumentamos su poder predictivo al reducir el sobreajuste.</strong></p>
<p><img src="img/05-sup/tree/6-podar.jpg" width="500pt" height="300pt" style="display: block; margin: auto;" /></p>
<p>La poda puede comenzar en la raíz o en las hojas. El método más simple de poda comienza en las hojas y elimina cada nodo con la clase más popular en esa hoja, este cambio se mantiene si no deteriora la precisión. Se pueden usar métodos de poda más sofisticados, como la poda de complejidad de costos, donde se usa un parámetro de aprendizaje (alfa) para observar si los nodos se pueden eliminar en función del tamaño del subárbol.</p>
</div>
</div>
<div id="implementación-en-r-3" class="section level3" number="5.6.2">
<h3><span class="header-section-number">5.6.2</span> Implementación en R</h3>
<p>Usaremos las recetas antes implementadas para ajustar tanto el modelo de regresión como el de clasificación. Exploraremos un conjunto de hiperparámetros para elegir el mejor modelo. En esta ocasión usamos la función <em>grid_regular()</em> donde con el parámetro <em>levels</em> le indicamos cuantos distintos números queremos para cada parámetro a ajustar.</p>
<div id="regresión-3" class="section level4" number="5.6.2.1">
<h4><span class="header-section-number">5.6.2.1</span> Regresión:</h4>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="aprendizaje-supervisado-1.html#cb188-1" aria-hidden="true" tabindex="-1"></a>tree_model <span class="ot">&lt;-</span> <span class="fu">decision_tree</span>(</span>
<span id="cb188-2"><a href="aprendizaje-supervisado-1.html#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">&quot;regression&quot;</span>,</span>
<span id="cb188-3"><a href="aprendizaje-supervisado-1.html#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tree_depth =</span> <span class="fu">tune</span>(),</span>
<span id="cb188-4"><a href="aprendizaje-supervisado-1.html#cb188-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cost_complexity =</span> <span class="fu">tune</span>(),</span>
<span id="cb188-5"><a href="aprendizaje-supervisado-1.html#cb188-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_n =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb188-6"><a href="aprendizaje-supervisado-1.html#cb188-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;rpart&quot;</span>)</span>
<span id="cb188-7"><a href="aprendizaje-supervisado-1.html#cb188-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-8"><a href="aprendizaje-supervisado-1.html#cb188-8" aria-hidden="true" tabindex="-1"></a>tree_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb188-9"><a href="aprendizaje-supervisado-1.html#cb188-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(receta_casas) <span class="sc">%&gt;%</span> </span>
<span id="cb188-10"><a href="aprendizaje-supervisado-1.html#cb188-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(tree_model)</span>
<span id="cb188-11"><a href="aprendizaje-supervisado-1.html#cb188-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-12"><a href="aprendizaje-supervisado-1.html#cb188-12" aria-hidden="true" tabindex="-1"></a>tree_grid <span class="ot">&lt;-</span> <span class="fu">grid_regular</span>(</span>
<span id="cb188-13"><a href="aprendizaje-supervisado-1.html#cb188-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min_n</span>(),</span>
<span id="cb188-14"><a href="aprendizaje-supervisado-1.html#cb188-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tree_depth</span>(),</span>
<span id="cb188-15"><a href="aprendizaje-supervisado-1.html#cb188-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cost_complexity</span>(),</span>
<span id="cb188-16"><a href="aprendizaje-supervisado-1.html#cb188-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="dv">5</span></span>
<span id="cb188-17"><a href="aprendizaje-supervisado-1.html#cb188-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb188-18"><a href="aprendizaje-supervisado-1.html#cb188-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-19"><a href="aprendizaje-supervisado-1.html#cb188-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-20"><a href="aprendizaje-supervisado-1.html#cb188-20" aria-hidden="true" tabindex="-1"></a>ctrl_grid <span class="ot">&lt;-</span> <span class="fu">control_grid</span>(<span class="at">save_pred =</span> T, <span class="at">verbose =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="aprendizaje-supervisado-1.html#cb189-1" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb189-2"><a href="aprendizaje-supervisado-1.html#cb189-2" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb189-3"><a href="aprendizaje-supervisado-1.html#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb189-4"><a href="aprendizaje-supervisado-1.html#cb189-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-5"><a href="aprendizaje-supervisado-1.html#cb189-5" aria-hidden="true" tabindex="-1"></a>casas_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(ames_train)</span>
<span id="cb189-6"><a href="aprendizaje-supervisado-1.html#cb189-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-7"><a href="aprendizaje-supervisado-1.html#cb189-7" aria-hidden="true" tabindex="-1"></a>knnt1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb189-8"><a href="aprendizaje-supervisado-1.html#cb189-8" aria-hidden="true" tabindex="-1"></a>tree_tune_result <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb189-9"><a href="aprendizaje-supervisado-1.html#cb189-9" aria-hidden="true" tabindex="-1"></a>  tree_workflow,</span>
<span id="cb189-10"><a href="aprendizaje-supervisado-1.html#cb189-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> casas_folds,</span>
<span id="cb189-11"><a href="aprendizaje-supervisado-1.html#cb189-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> tree_grid,</span>
<span id="cb189-12"><a href="aprendizaje-supervisado-1.html#cb189-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae, mape),</span>
<span id="cb189-13"><a href="aprendizaje-supervisado-1.html#cb189-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> ctrl_grid</span>
<span id="cb189-14"><a href="aprendizaje-supervisado-1.html#cb189-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb189-15"><a href="aprendizaje-supervisado-1.html#cb189-15" aria-hidden="true" tabindex="-1"></a>knnt2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>(); knnt2 <span class="sc">-</span> knnt1</span>
<span id="cb189-16"><a href="aprendizaje-supervisado-1.html#cb189-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-17"><a href="aprendizaje-supervisado-1.html#cb189-17" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb189-18"><a href="aprendizaje-supervisado-1.html#cb189-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-19"><a href="aprendizaje-supervisado-1.html#cb189-19" aria-hidden="true" tabindex="-1"></a>tree_tune_result <span class="sc">%&gt;%</span> <span class="fu">saveRDS</span>(<span class="st">&quot;models/tree_model_reg.rds&quot;</span>)</span></code></pre></div>
<p>Podemos obtener las métricas de cada <em>fold</em> con el siguiente código:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="aprendizaje-supervisado-1.html#cb190-1" aria-hidden="true" tabindex="-1"></a>tree_tune_result <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;models/tree_model_reg.rds&quot;</span>)</span>
<span id="cb190-2"><a href="aprendizaje-supervisado-1.html#cb190-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-3"><a href="aprendizaje-supervisado-1.html#cb190-3" aria-hidden="true" tabindex="-1"></a>tree_tune_result <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(.metrics)</span></code></pre></div>
<pre><code>## # A tibble: 3,750 × 11
##    splits             id     cost_complexity tree_depth min_n .metric .estimator
##    &lt;list&gt;             &lt;chr&gt;            &lt;dbl&gt;      &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;     
##  1 &lt;split [1977/220]&gt; Fold01    0.0000000001          1     2 rmse    standard  
##  2 &lt;split [1977/220]&gt; Fold01    0.0000000001          1     2 mae     standard  
##  3 &lt;split [1977/220]&gt; Fold01    0.0000000001          1     2 mape    standard  
##  4 &lt;split [1977/220]&gt; Fold01    0.0000000001          1    11 rmse    standard  
##  5 &lt;split [1977/220]&gt; Fold01    0.0000000001          1    11 mae     standard  
##  6 &lt;split [1977/220]&gt; Fold01    0.0000000001          1    11 mape    standard  
##  7 &lt;split [1977/220]&gt; Fold01    0.0000000001          1    21 rmse    standard  
##  8 &lt;split [1977/220]&gt; Fold01    0.0000000001          1    21 mae     standard  
##  9 &lt;split [1977/220]&gt; Fold01    0.0000000001          1    21 mape    standard  
## 10 &lt;split [1977/220]&gt; Fold01    0.0000000001          1    30 rmse    standard  
## # … with 3,740 more rows, and 4 more variables: .estimate &lt;dbl&gt;, .config &lt;chr&gt;,
## #   .notes &lt;list&gt;, .predictions &lt;list&gt;</code></pre>
<p>En la siguiente gráfica observamos el error cuadrático medio de las distintas métricas con distintos números de vecinos.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="aprendizaje-supervisado-1.html#cb192-1" aria-hidden="true" tabindex="-1"></a>tree_tune_result <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-230-1.png" width="672" /></p>
<p>En la siguiente gráfica observamos el error absoluto promedio de las distintas métricas con distintos números de vecinos.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="aprendizaje-supervisado-1.html#cb193-1" aria-hidden="true" tabindex="-1"></a>tree_tune_result <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">metric =</span> <span class="st">&quot;mae&quot;</span>)</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-231-1.png" width="672" /></p>
<p>Con el siguiente código obtenemos los mejores 10 modelos respecto al <em>rmse</em>.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="aprendizaje-supervisado-1.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(tree_tune_result, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 9
##    cost_complexity tree_depth min_n .metric .estimator    mean     n std_err
##              &lt;dbl&gt;      &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
##  1    0.0000000001         15    11 rmse    standard   197132.    10   3010.
##  2    0.0000000178         15    11 rmse    standard   197132.    10   3010.
##  3    0.00000316           15    11 rmse    standard   197132.    10   3010.
##  4    0.0000000001         11    11 rmse    standard   197132.    10   3010.
##  5    0.0000000178         11    11 rmse    standard   197132.    10   3010.
##  6    0.00000316           11    11 rmse    standard   197132.    10   3010.
##  7    0.0000000001         15     2 rmse    standard   197132.    10   3010.
##  8    0.0000000178         15     2 rmse    standard   197132.    10   3010.
##  9    0.00000316           15     2 rmse    standard   197132.    10   3010.
## 10    0.0000000001          8    21 rmse    standard   197132.    10   3010.
## # … with 1 more variable: .config &lt;chr&gt;</code></pre>
<p>Ahora obtendremos el modelo que mejor desempeño tiene tomando en cuenta el <em>rmse</em> y haremos las predicciones del conjunto de prueba con este modelo.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="aprendizaje-supervisado-1.html#cb196-1" aria-hidden="true" tabindex="-1"></a>best_tree_model_reg <span class="ot">&lt;-</span> <span class="fu">select_best</span>(tree_tune_result, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span>
<span id="cb196-2"><a href="aprendizaje-supervisado-1.html#cb196-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3"><a href="aprendizaje-supervisado-1.html#cb196-3" aria-hidden="true" tabindex="-1"></a>final_tree_model_reg <span class="ot">&lt;-</span> tree_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb196-4"><a href="aprendizaje-supervisado-1.html#cb196-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(best_tree_model_reg) <span class="sc">%&gt;%</span> </span>
<span id="cb196-5"><a href="aprendizaje-supervisado-1.html#cb196-5" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">data =</span> ames_train)</span>
<span id="cb196-6"><a href="aprendizaje-supervisado-1.html#cb196-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-7"><a href="aprendizaje-supervisado-1.html#cb196-7" aria-hidden="true" tabindex="-1"></a>results_reg <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_tree_model_reg, ames_test) <span class="sc">%&gt;%</span> </span>
<span id="cb196-8"><a href="aprendizaje-supervisado-1.html#cb196-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(<span class="at">truth =</span> ames_test<span class="sc">$</span>Sale_Price) <span class="sc">%&gt;%</span> </span>
<span id="cb196-9"><a href="aprendizaje-supervisado-1.html#cb196-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.pred =</span> <span class="fu">exp</span>(.pred))</span></code></pre></div>
<p>Nuestro árbol final se ve de la siguiente manera:</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="aprendizaje-supervisado-1.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb197-2"><a href="aprendizaje-supervisado-1.html#cb197-2" aria-hidden="true" tabindex="-1"></a>final_tree_model_reg <span class="sc">%&gt;%</span></span>
<span id="cb197-3"><a href="aprendizaje-supervisado-1.html#cb197-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb197-4"><a href="aprendizaje-supervisado-1.html#cb197-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rpart.plot</span>(<span class="at">roundint =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-234-1.png" width="672" /></p>
<p>Podemos obtener la impotancia de las variables:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="aprendizaje-supervisado-1.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb198-2"><a href="aprendizaje-supervisado-1.html#cb198-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-3"><a href="aprendizaje-supervisado-1.html#cb198-3" aria-hidden="true" tabindex="-1"></a>final_tree_model_reg <span class="sc">%&gt;%</span> </span>
<span id="cb198-4"><a href="aprendizaje-supervisado-1.html#cb198-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_parsnip</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb198-5"><a href="aprendizaje-supervisado-1.html#cb198-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vip</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Importancia de las variables&quot;</span>)</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-235-1.png" width="672" /></p>
<div id="métricas-de-desempeño-4" class="section level5" number="5.6.2.1.1">
<h5><span class="header-section-number">5.6.2.1.1</span> Métricas de desempeño</h5>
<p>Ahora para calcular las métricas de desempeño usaremos la paqueteria <em>MLmetrics</em></p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="aprendizaje-supervisado-1.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MLmetrics)</span>
<span id="cb199-2"><a href="aprendizaje-supervisado-1.html#cb199-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-3"><a href="aprendizaje-supervisado-1.html#cb199-3" aria-hidden="true" tabindex="-1"></a>results_reg <span class="sc">%&gt;%</span> </span>
<span id="cb199-4"><a href="aprendizaje-supervisado-1.html#cb199-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb199-5"><a href="aprendizaje-supervisado-1.html#cb199-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mae =</span> MLmetrics<span class="sc">::</span><span class="fu">MAE</span>(.pred, truth),</span>
<span id="cb199-6"><a href="aprendizaje-supervisado-1.html#cb199-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mape =</span> MLmetrics<span class="sc">::</span><span class="fu">MAPE</span>(.pred, truth),</span>
<span id="cb199-7"><a href="aprendizaje-supervisado-1.html#cb199-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse =</span> MLmetrics<span class="sc">::</span><span class="fu">RMSE</span>(.pred, truth),</span>
<span id="cb199-8"><a href="aprendizaje-supervisado-1.html#cb199-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">r2 =</span> MLmetrics<span class="sc">::</span><span class="fu">R2_Score</span>(.pred, truth),</span>
<span id="cb199-9"><a href="aprendizaje-supervisado-1.html#cb199-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmsle =</span> MLmetrics<span class="sc">::</span><span class="fu">RMSLE</span>(.pred, truth)</span>
<span id="cb199-10"><a href="aprendizaje-supervisado-1.html#cb199-10" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##      mae  mape   rmse    r2 rmsle
##    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 29305. 0.172 44333. 0.697 0.234</code></pre>
</div>
</div>
<div id="clasificación-4" class="section level4" number="5.6.2.2">
<h4><span class="header-section-number">5.6.2.2</span> Clasificación</h4>
<p>Repetiremos el proceso para el problema de clasificación.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="aprendizaje-supervisado-1.html#cb201-1" aria-hidden="true" tabindex="-1"></a>tree_model <span class="ot">&lt;-</span> <span class="fu">decision_tree</span>(</span>
<span id="cb201-2"><a href="aprendizaje-supervisado-1.html#cb201-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">&quot;classification&quot;</span>,</span>
<span id="cb201-3"><a href="aprendizaje-supervisado-1.html#cb201-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tree_depth =</span> <span class="fu">tune</span>(),</span>
<span id="cb201-4"><a href="aprendizaje-supervisado-1.html#cb201-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cost_complexity =</span> <span class="fu">tune</span>(),</span>
<span id="cb201-5"><a href="aprendizaje-supervisado-1.html#cb201-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_n =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb201-6"><a href="aprendizaje-supervisado-1.html#cb201-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;rpart&quot;</span>)</span>
<span id="cb201-7"><a href="aprendizaje-supervisado-1.html#cb201-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-8"><a href="aprendizaje-supervisado-1.html#cb201-8" aria-hidden="true" tabindex="-1"></a>tree_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb201-9"><a href="aprendizaje-supervisado-1.html#cb201-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(telco_rec) <span class="sc">%&gt;%</span> </span>
<span id="cb201-10"><a href="aprendizaje-supervisado-1.html#cb201-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(tree_model)</span>
<span id="cb201-11"><a href="aprendizaje-supervisado-1.html#cb201-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-12"><a href="aprendizaje-supervisado-1.html#cb201-12" aria-hidden="true" tabindex="-1"></a>tree_grid <span class="ot">&lt;-</span> <span class="fu">grid_regular</span>(</span>
<span id="cb201-13"><a href="aprendizaje-supervisado-1.html#cb201-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min_n</span>(),</span>
<span id="cb201-14"><a href="aprendizaje-supervisado-1.html#cb201-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tree_depth</span>(),</span>
<span id="cb201-15"><a href="aprendizaje-supervisado-1.html#cb201-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cost_complexity</span>(),</span>
<span id="cb201-16"><a href="aprendizaje-supervisado-1.html#cb201-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="dv">5</span></span>
<span id="cb201-17"><a href="aprendizaje-supervisado-1.html#cb201-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb201-18"><a href="aprendizaje-supervisado-1.html#cb201-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-19"><a href="aprendizaje-supervisado-1.html#cb201-19" aria-hidden="true" tabindex="-1"></a>ctrl_grid <span class="ot">&lt;-</span> <span class="fu">control_grid</span>(<span class="at">save_pred =</span> T, <span class="at">verbose =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="aprendizaje-supervisado-1.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb202-2"><a href="aprendizaje-supervisado-1.html#cb202-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-3"><a href="aprendizaje-supervisado-1.html#cb202-3" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb202-4"><a href="aprendizaje-supervisado-1.html#cb202-4" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb202-5"><a href="aprendizaje-supervisado-1.html#cb202-5" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb202-6"><a href="aprendizaje-supervisado-1.html#cb202-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-7"><a href="aprendizaje-supervisado-1.html#cb202-7" aria-hidden="true" tabindex="-1"></a>telco_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(telco_train)</span>
<span id="cb202-8"><a href="aprendizaje-supervisado-1.html#cb202-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-9"><a href="aprendizaje-supervisado-1.html#cb202-9" aria-hidden="true" tabindex="-1"></a>treet1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb202-10"><a href="aprendizaje-supervisado-1.html#cb202-10" aria-hidden="true" tabindex="-1"></a>tree_tune_result <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb202-11"><a href="aprendizaje-supervisado-1.html#cb202-11" aria-hidden="true" tabindex="-1"></a>  tree_workflow,</span>
<span id="cb202-12"><a href="aprendizaje-supervisado-1.html#cb202-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> telco_folds,</span>
<span id="cb202-13"><a href="aprendizaje-supervisado-1.html#cb202-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> tree_grid,</span>
<span id="cb202-14"><a href="aprendizaje-supervisado-1.html#cb202-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(roc_auc, pr_auc, sens),</span>
<span id="cb202-15"><a href="aprendizaje-supervisado-1.html#cb202-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> ctrl_grid</span>
<span id="cb202-16"><a href="aprendizaje-supervisado-1.html#cb202-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb202-17"><a href="aprendizaje-supervisado-1.html#cb202-17" aria-hidden="true" tabindex="-1"></a>treet2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>(); knnt2 <span class="sc">-</span> knnt1</span>
<span id="cb202-18"><a href="aprendizaje-supervisado-1.html#cb202-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-19"><a href="aprendizaje-supervisado-1.html#cb202-19" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb202-20"><a href="aprendizaje-supervisado-1.html#cb202-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-21"><a href="aprendizaje-supervisado-1.html#cb202-21" aria-hidden="true" tabindex="-1"></a>tree_tune_result <span class="sc">%&gt;%</span> <span class="fu">saveRDS</span>(<span class="st">&quot;models/tree_model_cla.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="aprendizaje-supervisado-1.html#cb203-1" aria-hidden="true" tabindex="-1"></a>tree_tune_result <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;models/tree_model_cla.rds&quot;</span>)</span>
<span id="cb203-2"><a href="aprendizaje-supervisado-1.html#cb203-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-3"><a href="aprendizaje-supervisado-1.html#cb203-3" aria-hidden="true" tabindex="-1"></a>tree_tune_result <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(.metrics)</span></code></pre></div>
<pre><code>## # A tibble: 3,750 × 11
##    splits             id     cost_complexity tree_depth min_n .metric .estimator
##    &lt;list&gt;             &lt;chr&gt;            &lt;dbl&gt;      &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;     
##  1 &lt;split [4437/493]&gt; Fold01    0.0000000001          1     2 sens    binary    
##  2 &lt;split [4437/493]&gt; Fold01    0.0000000001          1     2 roc_auc binary    
##  3 &lt;split [4437/493]&gt; Fold01    0.0000000001          1     2 pr_auc  binary    
##  4 &lt;split [4437/493]&gt; Fold01    0.0000000001          1    11 sens    binary    
##  5 &lt;split [4437/493]&gt; Fold01    0.0000000001          1    11 roc_auc binary    
##  6 &lt;split [4437/493]&gt; Fold01    0.0000000001          1    11 pr_auc  binary    
##  7 &lt;split [4437/493]&gt; Fold01    0.0000000001          1    21 sens    binary    
##  8 &lt;split [4437/493]&gt; Fold01    0.0000000001          1    21 roc_auc binary    
##  9 &lt;split [4437/493]&gt; Fold01    0.0000000001          1    21 pr_auc  binary    
## 10 &lt;split [4437/493]&gt; Fold01    0.0000000001          1    30 sens    binary    
## # … with 3,740 more rows, and 4 more variables: .estimate &lt;dbl&gt;, .config &lt;chr&gt;,
## #   .notes &lt;list&gt;, .predictions &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="aprendizaje-supervisado-1.html#cb205-1" aria-hidden="true" tabindex="-1"></a>tree_tune_result <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>)</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-240-1.png" width="672" /></p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="aprendizaje-supervisado-1.html#cb206-1" aria-hidden="true" tabindex="-1"></a>tree_tune_result <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">metric =</span> <span class="st">&quot;roc_auc&quot;</span>)</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-241-1.png" width="672" /></p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="aprendizaje-supervisado-1.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(tree_tune_result, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 9
##    cost_complexity tree_depth min_n .metric .estimator  mean     n std_err
##              &lt;dbl&gt;      &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
##  1    0.0000000001         11    30 pr_auc  binary     0.903    10 0.00584
##  2    0.0000000178         11    30 pr_auc  binary     0.903    10 0.00584
##  3    0.00000316           11    30 pr_auc  binary     0.903    10 0.00584
##  4    0.0000000001          8    30 pr_auc  binary     0.900    10 0.00812
##  5    0.0000000178          8    30 pr_auc  binary     0.900    10 0.00812
##  6    0.00000316            8    30 pr_auc  binary     0.900    10 0.00812
##  7    0.0000000001          4     2 pr_auc  binary     0.899    10 0.00745
##  8    0.0000000001          4    11 pr_auc  binary     0.899    10 0.00745
##  9    0.0000000178          4     2 pr_auc  binary     0.899    10 0.00745
## 10    0.0000000178          4    11 pr_auc  binary     0.899    10 0.00745
## # … with 1 more variable: .config &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="aprendizaje-supervisado-1.html#cb209-1" aria-hidden="true" tabindex="-1"></a>best_tree_model_cla <span class="ot">&lt;-</span> <span class="fu">select_best</span>(tree_tune_result, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>)</span>
<span id="cb209-2"><a href="aprendizaje-supervisado-1.html#cb209-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-3"><a href="aprendizaje-supervisado-1.html#cb209-3" aria-hidden="true" tabindex="-1"></a>final_tree_model_cla <span class="ot">&lt;-</span> tree_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb209-4"><a href="aprendizaje-supervisado-1.html#cb209-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(best_tree_model_cla) <span class="sc">%&gt;%</span> </span>
<span id="cb209-5"><a href="aprendizaje-supervisado-1.html#cb209-5" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">data =</span> telco_train)</span>
<span id="cb209-6"><a href="aprendizaje-supervisado-1.html#cb209-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-7"><a href="aprendizaje-supervisado-1.html#cb209-7" aria-hidden="true" tabindex="-1"></a>results_cla <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_tree_model_cla, telco_test, <span class="at">type =</span> <span class="st">&#39;prob&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb209-8"><a href="aprendizaje-supervisado-1.html#cb209-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(<span class="at">truth =</span>telco_test<span class="sc">$</span>Churn) <span class="sc">%&gt;%</span> </span>
<span id="cb209-9"><a href="aprendizaje-supervisado-1.html#cb209-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">truth =</span> <span class="fu">factor</span>(truth, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;No&#39;</span>, <span class="st">&#39;Yes&#39;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;No&#39;</span>, <span class="st">&#39;Yes&#39;</span>)))</span>
<span id="cb209-10"><a href="aprendizaje-supervisado-1.html#cb209-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-11"><a href="aprendizaje-supervisado-1.html#cb209-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results_cla)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   .pred_No .pred_Yes truth
##      &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;
## 1    0.918    0.0822 No   
## 2    0.227    0.773  Yes  
## 3    0.3      0.7    No   
## 4    0.981    0.0186 No   
## 5    0.881    0.119  No   
## 6    0.652    0.348  No</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="aprendizaje-supervisado-1.html#cb211-1" aria-hidden="true" tabindex="-1"></a>results_cla_tree <span class="ot">&lt;-</span> results_cla</span></code></pre></div>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="aprendizaje-supervisado-1.html#cb212-1" aria-hidden="true" tabindex="-1"></a>pr_curve_data <span class="ot">&lt;-</span> <span class="fu">pr_curve</span>(</span>
<span id="cb212-2"><a href="aprendizaje-supervisado-1.html#cb212-2" aria-hidden="true" tabindex="-1"></a>  results_cla, </span>
<span id="cb212-3"><a href="aprendizaje-supervisado-1.html#cb212-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">truth =</span> truth, </span>
<span id="cb212-4"><a href="aprendizaje-supervisado-1.html#cb212-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> .pred_Yes, </span>
<span id="cb212-5"><a href="aprendizaje-supervisado-1.html#cb212-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">event_level =</span> <span class="st">&#39;second&#39;</span></span>
<span id="cb212-6"><a href="aprendizaje-supervisado-1.html#cb212-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-7"><a href="aprendizaje-supervisado-1.html#cb212-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-8"><a href="aprendizaje-supervisado-1.html#cb212-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-9"><a href="aprendizaje-supervisado-1.html#cb212-9" aria-hidden="true" tabindex="-1"></a>roc_curve_data <span class="ot">&lt;-</span> <span class="fu">roc_curve</span>(</span>
<span id="cb212-10"><a href="aprendizaje-supervisado-1.html#cb212-10" aria-hidden="true" tabindex="-1"></a>  results_cla, </span>
<span id="cb212-11"><a href="aprendizaje-supervisado-1.html#cb212-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">truth =</span> truth, </span>
<span id="cb212-12"><a href="aprendizaje-supervisado-1.html#cb212-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> .pred_Yes, </span>
<span id="cb212-13"><a href="aprendizaje-supervisado-1.html#cb212-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">event_level =</span> <span class="st">&#39;second&#39;</span></span>
<span id="cb212-14"><a href="aprendizaje-supervisado-1.html#cb212-14" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="aprendizaje-supervisado-1.html#cb213-1" aria-hidden="true" tabindex="-1"></a>pr_curve_plot <span class="ot">&lt;-</span> pr_curve_data <span class="sc">%&gt;%</span> </span>
<span id="cb213-2"><a href="aprendizaje-supervisado-1.html#cb213-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> recall, <span class="at">y =</span> precision)) <span class="sc">+</span></span>
<span id="cb213-3"><a href="aprendizaje-supervisado-1.html#cb213-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&#39;lightblue&#39;</span>) <span class="sc">+</span></span>
<span id="cb213-4"><a href="aprendizaje-supervisado-1.html#cb213-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb213-5"><a href="aprendizaje-supervisado-1.html#cb213-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb213-6"><a href="aprendizaje-supervisado-1.html#cb213-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Precision vs Recall&quot;</span>)<span class="sc">+</span></span>
<span id="cb213-7"><a href="aprendizaje-supervisado-1.html#cb213-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb213-8"><a href="aprendizaje-supervisado-1.html#cb213-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-9"><a href="aprendizaje-supervisado-1.html#cb213-9" aria-hidden="true" tabindex="-1"></a>pr_curve_plot</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-245-1.png" width="672" /></p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="aprendizaje-supervisado-1.html#cb214-1" aria-hidden="true" tabindex="-1"></a>roc_curve_plot <span class="ot">&lt;-</span> roc_curve_data <span class="sc">%&gt;%</span> </span>
<span id="cb214-2"><a href="aprendizaje-supervisado-1.html#cb214-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span> <span class="sc">-</span> specificity, <span class="at">y =</span> sensitivity)) <span class="sc">+</span></span>
<span id="cb214-3"><a href="aprendizaje-supervisado-1.html#cb214-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&#39;lightblue&#39;</span>) <span class="sc">+</span></span>
<span id="cb214-4"><a href="aprendizaje-supervisado-1.html#cb214-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb214-5"><a href="aprendizaje-supervisado-1.html#cb214-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb214-6"><a href="aprendizaje-supervisado-1.html#cb214-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;ROC Curve&quot;</span>)<span class="sc">+</span></span>
<span id="cb214-7"><a href="aprendizaje-supervisado-1.html#cb214-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb214-8"><a href="aprendizaje-supervisado-1.html#cb214-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-9"><a href="aprendizaje-supervisado-1.html#cb214-9" aria-hidden="true" tabindex="-1"></a>roc_curve_plot</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-246-1.png" width="672" /></p>
<p>Nuestro árbol final se ve de la siguiente manera:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="aprendizaje-supervisado-1.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb215-2"><a href="aprendizaje-supervisado-1.html#cb215-2" aria-hidden="true" tabindex="-1"></a>final_tree_model_cla <span class="sc">%&gt;%</span></span>
<span id="cb215-3"><a href="aprendizaje-supervisado-1.html#cb215-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb215-4"><a href="aprendizaje-supervisado-1.html#cb215-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rpart.plot</span>(<span class="at">roundint =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning: labs do not fit even at cex 0.15, there may be some overplotting</code></pre>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-247-1.png" width="672" /></p>
<p>Podemos obtener la impotancia de las variables:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="aprendizaje-supervisado-1.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb217-2"><a href="aprendizaje-supervisado-1.html#cb217-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-3"><a href="aprendizaje-supervisado-1.html#cb217-3" aria-hidden="true" tabindex="-1"></a>final_tree_model_cla <span class="sc">%&gt;%</span> </span>
<span id="cb217-4"><a href="aprendizaje-supervisado-1.html#cb217-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_parsnip</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb217-5"><a href="aprendizaje-supervisado-1.html#cb217-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vip</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Importancia de las variables&quot;</span>)</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-248-1.png" width="672" /></p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="aprendizaje-supervisado-1.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb218-2"><a href="aprendizaje-supervisado-1.html#cb218-2" aria-hidden="true" tabindex="-1"></a>results_cla <span class="sc">%&lt;&gt;%</span> <span class="fu">mutate</span>(<span class="at">truth =</span> <span class="fu">as_factor</span>(truth))</span></code></pre></div>
</div>
</div>
</div>
<div id="bagging" class="section level2" number="5.7">
<h2><span class="header-section-number">5.7</span> Bagging</h2>
<p>Primero tenemos que definir qué es la <strong>Agregación de Bootstrap o Bagging</strong>. Este es un aalgoritmo de aprendizaje automático diseñado para mejorar la estabilidad y precisión de algoritmos de ML usados en clasificación estadística y regresión. Además reduce la varianza y ayuda a evitar el sobreajuste. Aunque es usualmente aplicado a métodos de árboles de decisión, puede ser usado con cualquier tipo de método. Bagging es un caso especial del promediado de modelos.</p>
<p>Los métodos de bagging son métodos donde los algoritmos simples son usados en paralelo. El principal objetivo de los métodos en paralelo es el de aprovecharse de la independencia que hay entre los algoritmos simples, ya que el error se puede reducir bastante al promediar las salidas de los modelos simples. Es como si, queriendo resolver un problema entre varias personas independientes unas de otras, damos por bueno lo que eligiese la mayoría de las personas.</p>
<p>Para obtener la agregación de las salidas de cada modelo simple e independiente, bagging puede usar la votación para los métodos de clasificiación y el promedio para los métodos de regresión.</p>
<p><img src="img/05-sup/tree/7-bag.png" width="500pt" height="300pt" style="display: block; margin: auto;" /></p>
</div>
<div id="random-forest" class="section level2" number="5.8">
<h2><span class="header-section-number">5.8</span> Random Forest</h2>
<p>Un bosque aleatorio es un algoritmo de aprendizaje automático supervisado que se construye a partir de algoritmos de árbol de decisión. Este algoritmo se aplica en diversas industrias, como la banca y el comercio electrónico, para predecir el comportamiento y los resultados.</p>
<p>En esta clase se dará una descripción general del algoritmo de bosque aleatorio, cómo funciona y las características del algoritmo.</p>
<p>También se señalan las ventajas y desventajas de este algoritmo.</p>
<div id="qué-es" class="section level3" number="5.8.1">
<h3><span class="header-section-number">5.8.1</span> ¿Qué es?</h3>
<p>Un bosque aleatorio es una técnica de aprendizaje automático que se utiliza para resolver problemas de regresión y clasificación. Utiliza el aprendizaje por conjuntos, que es una técnica que combina muchos clasificadores para proporcionar soluciones a problemas complejos.</p>
<p>Este algoritmo consta de muchos árboles de decisión. El “bosque” generado se entrena
mediante <strong>agregación de bootstrap (bagging)</strong>, el cual es es un meta-algoritmo
de conjunto que mejora la precisión de los algoritmos de aprendizaje automático.</p>
<p>El algoritmo establece el resultado en función de las predicciones de los árboles de decisión. Predice tomando el promedio o la media de la salida de varios árboles. El aumento del número de árboles aumenta la precisión del resultado.</p>
<p>Un bosque aleatorio erradica las limitaciones de un algoritmo de árbol de decisión. Reduce el sobreajuste de conjuntos de datos y aumenta la precisión. Genera predicciones sin requerir muchas configuraciones.</p>
<p><img src="img/05-sup/rf/3-10-1-bosques-aleatorios.png" width="600pt" height="300pt" style="display: block; margin: auto;" /></p>
</div>
<div id="características-de-los-bosques-aleatorios" class="section level3" number="5.8.2">
<h3><span class="header-section-number">5.8.2</span> Características de los bosques aleatorios</h3>
<ul>
<li><p>Es más preciso que el algoritmo árbol de decisiones.</p></li>
<li><p>Proporciona una forma eficaz de gestionar los datos faltantes.</p></li>
<li><p>Puede producir una predicción razonable sin ajuste de hiperparámetros.</p></li>
<li><p>Resuelve el problema del sobreajuste en los árboles de decisión.</p></li>
<li><p>En cada árbol forestal aleatorio, se selecciona aleatoriamente un subconjunto
de características en el punto de división del nodo.</p></li>
</ul>
</div>
<div id="aplicar-árboles-de-decisión-en-un-bosque-aleatorio" class="section level3" number="5.8.3">
<h3><span class="header-section-number">5.8.3</span> Aplicar árboles de decisión en un bosque aleatorio</h3>
<p>La principal diferencia entre el algoritmo de árbol de decisión y el algoritmo de bosque aleatorio es que el establecimiento de nodos raíz y la desagregación de nodos se realiza de forma aleatoria en este último. <strong>El bosque aleatorio emplea el método de bagging para generar la predicción requerida.</strong></p>
<p><strong>El método bagging implica el uso de diferentes muestras de datos (datos de entrenamiento) en lugar de una sola muestra.</strong> Los árboles de decisión producen diferentes resultados, dependiendo de los datos de entrenamiento alimentados al algoritmo de bosque aleatorio.</p>
<p>Nuestro primer ejemplo todavía se puede utilizar para explicar cómo funcionan los bosques aleatorios. Supongamos que solo tenemos cuatro árboles de decisión. En este caso, los datos de entrenamiento que comprenden las observaciones y características de estudio se dividirán en cuatro nodos raíz. Supongamos que queremos modelar si un cliente compra o no compra un teléfono.</p>
<p>Los nodos raíz podrían representar cuatro características que podrían influir en la elección de un cliente (precio, almacenamiento interno, cámara y RAM). <strong>El bosque aleatorio dividirá los nodos seleccionando características al azar. La predicción final se seleccionará en función del resultado de los cuatro árboles.</strong></p>
<p><strong>El resultado elegido por la mayoría de los árboles de decisión será la elección final.</strong></p>
<p>Si tres árboles predicen la compra y un árbol predice que no comprará, entonces la predicción final será la compra. En este caso, se prevé que el cliente comprará.</p>
<p>El siguiente diagrama muestra un clasificador de bosque aleatorio simple.</p>
<p><img src="img/05-sup/rf/3-10-3-bosques-aleatorios-clasificador.png" width="600pt" height="300pt" style="display: block; margin: auto;" /></p>
<p><img src="img/05-sup/rf/3-13-1-randomforest.png" width="600pt" height="300pt" style="display: block; margin: auto;" /></p>
</div>
<div id="ventajas-y-desventjas-de-bosques-aleatorios" class="section level3" number="5.8.4">
<h3><span class="header-section-number">5.8.4</span> Ventajas y desventjas de bosques aleatorios</h3>
<p><strong>Ventajas</strong></p>
<ul>
<li><p>Puede realizar tareas de regresión y clasificación.</p></li>
<li><p>Un bosque aleatorio produce buenas predicciones que se pueden entender fácilmente.</p></li>
<li><p>Puede manejar grandes conjuntos de datos de manera eficiente.</p></li>
<li><p>Proporciona un mayor nivel de precisión en la predicción de resultados sobre el algoritmo del árbol de decisión.</p></li>
</ul>
<p><strong>Desventajas</strong></p>
<ul>
<li><p>Cuando se usa un bosque aleatorio, se requieren bastantes recursos para el cálculo.</p></li>
<li><p>Consume más tiempo en comparación con un algoritmo de árbol de decisiones.</p></li>
<li><p>No producen buenos resultados cuando los datos son muy escasos. En este caso, el subconjunto de características y la muestra de arranque producirán un espacio invariante. Esto conducirá a divisiones improductivas, que afectarán el resultado.</p></li>
</ul>
</div>
<div id="bosques-aleatorios-para-modelo-de-regresión" class="section level3" number="5.8.5">
<h3><span class="header-section-number">5.8.5</span> Bosques aleatorios para modelo de regresión</h3>
<p>Para implementar este algoritmo en <em>R</em> utilizaremos la función <code>rand_forest</code> de la paquetería <em>parsnip</em>, esta función define un modelo que crea una gran cantidad de árboles de decisión, cada uno independiente de los demás. La predicción final utiliza todas las predicciones de los árboles individuales y las combina.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="aprendizaje-supervisado-1.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se declara el modelo de clasificación</span></span>
<span id="cb219-2"><a href="aprendizaje-supervisado-1.html#cb219-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-3"><a href="aprendizaje-supervisado-1.html#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ranger)</span>
<span id="cb219-4"><a href="aprendizaje-supervisado-1.html#cb219-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-5"><a href="aprendizaje-supervisado-1.html#cb219-5" aria-hidden="true" tabindex="-1"></a>rforest_model <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>(</span>
<span id="cb219-6"><a href="aprendizaje-supervisado-1.html#cb219-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">&quot;regression&quot;</span>,</span>
<span id="cb219-7"><a href="aprendizaje-supervisado-1.html#cb219-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">trees =</span> <span class="dv">1000</span>,</span>
<span id="cb219-8"><a href="aprendizaje-supervisado-1.html#cb219-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">mtry =</span> <span class="fu">tune</span>(),</span>
<span id="cb219-9"><a href="aprendizaje-supervisado-1.html#cb219-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_n =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb219-10"><a href="aprendizaje-supervisado-1.html#cb219-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;ranger&quot;</span>, <span class="at">importance =</span> <span class="st">&quot;impurity&quot;</span>)</span>
<span id="cb219-11"><a href="aprendizaje-supervisado-1.html#cb219-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-12"><a href="aprendizaje-supervisado-1.html#cb219-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-13"><a href="aprendizaje-supervisado-1.html#cb219-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Se declara el flujo de trabajo</span></span>
<span id="cb219-14"><a href="aprendizaje-supervisado-1.html#cb219-14" aria-hidden="true" tabindex="-1"></a>rforest_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb219-15"><a href="aprendizaje-supervisado-1.html#cb219-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(rforest_model) <span class="sc">%&gt;%</span></span>
<span id="cb219-16"><a href="aprendizaje-supervisado-1.html#cb219-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(receta_casas)</span>
<span id="cb219-17"><a href="aprendizaje-supervisado-1.html#cb219-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-18"><a href="aprendizaje-supervisado-1.html#cb219-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Declaración del grid</span></span>
<span id="cb219-19"><a href="aprendizaje-supervisado-1.html#cb219-19" aria-hidden="true" tabindex="-1"></a>rforest_param_grid <span class="ot">&lt;-</span> <span class="fu">grid_regular</span>(</span>
<span id="cb219-20"><a href="aprendizaje-supervisado-1.html#cb219-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtry</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">15</span>)),</span>
<span id="cb219-21"><a href="aprendizaje-supervisado-1.html#cb219-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min_n</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">16</span>)),</span>
<span id="cb219-22"><a href="aprendizaje-supervisado-1.html#cb219-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">18</span>)</span>
<span id="cb219-23"><a href="aprendizaje-supervisado-1.html#cb219-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb219-24"><a href="aprendizaje-supervisado-1.html#cb219-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-25"><a href="aprendizaje-supervisado-1.html#cb219-25" aria-hidden="true" tabindex="-1"></a>ctrl_grid <span class="ot">&lt;-</span> <span class="fu">control_grid</span>(<span class="at">save_pred =</span> T, <span class="at">verbose =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="aprendizaje-supervisado-1.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb220-2"><a href="aprendizaje-supervisado-1.html#cb220-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-3"><a href="aprendizaje-supervisado-1.html#cb220-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  Creación del cluster de trabajo</span></span>
<span id="cb220-4"><a href="aprendizaje-supervisado-1.html#cb220-4" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb220-5"><a href="aprendizaje-supervisado-1.html#cb220-5" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb220-6"><a href="aprendizaje-supervisado-1.html#cb220-6" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb220-7"><a href="aprendizaje-supervisado-1.html#cb220-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-8"><a href="aprendizaje-supervisado-1.html#cb220-8" aria-hidden="true" tabindex="-1"></a><span class="co"># V fold cross validation</span></span>
<span id="cb220-9"><a href="aprendizaje-supervisado-1.html#cb220-9" aria-hidden="true" tabindex="-1"></a>ames_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(ames_train, <span class="at">v =</span> <span class="dv">10</span>)</span>
<span id="cb220-10"><a href="aprendizaje-supervisado-1.html#cb220-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-11"><a href="aprendizaje-supervisado-1.html#cb220-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste de parámetros</span></span>
<span id="cb220-12"><a href="aprendizaje-supervisado-1.html#cb220-12" aria-hidden="true" tabindex="-1"></a>rft1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb220-13"><a href="aprendizaje-supervisado-1.html#cb220-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-14"><a href="aprendizaje-supervisado-1.html#cb220-14" aria-hidden="true" tabindex="-1"></a>rforest_tune_result <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb220-15"><a href="aprendizaje-supervisado-1.html#cb220-15" aria-hidden="true" tabindex="-1"></a>  rforest_workflow,</span>
<span id="cb220-16"><a href="aprendizaje-supervisado-1.html#cb220-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> ames_folds,</span>
<span id="cb220-17"><a href="aprendizaje-supervisado-1.html#cb220-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> rforest_param_grid,</span>
<span id="cb220-18"><a href="aprendizaje-supervisado-1.html#cb220-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, rsq, mae),</span>
<span id="cb220-19"><a href="aprendizaje-supervisado-1.html#cb220-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> ctrl_grid</span>
<span id="cb220-20"><a href="aprendizaje-supervisado-1.html#cb220-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb220-21"><a href="aprendizaje-supervisado-1.html#cb220-21" aria-hidden="true" tabindex="-1"></a>rft2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>(); rft2 <span class="sc">-</span> rft1</span>
<span id="cb220-22"><a href="aprendizaje-supervisado-1.html#cb220-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-23"><a href="aprendizaje-supervisado-1.html#cb220-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Se detiene el cluster</span></span>
<span id="cb220-24"><a href="aprendizaje-supervisado-1.html#cb220-24" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb220-25"><a href="aprendizaje-supervisado-1.html#cb220-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-26"><a href="aprendizaje-supervisado-1.html#cb220-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Se guardan los resultados en formato RDS</span></span>
<span id="cb220-27"><a href="aprendizaje-supervisado-1.html#cb220-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-28"><a href="aprendizaje-supervisado-1.html#cb220-28" aria-hidden="true" tabindex="-1"></a>rforest_tune_result <span class="sc">%&gt;%</span> <span class="fu">saveRDS</span>(<span class="st">&quot;models/random_forest_model_reg.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="aprendizaje-supervisado-1.html#cb221-1" aria-hidden="true" tabindex="-1"></a>rforest_tune_result <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;models/random_forest_model_reg.rds&quot;</span>)</span>
<span id="cb221-2"><a href="aprendizaje-supervisado-1.html#cb221-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-3"><a href="aprendizaje-supervisado-1.html#cb221-3" aria-hidden="true" tabindex="-1"></a><span class="co"># R cuadrada </span></span>
<span id="cb221-4"><a href="aprendizaje-supervisado-1.html#cb221-4" aria-hidden="true" tabindex="-1"></a>rforest_tune_result <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>) <span class="sc">+</span></span>
<span id="cb221-5"><a href="aprendizaje-supervisado-1.html#cb221-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Número mínimo de elementos por nodo&#39;</span>)<span class="sc">+</span></span>
<span id="cb221-6"><a href="aprendizaje-supervisado-1.html#cb221-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;R cuadrada&#39;</span>)<span class="sc">+</span></span>
<span id="cb221-7"><a href="aprendizaje-supervisado-1.html#cb221-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Gráfica R cuadrada&#39;</span>)<span class="sc">+</span></span>
<span id="cb221-8"><a href="aprendizaje-supervisado-1.html#cb221-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&#39;Número de ramas&#39;</span>))<span class="sc">+</span></span>
<span id="cb221-9"><a href="aprendizaje-supervisado-1.html#cb221-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-256-1.png" width="672" /></p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="aprendizaje-supervisado-1.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen de métricas</span></span>
<span id="cb222-2"><a href="aprendizaje-supervisado-1.html#cb222-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-3"><a href="aprendizaje-supervisado-1.html#cb222-3" aria-hidden="true" tabindex="-1"></a>rforest_tune_result <span class="sc">%&gt;%</span></span>
<span id="cb222-4"><a href="aprendizaje-supervisado-1.html#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb222-5"><a href="aprendizaje-supervisado-1.html#cb222-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.metric) <span class="sc">%&gt;%</span></span>
<span id="cb222-6"><a href="aprendizaje-supervisado-1.html#cb222-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb222-7"><a href="aprendizaje-supervisado-1.html#cb222-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_max =</span> <span class="fu">max</span>(mean),</span>
<span id="cb222-8"><a href="aprendizaje-supervisado-1.html#cb222-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_min =</span> <span class="fu">min</span>(mean),</span>
<span id="cb222-9"><a href="aprendizaje-supervisado-1.html#cb222-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_mean =</span> <span class="fu">mean</span>(mean),</span>
<span id="cb222-10"><a href="aprendizaje-supervisado-1.html#cb222-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_median =</span> <span class="fu">median</span>(mean),</span>
<span id="cb222-11"><a href="aprendizaje-supervisado-1.html#cb222-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb222-12"><a href="aprendizaje-supervisado-1.html#cb222-12" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 3 × 5
##   .metric   mean_max   mean_min  mean_mean mean_median
##   &lt;chr&gt;        &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1 mae     180543.    180543.    180543.     180543.   
## 2 rmse    197194.    197194.    197194.     197194.   
## 3 rsq          0.777      0.766      0.772       0.772</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="aprendizaje-supervisado-1.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mejores 10 resultados</span></span>
<span id="cb224-2"><a href="aprendizaje-supervisado-1.html#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(rforest_tune_result, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb224-3"><a href="aprendizaje-supervisado-1.html#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span></code></pre></div>
<pre><code>##    mtry min_n .metric .estimator      mean  n    std_err                .config
## 1     8     2     rsq   standard 0.7773207 10 0.01428446 Preprocessor1_Model001
## 2     8     3     rsq   standard 0.7769947 10 0.01416865 Preprocessor1_Model009
## 3     8     4     rsq   standard 0.7769923 10 0.01438773 Preprocessor1_Model017
## 4     8     7     rsq   standard 0.7767768 10 0.01426232 Preprocessor1_Model041
## 5     8     5     rsq   standard 0.7767364 10 0.01448987 Preprocessor1_Model025
## 6     8     6     rsq   standard 0.7765816 10 0.01450118 Preprocessor1_Model033
## 7     8     9     rsq   standard 0.7762883 10 0.01439961 Preprocessor1_Model057
## 8     9     2     rsq   standard 0.7761141 10 0.01466429 Preprocessor1_Model002
## 9     9     6     rsq   standard 0.7759585 10 0.01439145 Preprocessor1_Model034
## 10    8     8     rsq   standard 0.7757190 10 0.01460913 Preprocessor1_Model049</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="aprendizaje-supervisado-1.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección del mejor modelo según la métrica r cuadrada</span></span>
<span id="cb226-2"><a href="aprendizaje-supervisado-1.html#cb226-2" aria-hidden="true" tabindex="-1"></a>best_rforest_model <span class="ot">&lt;-</span> <span class="fu">select_best</span>(rforest_tune_result, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>)</span>
<span id="cb226-3"><a href="aprendizaje-supervisado-1.html#cb226-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-4"><a href="aprendizaje-supervisado-1.html#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección del mejor modelo por un error estándar</span></span>
<span id="cb226-5"><a href="aprendizaje-supervisado-1.html#cb226-5" aria-hidden="true" tabindex="-1"></a>best_rforest_model_1se <span class="ot">&lt;-</span> <span class="fu">select_by_one_std_err</span>(</span>
<span id="cb226-6"><a href="aprendizaje-supervisado-1.html#cb226-6" aria-hidden="true" tabindex="-1"></a>  rforest_tune_result, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>, <span class="st">&quot;rsq&quot;</span>)</span>
<span id="cb226-7"><a href="aprendizaje-supervisado-1.html#cb226-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-8"><a href="aprendizaje-supervisado-1.html#cb226-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección del mejor modelo</span></span>
<span id="cb226-9"><a href="aprendizaje-supervisado-1.html#cb226-9" aria-hidden="true" tabindex="-1"></a>final_rforest_model <span class="ot">&lt;-</span> rforest_workflow <span class="sc">%&gt;%</span></span>
<span id="cb226-10"><a href="aprendizaje-supervisado-1.html#cb226-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#finalize_workflow(best_rforest_model) %&gt;%</span></span>
<span id="cb226-11"><a href="aprendizaje-supervisado-1.html#cb226-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(best_rforest_model_1se) <span class="sc">%&gt;%</span></span>
<span id="cb226-12"><a href="aprendizaje-supervisado-1.html#cb226-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> ames_train)</span></code></pre></div>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="aprendizaje-supervisado-1.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicciones</span></span>
<span id="cb227-2"><a href="aprendizaje-supervisado-1.html#cb227-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_rforest_model, ames_test) <span class="sc">%&gt;%</span></span>
<span id="cb227-3"><a href="aprendizaje-supervisado-1.html#cb227-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(<span class="at">truth =</span> ames_test<span class="sc">$</span>Sale_Price) <span class="sc">%&gt;%</span></span>
<span id="cb227-4"><a href="aprendizaje-supervisado-1.html#cb227-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">pred_rforest_model =</span> .pred, <span class="at">Sale_Price =</span> truth)</span>
<span id="cb227-5"><a href="aprendizaje-supervisado-1.html#cb227-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-6"><a href="aprendizaje-supervisado-1.html#cb227-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 2
##    pred_rforest_model Sale_Price
##                 &lt;dbl&gt;      &lt;int&gt;
##  1               11.8     105000
##  2               12.1     185000
##  3               12.1     180400
##  4               11.5     141000
##  5               12.2     210000
##  6               12.2     216000
##  7               12.0     149900
##  8               11.6     105500
##  9               11.6      88000
## 10               11.9     146000</code></pre>
</div>
<div id="bosques-aleatorios-para-modelo-de-clasificación" class="section level3" number="5.8.6">
<h3><span class="header-section-number">5.8.6</span> Bosques aleatorios para modelo de clasificación</h3>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="aprendizaje-supervisado-1.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se declara el modelo de clasificación</span></span>
<span id="cb229-2"><a href="aprendizaje-supervisado-1.html#cb229-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-3"><a href="aprendizaje-supervisado-1.html#cb229-3" aria-hidden="true" tabindex="-1"></a>rforest_model <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>(</span>
<span id="cb229-4"><a href="aprendizaje-supervisado-1.html#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">&quot;classification&quot;</span>,</span>
<span id="cb229-5"><a href="aprendizaje-supervisado-1.html#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">trees =</span> <span class="dv">1000</span>,</span>
<span id="cb229-6"><a href="aprendizaje-supervisado-1.html#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mtry =</span> <span class="fu">tune</span>(),</span>
<span id="cb229-7"><a href="aprendizaje-supervisado-1.html#cb229-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_n =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb229-8"><a href="aprendizaje-supervisado-1.html#cb229-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;ranger&quot;</span>, <span class="at">importance =</span> <span class="st">&quot;impurity&quot;</span>)</span>
<span id="cb229-9"><a href="aprendizaje-supervisado-1.html#cb229-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-10"><a href="aprendizaje-supervisado-1.html#cb229-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Se declara el flujo de trabajo</span></span>
<span id="cb229-11"><a href="aprendizaje-supervisado-1.html#cb229-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-12"><a href="aprendizaje-supervisado-1.html#cb229-12" aria-hidden="true" tabindex="-1"></a>rforest_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb229-13"><a href="aprendizaje-supervisado-1.html#cb229-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(rforest_model) <span class="sc">%&gt;%</span></span>
<span id="cb229-14"><a href="aprendizaje-supervisado-1.html#cb229-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(telco_rec)</span>
<span id="cb229-15"><a href="aprendizaje-supervisado-1.html#cb229-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-16"><a href="aprendizaje-supervisado-1.html#cb229-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Declaración del grid</span></span>
<span id="cb229-17"><a href="aprendizaje-supervisado-1.html#cb229-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-18"><a href="aprendizaje-supervisado-1.html#cb229-18" aria-hidden="true" tabindex="-1"></a>rforest_param_grid <span class="ot">&lt;-</span> <span class="fu">grid_regular</span>(</span>
<span id="cb229-19"><a href="aprendizaje-supervisado-1.html#cb229-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtry</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">15</span>)),</span>
<span id="cb229-20"><a href="aprendizaje-supervisado-1.html#cb229-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min_n</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">16</span>)),</span>
<span id="cb229-21"><a href="aprendizaje-supervisado-1.html#cb229-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">8</span>)</span>
<span id="cb229-22"><a href="aprendizaje-supervisado-1.html#cb229-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb229-23"><a href="aprendizaje-supervisado-1.html#cb229-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-24"><a href="aprendizaje-supervisado-1.html#cb229-24" aria-hidden="true" tabindex="-1"></a>ctrl_grid <span class="ot">&lt;-</span> <span class="fu">control_grid</span>(<span class="at">save_pred =</span> T, <span class="at">verbose =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="aprendizaje-supervisado-1.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb230-2"><a href="aprendizaje-supervisado-1.html#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ranger)</span>
<span id="cb230-3"><a href="aprendizaje-supervisado-1.html#cb230-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-4"><a href="aprendizaje-supervisado-1.html#cb230-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  Creación del cluster de trabajo</span></span>
<span id="cb230-5"><a href="aprendizaje-supervisado-1.html#cb230-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-6"><a href="aprendizaje-supervisado-1.html#cb230-6" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb230-7"><a href="aprendizaje-supervisado-1.html#cb230-7" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb230-8"><a href="aprendizaje-supervisado-1.html#cb230-8" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb230-9"><a href="aprendizaje-supervisado-1.html#cb230-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-10"><a href="aprendizaje-supervisado-1.html#cb230-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste de parámetros</span></span>
<span id="cb230-11"><a href="aprendizaje-supervisado-1.html#cb230-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-12"><a href="aprendizaje-supervisado-1.html#cb230-12" aria-hidden="true" tabindex="-1"></a>rft1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb230-13"><a href="aprendizaje-supervisado-1.html#cb230-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-14"><a href="aprendizaje-supervisado-1.html#cb230-14" aria-hidden="true" tabindex="-1"></a>rforest_tune_result <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb230-15"><a href="aprendizaje-supervisado-1.html#cb230-15" aria-hidden="true" tabindex="-1"></a>  rforest_workflow,</span>
<span id="cb230-16"><a href="aprendizaje-supervisado-1.html#cb230-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> telco_folds,</span>
<span id="cb230-17"><a href="aprendizaje-supervisado-1.html#cb230-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> rforest_param_grid,</span>
<span id="cb230-18"><a href="aprendizaje-supervisado-1.html#cb230-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(roc_auc, pr_auc, sens),</span>
<span id="cb230-19"><a href="aprendizaje-supervisado-1.html#cb230-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> ctrl_grid</span>
<span id="cb230-20"><a href="aprendizaje-supervisado-1.html#cb230-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb230-21"><a href="aprendizaje-supervisado-1.html#cb230-21" aria-hidden="true" tabindex="-1"></a>rft2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>(); rft2 <span class="sc">-</span> rft1</span>
<span id="cb230-22"><a href="aprendizaje-supervisado-1.html#cb230-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-23"><a href="aprendizaje-supervisado-1.html#cb230-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Se detiene el cluster</span></span>
<span id="cb230-24"><a href="aprendizaje-supervisado-1.html#cb230-24" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb230-25"><a href="aprendizaje-supervisado-1.html#cb230-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-26"><a href="aprendizaje-supervisado-1.html#cb230-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Se guardan los resultados en formato RDS</span></span>
<span id="cb230-27"><a href="aprendizaje-supervisado-1.html#cb230-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-28"><a href="aprendizaje-supervisado-1.html#cb230-28" aria-hidden="true" tabindex="-1"></a>rforest_tune_result <span class="sc">%&gt;%</span> <span class="fu">saveRDS</span>(<span class="st">&quot;models/random_forest_model.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="aprendizaje-supervisado-1.html#cb231-1" aria-hidden="true" tabindex="-1"></a>rforest_tune_result <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;models/random_forest_model.rds&quot;</span>)</span>
<span id="cb231-2"><a href="aprendizaje-supervisado-1.html#cb231-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-3"><a href="aprendizaje-supervisado-1.html#cb231-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Curva de precisión</span></span>
<span id="cb231-4"><a href="aprendizaje-supervisado-1.html#cb231-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-5"><a href="aprendizaje-supervisado-1.html#cb231-5" aria-hidden="true" tabindex="-1"></a>rforest_tune_result <span class="sc">%&gt;%</span></span>
<span id="cb231-6"><a href="aprendizaje-supervisado-1.html#cb231-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(.metrics) <span class="sc">%&gt;%</span></span>
<span id="cb231-7"><a href="aprendizaje-supervisado-1.html#cb231-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">&quot;pr_auc&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb231-8"><a href="aprendizaje-supervisado-1.html#cb231-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mtry, <span class="at">y =</span> .estimate)) <span class="sc">+</span></span>
<span id="cb231-9"><a href="aprendizaje-supervisado-1.html#cb231-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb231-10"><a href="aprendizaje-supervisado-1.html#cb231-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> id))<span class="sc">+</span></span>
<span id="cb231-11"><a href="aprendizaje-supervisado-1.html#cb231-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Gráfica de precisión&#39;</span>) <span class="sc">+</span></span>
<span id="cb231-12"><a href="aprendizaje-supervisado-1.html#cb231-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-262-1.png" width="672" /></p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="aprendizaje-supervisado-1.html#cb232-1" aria-hidden="true" tabindex="-1"></a>rforest_tune_result <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(<span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>) <span class="sc">+</span></span>
<span id="cb232-2"><a href="aprendizaje-supervisado-1.html#cb232-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Número mínimo de elementos por nodo&#39;</span>)<span class="sc">+</span></span>
<span id="cb232-3"><a href="aprendizaje-supervisado-1.html#cb232-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Precisión&#39;</span>)<span class="sc">+</span></span>
<span id="cb232-4"><a href="aprendizaje-supervisado-1.html#cb232-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Gráfica de precisión por tamaño de nodos&#39;</span>)<span class="sc">+</span></span>
<span id="cb232-5"><a href="aprendizaje-supervisado-1.html#cb232-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&#39;Número de ramas&#39;</span>))<span class="sc">+</span></span>
<span id="cb232-6"><a href="aprendizaje-supervisado-1.html#cb232-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-262-2.png" width="672" /></p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="aprendizaje-supervisado-1.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen de métricas</span></span>
<span id="cb233-2"><a href="aprendizaje-supervisado-1.html#cb233-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-3"><a href="aprendizaje-supervisado-1.html#cb233-3" aria-hidden="true" tabindex="-1"></a>rforest_tune_result <span class="sc">%&gt;%</span></span>
<span id="cb233-4"><a href="aprendizaje-supervisado-1.html#cb233-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb233-5"><a href="aprendizaje-supervisado-1.html#cb233-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.metric) <span class="sc">%&gt;%</span></span>
<span id="cb233-6"><a href="aprendizaje-supervisado-1.html#cb233-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb233-7"><a href="aprendizaje-supervisado-1.html#cb233-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_max =</span> <span class="fu">max</span>(mean),</span>
<span id="cb233-8"><a href="aprendizaje-supervisado-1.html#cb233-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_min =</span> <span class="fu">min</span>(mean),</span>
<span id="cb233-9"><a href="aprendizaje-supervisado-1.html#cb233-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_mean =</span> <span class="fu">mean</span>(mean),</span>
<span id="cb233-10"><a href="aprendizaje-supervisado-1.html#cb233-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_median =</span> <span class="fu">median</span>(mean),</span>
<span id="cb233-11"><a href="aprendizaje-supervisado-1.html#cb233-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb233-12"><a href="aprendizaje-supervisado-1.html#cb233-12" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<pre><code>## # A tibble: 3 × 5
##   .metric mean_max mean_min mean_mean mean_median
##   &lt;chr&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
## 1 pr_auc     0.914    0.906     0.910       0.910
## 2 roc_auc    0.798    0.781     0.790       0.790
## 3 sens       0.893    0.871     0.883       0.884</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="aprendizaje-supervisado-1.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mejores 20 resultados</span></span>
<span id="cb235-2"><a href="aprendizaje-supervisado-1.html#cb235-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-3"><a href="aprendizaje-supervisado-1.html#cb235-3" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(rforest_tune_result, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>) </span></code></pre></div>
<pre><code>## # A tibble: 20 × 8
##     mtry min_n .metric .estimator  mean     n std_err .config              
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                
##  1    10    16 pr_auc  binary     0.914    10 0.00330 Preprocessor1_Model45
##  2    12    16 pr_auc  binary     0.913    10 0.00341 Preprocessor1_Model46
##  3     8    16 pr_auc  binary     0.913    10 0.00360 Preprocessor1_Model43
##  4     9    16 pr_auc  binary     0.913    10 0.00343 Preprocessor1_Model44
##  5     9    14 pr_auc  binary     0.913    10 0.00340 Preprocessor1_Model38
##  6    13    16 pr_auc  binary     0.913    10 0.00330 Preprocessor1_Model47
##  7    10    14 pr_auc  binary     0.913    10 0.00338 Preprocessor1_Model39
##  8    15    16 pr_auc  binary     0.913    10 0.00341 Preprocessor1_Model48
##  9    15    14 pr_auc  binary     0.913    10 0.00337 Preprocessor1_Model42
## 10    12    14 pr_auc  binary     0.912    10 0.00341 Preprocessor1_Model40
## 11    13    14 pr_auc  binary     0.912    10 0.00332 Preprocessor1_Model41
## 12     8    14 pr_auc  binary     0.912    10 0.00346 Preprocessor1_Model37
## 13    13    12 pr_auc  binary     0.912    10 0.00338 Preprocessor1_Model35
## 14    10    12 pr_auc  binary     0.912    10 0.00329 Preprocessor1_Model33
## 15    12    12 pr_auc  binary     0.912    10 0.00324 Preprocessor1_Model34
## 16     9    12 pr_auc  binary     0.912    10 0.00332 Preprocessor1_Model32
## 17    15    12 pr_auc  binary     0.912    10 0.00336 Preprocessor1_Model36
## 18     8    12 pr_auc  binary     0.912    10 0.00347 Preprocessor1_Model31
## 19    15    10 pr_auc  binary     0.911    10 0.00340 Preprocessor1_Model30
## 20    10    10 pr_auc  binary     0.911    10 0.00346 Preprocessor1_Model27</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="aprendizaje-supervisado-1.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección del mejor modelo según la métrica de precisión</span></span>
<span id="cb237-2"><a href="aprendizaje-supervisado-1.html#cb237-2" aria-hidden="true" tabindex="-1"></a>best_rforest_model <span class="ot">&lt;-</span> <span class="fu">select_best</span>(rforest_tune_result, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>)</span>
<span id="cb237-3"><a href="aprendizaje-supervisado-1.html#cb237-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4"><a href="aprendizaje-supervisado-1.html#cb237-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección del mejor modelo por un error estándar</span></span>
<span id="cb237-5"><a href="aprendizaje-supervisado-1.html#cb237-5" aria-hidden="true" tabindex="-1"></a>best_rforest_model_1se <span class="ot">&lt;-</span> <span class="fu">select_by_one_std_err</span>(</span>
<span id="cb237-6"><a href="aprendizaje-supervisado-1.html#cb237-6" aria-hidden="true" tabindex="-1"></a>  rforest_tune_result, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>, <span class="st">&quot;pr_auc&quot;</span>)</span>
<span id="cb237-7"><a href="aprendizaje-supervisado-1.html#cb237-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-8"><a href="aprendizaje-supervisado-1.html#cb237-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección del mejor modelo</span></span>
<span id="cb237-9"><a href="aprendizaje-supervisado-1.html#cb237-9" aria-hidden="true" tabindex="-1"></a>final_rforest_model <span class="ot">&lt;-</span> rforest_workflow <span class="sc">%&gt;%</span></span>
<span id="cb237-10"><a href="aprendizaje-supervisado-1.html#cb237-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(best_rforest_model_1se) <span class="sc">%&gt;%</span></span>
<span id="cb237-11"><a href="aprendizaje-supervisado-1.html#cb237-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> telco_train)</span></code></pre></div>
<pre><code>## Warning: 8 columns were requested but there were 3 predictors in the data. 3
## will be used.</code></pre>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="aprendizaje-supervisado-1.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicciones</span></span>
<span id="cb239-2"><a href="aprendizaje-supervisado-1.html#cb239-2" aria-hidden="true" tabindex="-1"></a>results_rforest_clas <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_rforest_model, telco_test, <span class="at">type =</span> <span class="st">&#39;prob&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb239-3"><a href="aprendizaje-supervisado-1.html#cb239-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(<span class="at">truth =</span>telco_test<span class="sc">$</span>Churn) <span class="sc">%&gt;%</span></span>
<span id="cb239-4"><a href="aprendizaje-supervisado-1.html#cb239-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">truth =</span> <span class="fu">factor</span>(truth, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;No&#39;</span>, <span class="st">&#39;Yes&#39;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;No&#39;</span>, <span class="st">&#39;Yes&#39;</span>)))</span>
<span id="cb239-5"><a href="aprendizaje-supervisado-1.html#cb239-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-6"><a href="aprendizaje-supervisado-1.html#cb239-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results_rforest_clas, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    .pred_No .pred_Yes truth
##       &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;
##  1    0.943  0.0566   No   
##  2    0.199  0.801    Yes  
##  3    0.589  0.411    No   
##  4    0.989  0.0107   No   
##  5    0.970  0.0303   No   
##  6    0.407  0.593    No   
##  7    0.990  0.0102   No   
##  8    0.774  0.226    No   
##  9    0.484  0.516    Yes  
## 10    1.00   0.000393 No</code></pre>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="aprendizaje-supervisado-1.html#cb241-1" aria-hidden="true" tabindex="-1"></a>results_cla_rforest <span class="ot">&lt;-</span>results_rforest_clas</span></code></pre></div>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="aprendizaje-supervisado-1.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Curvas pecision recall y ROC</span></span>
<span id="cb242-2"><a href="aprendizaje-supervisado-1.html#cb242-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-3"><a href="aprendizaje-supervisado-1.html#cb242-3" aria-hidden="true" tabindex="-1"></a>pr_curve_rforest_clas <span class="ot">&lt;-</span> <span class="fu">pr_curve</span>(results_rforest_clas, <span class="at">truth =</span> truth, <span class="at">estimate =</span> .pred_Yes, <span class="at">event_level =</span> <span class="st">&#39;second&#39;</span>)</span>
<span id="cb242-4"><a href="aprendizaje-supervisado-1.html#cb242-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-5"><a href="aprendizaje-supervisado-1.html#cb242-5" aria-hidden="true" tabindex="-1"></a>roc_curve_rforest_clas <span class="ot">&lt;-</span> <span class="fu">roc_curve</span>(results_rforest_clas, <span class="at">truth =</span> truth, <span class="at">estimate =</span> .pred_Yes, <span class="at">event_level =</span> <span class="st">&#39;second&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="aprendizaje-supervisado-1.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb243-2"><a href="aprendizaje-supervisado-1.html#cb243-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-3"><a href="aprendizaje-supervisado-1.html#cb243-3" aria-hidden="true" tabindex="-1"></a>pr_curve_plot <span class="ot">&lt;-</span> pr_curve_rforest_clas <span class="sc">%&gt;%</span></span>
<span id="cb243-4"><a href="aprendizaje-supervisado-1.html#cb243-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> recall, <span class="at">y =</span> precision)) <span class="sc">+</span></span>
<span id="cb243-5"><a href="aprendizaje-supervisado-1.html#cb243-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&#39;lightblue&#39;</span>) <span class="sc">+</span></span>
<span id="cb243-6"><a href="aprendizaje-supervisado-1.html#cb243-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb243-7"><a href="aprendizaje-supervisado-1.html#cb243-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Precision vs Recall&quot;</span>)<span class="sc">+</span></span>
<span id="cb243-8"><a href="aprendizaje-supervisado-1.html#cb243-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb243-9"><a href="aprendizaje-supervisado-1.html#cb243-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-10"><a href="aprendizaje-supervisado-1.html#cb243-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-11"><a href="aprendizaje-supervisado-1.html#cb243-11" aria-hidden="true" tabindex="-1"></a>roc_curve_plot <span class="ot">&lt;-</span> roc_curve_rforest_clas <span class="sc">%&gt;%</span></span>
<span id="cb243-12"><a href="aprendizaje-supervisado-1.html#cb243-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span> <span class="sc">-</span> specificity, <span class="at">y =</span> sensitivity)) <span class="sc">+</span></span>
<span id="cb243-13"><a href="aprendizaje-supervisado-1.html#cb243-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&#39;lightblue&#39;</span>) <span class="sc">+</span></span>
<span id="cb243-14"><a href="aprendizaje-supervisado-1.html#cb243-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb243-15"><a href="aprendizaje-supervisado-1.html#cb243-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb243-16"><a href="aprendizaje-supervisado-1.html#cb243-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;ROC Curve&quot;</span>)<span class="sc">+</span></span>
<span id="cb243-17"><a href="aprendizaje-supervisado-1.html#cb243-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb243-18"><a href="aprendizaje-supervisado-1.html#cb243-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-19"><a href="aprendizaje-supervisado-1.html#cb243-19" aria-hidden="true" tabindex="-1"></a>pr_curve_plot <span class="sc">+</span> roc_curve_plot</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-267-1.png" width="672" /></p>
</div>
<div id="importancia-de-las-variables" class="section level3" number="5.8.7">
<h3><span class="header-section-number">5.8.7</span> Importancia de las variables</h3>
<p>Después de entrenar un modelo, es natural preguntarse qué variables tienen el mayor poder predictivo. Las variables de gran importancia son impulsoras del resultado y sus valores tienen un impacto significativo en los valores del resultado. Por el contrario, las variables con poca importancia pueden omitirse de un modelo, lo que lo hace más simple y rápido de ajustar y predecir.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="aprendizaje-supervisado-1.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb244-2"><a href="aprendizaje-supervisado-1.html#cb244-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-3"><a href="aprendizaje-supervisado-1.html#cb244-3" aria-hidden="true" tabindex="-1"></a>final_rforest_model <span class="sc">%&gt;%</span></span>
<span id="cb244-4"><a href="aprendizaje-supervisado-1.html#cb244-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull_workflow_fit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb244-5"><a href="aprendizaje-supervisado-1.html#cb244-5" aria-hidden="true" tabindex="-1"></a>  vip<span class="sc">::</span><span class="fu">vip</span>() <span class="sc">+</span> </span>
<span id="cb244-6"><a href="aprendizaje-supervisado-1.html#cb244-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Importancia de las variables&quot;</span>)<span class="sc">+</span> </span>
<span id="cb244-7"><a href="aprendizaje-supervisado-1.html#cb244-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: `pull_workflow_fit()` was deprecated in workflows 0.2.3.
## Please use `extract_fit_parsnip()` instead.</code></pre>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-268-1.png" width="672" /></p>
<p>Existen dos medidas de importancia para cada variable en el bosque aleatorio:</p>
<ul>
<li>La primera medida se basa en <strong>cuánto disminuye la precisión</strong> cuando se excluye la variable.</li>
</ul>
<p>Primero, se mide la precisión de la predicción en la muestra fuera de la bolsa. Luego, los valores de la variable en la muestra fuera de la bolsa se mezclan aleatoriamente, manteniendo todas las demás variables iguales. Finalmente, se mide la disminución en la precisión de la predicción en los datos mezclados.</p>
<p>Se reporta la disminución media de la precisión en todos los árboles.</p>
<ul>
<li>La segunda medida se basa en la disminución de la impureza de <strong>Gini</strong> cuando se elige una variable para dividir un nodo.</li>
</ul>
<p>Cuando se construye un árbol, la decisión sobre qué variable dividir en cada nodo utiliza un cálculo de la impureza de Gini.</p>
<p>Para cada variable, la suma de la disminución de Gini en cada árbol del bosque se acumula cada vez que se elige esa variable para dividir un nodo. La suma se divide entre la cantidad de árboles en el bosque para obtener un promedio. La escala es irrelevante: solo importan los valores relativos.</p>
<p>Ve este <a href="https://bambielli.com/til/2017-10-29-gini-impurity/">artículo</a> para más información sobre la impureza de Gini.</p>
</div>
</div>
<div id="comparación-de-modelos" class="section level2" number="5.9">
<h2><span class="header-section-number">5.9</span> Comparación de modelos</h2>
<p>Comparemos las curvas <em>ROC</em> y <em>Precision-Recall</em> de los modelos de clasificación
que hemos creado</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="aprendizaje-supervisado-1.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Curvas pecision recall y ROC</span></span>
<span id="cb246-2"><a href="aprendizaje-supervisado-1.html#cb246-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-3"><a href="aprendizaje-supervisado-1.html#cb246-3" aria-hidden="true" tabindex="-1"></a>pr_curve_plot <span class="ot">&lt;-</span> results_pr_curve <span class="sc">%&gt;%</span></span>
<span id="cb246-4"><a href="aprendizaje-supervisado-1.html#cb246-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> recall, <span class="at">y =</span> precision, <span class="at">color =</span> ID)) <span class="sc">+</span></span>
<span id="cb246-5"><a href="aprendizaje-supervisado-1.html#cb246-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb246-6"><a href="aprendizaje-supervisado-1.html#cb246-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb246-7"><a href="aprendizaje-supervisado-1.html#cb246-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Precision vs Recall&quot;</span>)<span class="sc">+</span></span>
<span id="cb246-8"><a href="aprendizaje-supervisado-1.html#cb246-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb246-9"><a href="aprendizaje-supervisado-1.html#cb246-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-10"><a href="aprendizaje-supervisado-1.html#cb246-10" aria-hidden="true" tabindex="-1"></a>roc_curve_plot <span class="ot">&lt;-</span> results_roc_curve <span class="sc">%&gt;%</span></span>
<span id="cb246-11"><a href="aprendizaje-supervisado-1.html#cb246-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span> <span class="sc">-</span> specificity, <span class="at">y =</span> sensitivity, <span class="at">color =</span> ID)) <span class="sc">+</span></span>
<span id="cb246-12"><a href="aprendizaje-supervisado-1.html#cb246-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb246-13"><a href="aprendizaje-supervisado-1.html#cb246-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb246-14"><a href="aprendizaje-supervisado-1.html#cb246-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb246-15"><a href="aprendizaje-supervisado-1.html#cb246-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;ROC Curve&quot;</span>)<span class="sc">+</span></span>
<span id="cb246-16"><a href="aprendizaje-supervisado-1.html#cb246-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb246-17"><a href="aprendizaje-supervisado-1.html#cb246-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-18"><a href="aprendizaje-supervisado-1.html#cb246-18" aria-hidden="true" tabindex="-1"></a>pr_curve_plot </span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-270-1.png" width="672" /></p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="aprendizaje-supervisado-1.html#cb247-1" aria-hidden="true" tabindex="-1"></a>roc_curve_plot</span></code></pre></div>
<p><img src="amt22_02intro2ml1_files/figure-html/unnamed-chunk-270-2.png" width="672" /></p>

</div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>

$('.pipehover_incremental tr').hover(function() {
  $(this).removeClass()
  $(this).prevAll().removeClass()
  $(this).nextAll().removeClass()
  $(this).addClass('hover');
  $(this).prevAll().addClass('hover');
  $(this).closest('div').next().find('img').attr("src", $(this).attr("link"));
});


$('.pipehover_select_one_row tr').hover(function() {
  $(this).removeClass()
  $(this).prevAll().removeClass()
  $(this).nextAll().removeClass()
  $(this).addClass('hover');
  $(this).closest('div').next().find('img').attr("src", $(this).attr("link"));
});

</script>
            </section>

          </div>
        </div>
      </div>
<a href="machine-learning-conceptos-básicos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="anexos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["amt22_02intro2ml1.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
